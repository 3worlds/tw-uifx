<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.8.dev">
<meta name="author" content="Jacques Gignoux, Ian D. Davies, Shayne R. Flint">
<title>3Worlds user manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>3Worlds user manual</h1>
<div class="details">
<span id="author" class="author">Jacques Gignoux</span><br>
<span id="email" class="email"><a href="mailto:jacques.gignoux@upmc.fr">jacques.gignoux@upmc.fr</a></span><br>
<span id="author2" class="author">Ian D. Davies</span><br>
<span id="email2" class="email"><a href="mailto:ian.davies@anu.edu.au">ian.davies@anu.edu.au</a></span><br>
<span id="author3" class="author">Shayne R. Flint</span><br>
<span id="email3" class="email"><a href="mailto:shayne.flint@anu.edu.au">shayne.flint@anu.edu.au</a></span><br>
<span id="revnumber">version 1.3,</span>
<span id="revdate">1 April 2021</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#truepurpose-and-motivation">1. Purpose and motivation</a>
<ul class="sectlevel2">
<li><a href="#truewhy-another-simulation-environment-for-ecology">1.1. Why another simulation environment for ecology?</a></li>
<li><a href="#truedesign-concepts">1.2. Design Concepts</a>
<ul class="sectlevel3">
<li><a href="#trueindividual-based-models">1.2.1. Individual based models</a></li>
<li><a href="#truethe-complex-system-as-a-dynamic-graph">1.2.2. The complex system as a dynamic graph</a></li>
<li><a href="#truecategories">1.2.3. Categories</a></li>
<li><a href="#truetime-with-simultaneous-events">1.2.4. Time with simultaneous events</a></li>
<li><a href="#truespace-as-a-mediator-for-interactions">1.2.5. Space as a mediator for interactions</a></li>
<li><a href="#truemodelling-made-easy">1.2.6. Modelling made easy</a></li>
<li><a href="#truemodel-comparison-graphs-can-be-compared">1.2.7. Model comparison: graphs can be compared</a></li>
<li><a href="#trueproblem-upscaling">1.2.8. Problem upscaling</a></li>
<li><a href="#trueportability-and-performance">1.2.9. Portability and performance</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truegetting-started-download-and-installation">2. Getting started - download and installation</a>
<ul class="sectlevel2">
<li><a href="#truebasics-what-you-must-know-before-starting">2.1. Basics - what you must know before starting</a></li>
<li><a href="#trueprerequisites">2.2. Prerequisites</a></li>
<li><a href="#truerunning-modelmaker">2.3. Running ModelMaker</a></li>
<li><a href="#truesetting-up-a-java-development-environment-for-the-user-code">2.4. Setting up a java development environment for the user code</a>
<ul class="sectlevel3">
<li><a href="#truesetting-up-an-eclipse-integrated-development-environment-ide-for-3worlds">2.4.1. Setting up an eclipse <em>i</em>ntegrated <em>d</em>evelopment <em>e</em>nvironment (IDE) for 3Worlds</a></li>
<li><a href="#truerunning-modelmaker-from-eclipse">2.4.2. Running ModelMaker from eclipse</a></li>
<li><a href="#truelinking-user-code-with-model-configuration">2.4.3. Linking user code with model configuration</a></li>
<li><a href="#truedebugging-and-testing-user-code">2.4.4. Debugging and testing user code</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truemodelmaker-reference-creating-and-editing-a-model">3. ModelMaker reference: creating and editing a model</a>
<ul class="sectlevel2">
<li><a href="#truegeneral-concepts-structure-of-a-3worlds-configuration">3.1. General concepts: structure of a 3Worlds configuration</a>
<ul class="sectlevel3">
<li><a href="#truea-tree-structure">3.1.1. A tree structure&#8230;&#8203;</a></li>
<li><a href="#truewith-cross-links">3.1.2. &#8230;&#8203;with cross-links</a></li>
<li><a href="#truewhat-modelmaker-does-for-you">3.1.3. What ModelMaker does for you</a></li>
</ul>
</li>
<li><a href="#trueusing-modelmaker-software-interface-and-functioning">3.2. Using ModelMaker: software interface and functioning</a></li>
<li><a href="#trueconfiguration-options-reference">3.3. Configuration options: reference</a>
<ul class="sectlevel3">
<li><a href="#truethe-3worlds-node">3.3.1. The <em>3Worlds</em> node</a></li>
<li><a href="#truethe-system-node">3.3.2. The <em>system</em> node</a></li>
<li><a href="#truethe-systemstructure-node">3.3.3. The <em>system/structure</em> node</a></li>
<li><a href="#truethe-systemdynamics-node">3.3.4. The <em>system/dynamics</em> node</a></li>
<li><a href="#truethe-datadefinition-node">3.3.5. The <em>dataDefinition</em> node</a></li>
<li><a href="#truethe-experiment-node">3.3.6. The <em>experiment</em> node</a></li>
<li><a href="#truethe-userinterface-node">3.3.7. The <em>userInterface</em> node</a></li>
</ul>
</li>
<li><a href="#truedeveloping-and-testing-model-code">3.4. Developing and testing model code</a>
<ul class="sectlevel3">
<li><a href="#truegeneric-method-arguments">3.4.1. generic method arguments</a></li>
<li><a href="#truegeneric-method-fields">3.4.2. generic method fields</a></li>
</ul>
</li>
<li><a href="#truefeeding-the-model-with-data">3.5. Feeding the model with data</a></li>
</ul>
</li>
<li><a href="#truemodelrunner-reference-running-a-simulation-experiment">4. ModelRunner reference: running a simulation experiment</a>
<ul class="sectlevel2">
<li><a href="#truegeneral-concepts">4.1. General concepts</a></li>
<li><a href="#trueusing-modelrunner-software-interface-and-functioning">4.2. Using ModelRunner: software interface and functioning</a></li>
<li><a href="#truegetting-output-from-a-simulation-experiment">4.3. Getting output from a simulation experiment</a></li>
</ul>
</li>
<li><a href="#truesample-models-and-tutorials">5. Sample models and tutorials</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>by <strong>Jacques Gignoux</strong>, <strong>Ian D. Davies</strong> &amp; <strong>Shayne R. Flint</strong></p>
</div>
<div class="paragraph">
<p>Version: <strong>1.3</strong> (1 April 2021)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truepurpose-and-motivation"><a class="anchor" href="#truepurpose-and-motivation"></a>1. Purpose and motivation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truewhy-another-simulation-environment-for-ecology"><a class="anchor" href="#truewhy-another-simulation-environment-for-ecology"></a>1.1. Why another simulation environment for ecology?</h3>
<div class="paragraph">
<p><em>“Though the organisms may claim our primary interest, when we are trying to think fundamentally we cannot separate them from their special environment, with which they form
one physical system”</em> A. G. Tanlsey (1935).</p>
</div>
<div class="paragraph">
<p>Ecosystems, as first proposed by Arthur Tansley (1935), have both <em>physical</em> and <em>biological</em> aspects. They comprise
the physics of energy and chemical stocks and flows and the biology of living things with a fleeting existence. They are made from and return to the physical world
(dust to dust, ashes to ashes), are part of it and at one and the same time, they constitute an entire new world
where concepts such as reproduction, social interaction, communication and life cycle dominate. To this day, reconciling these two aspects remains a key problem in ecosystem
studies: How does an energy flux translate into a number of living individuals or in a higher biodiversity?
How might the reproduction strategy of the beaver affect river hydrology and the regional water budget?
How might social interactions (society) affect the frequency of hurricanes (e.g. climate change)?
<strong>3Worlds</strong> aims at providing <em>a tool for building simulations that couple the physical and biological aspects of ecosystems</em>.</p>
</div>
<div class="paragraph">
<p>In our view, existing tools focus too much on one or other of these aspects. For example, dynamic models based on differential equations and can only represent reproduction and growth using metaphors for continuous physical quantities (e.g. matrix population models). Multi-agent systems (MAS), on the other hand, model social interactions well but pose difficulties in balancing mass or energy budgets.</p>
</div>
<div class="paragraph">
<p>In addition to this physical and biological duality, ecosystems are '<em>multi-scale</em>' (cf. an extensive discussion on
this topic and other questions related to the ecosystem concept in Gignoux et al. 2011). Tansley&#8217;s ecosystem definition
applies equally well to the whole biosphere as to a single bacteria in a drop of water. Currently, there is no
software enabling one to consider ecosystems at such different spatial and temporal scales within the same
conceptual framework. A second aim of <strong>3Worlds</strong> is to fill this gap. If the ecosystem concept is robust enough, and
we believe it is given its success in ecology and its adoption in other scientific fields, then it should be possible
to design a conceptually sound and consistent computing framework to deal with a multiplicity of scales.</p>
</div>
<div class="paragraph">
<p>However, changing the scale of a model is not just a matter of changing spatio-temporal resolution.
It also involves the level of detail of the representations used in the model, something which has been formalized
in <em>abstraction theory</em> (Zucker 2003): the more detailed a model, the less abstract it is. The question arises then as to what level of detail should we model our system to capture its important behaviour? How does changing scale (in this
 broadest sense) effect model outcomes? There can be no general answer to this question beyond trial and error. This makes the possibility
 to test and compare different representations of the same system at different scales an essential feature of
 any software dealing with ecosystems. <strong>3Worlds</strong> provides <em>great flexibility in ecosystem representation</em>
 enabling one to represent <em>any</em> ecosystem at <em>any</em> spatial and temporal scale with <em>any</em> level of detail&#8201;&#8212;&#8201;all this being determined by
 the researcher in accordance with the purpose of their study. The researcher has full control on the detailed biological functions
and variables relevant to their study.</p>
</div>
<div class="paragraph">
<p>How is this flexibility compatible with the strong conceptual backbone? <strong>3Worlds</strong> uses <em>aspect-oriented thinking (AOT)</em> (Flint 2006), a method to build complex systems (e.g.
software) from independent areas of knowledge. We have designed an <em>archetype</em> of what we believe constitutes an
ecosystem&#8201;&#8212;&#8201;a recursive and multi-scale system of interacting entities. We use an implementation of AOT to ensure
that any user-defined representation of an ecosystem complies with the archetype. This guarantees that, despite a
great freedom left to the modeller, their model will always be compatible with the 3Worlds software. The great
benefit of this is that while we believe it’s possible to construct any type of
model within this archetype, imposing specification constraints greatly assists in model comparison: why should
two models, ostensibly constructed for the same purpose, differ in their outputs? How does a change in temporal
or spatial scale affect projections?  How does adding or removing sub-systems change model projections?
<em>Models developed in <strong>3Worlds</strong> are always comparable</em>,  unlike many large model intercomparison exercises where the models are independently developed without reference to any common structuring principals.</p>
</div>
<div class="paragraph">
<p>The ecosystem is a recursive concept (Gignoux et al. 2011): ecosystems can be nested. Parts of an ecosystem can
be studied as ecosystems themselves. We use the concept of a hierarchical system, formalized as a graph (Gignoux et
al. 2017) to implement this idea. In <strong>3Worlds</strong>, <em>the modelled ecosystem is a graph</em> where nodes represent relevant
entities: individuals, populations, climate, soil, area, &#8230;&#8203;; and edges represent relations between these entities.
These relations can be of any kind, including a hierarchical relation describing the complex nesting of sub-systems.
This provides an elegant solution to the apparent complexity of ecosystems: it allows for various types of <em>emergence</em>,
enables the comparison of system structures and simulation trajectories, and can represent virtually anything
an ecological modeller can conceive of.</p>
</div>
<div class="paragraph">
<p><strong>3Worlds</strong> builds upon more than thirty years of experience of its developers in ecosystem and complex system modelling and simulation. Over this time, we have reached the conclusion that: (1) robust concepts
are fundamental for building sound software; (2) some problems that appear over and over again in the life of a
simulation modellers often have well-established solutions, sometimes in other scientific fields; and (3) complex
systems are more easily managed and understood when designed within a sound framework.</p>
</div>
<div class="paragraph">
<p>Many of the ideas we use are already available, it&#8217;s just a matter of making them work together, and <strong>3Worlds</strong> is our best attempt to do so!</p>
</div>
</div>
<div class="sect2">
<h3 id="truedesign-concepts"><a class="anchor" href="#truedesign-concepts"></a>1.2. Design Concepts</h3>
<div class="paragraph">
<p>3Worlds is based on a few concepts and techniques that have a very broad application and harnesses them to fit the needs of ecosystem modelling.</p>
</div>
<div class="sect3">
<h4 id="trueindividual-based-models"><a class="anchor" href="#trueindividual-based-models"></a>1.2.1. Individual based models</h4>
<div class="paragraph">
<p>Fundamentally, <strong>3Worlds</strong> is designed as a framework for <em>individual-based models</em> (IBMs: Grimm &amp; Railsback 2005). IBMs, like multi-agent systems (MASs: Bousquet &amp; Lepage 2004), assume that some important properties of complex systems (like ecosystems and human societies) cannot be understood without representing the detailed behaviour of every individual in the system. In an IBM, a list of 'individuals' (called 'agents' in MASs) is kept in memory, and their interactions through various functions yield the dynamics of the whole system over time. Individuals can come and go, which means that their list is constantly changing in size.</p>
</div>
<div class="paragraph">
<p>3Worlds simulates a <em>system</em> made of interacting <em>system components</em>, which are equivalent to the individuals or agents of IBMs and MASs. If required by a simple application, the 3Worlds <em>system</em> can be reduced to zero components, just as in any system dynamics application; but this is not the use 3Worlds has been designed for, and other more specialised software may be more adapted for this use case.</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-complex-system-as-a-dynamic-graph"><a class="anchor" href="#truethe-complex-system-as-a-dynamic-graph"></a>1.2.2. The complex system as a dynamic graph</h4>
<div class="paragraph">
<p>Ecosystems are commonly considered as <em>complex systems</em>, without much agreement on what this concept means. Complex systems are usually assumed to possess <em>emergent properties</em>; again, with little agreement on what this means. We argued in Gignoux et al. (2017) that the only common feature of all definitions of emergence is that emergence can only appear in systems with a 'macro-state' and 'micro-states'. We called such systems <em>hierarchical systems</em> and assumed that they can be ideally represented with a <em>dynamic graph</em>.</p>
</div>
<div class="paragraph">
<p>According to <a href="https://en.wikipedia.org/wiki/Graph_theory">graph theory</a>, a <em>graph</em> is a mathematical object comprising a set of <em>nodes</em>, a set of <em>edges</em> linking these nodes defined in an <em>incidence function</em> (<a href="#fig-what-is-a-graph">Figure 1</a>). A <em>dynamic</em> graph (Harary &amp; Gupta 1997) is a graph where these three components (the sets of nodes, edges, and the incidence function) can change over time.</p>
</div>
<div id="fig-what-is-a-graph" class="imageblock text-center">
<div class="content">
<img src="graph.svg" alt="graph">
</div>
<div class="title">Figure 1. A mathematical graph, showing both the usual mathematical terms and the vocabulary used in 3Worlds. The incidence function defines edges between nodes. Edges can be directed (with arrows) or undirected.</div>
</div>
<div class="paragraph">
<p>With the addition of <em>descriptors</em> (e.g. numbers with a specific meaning: <a href="#fig-graph-descriptors">Figure 2</a>) to nodes and edges, we can use the graph nodes as the individuals of our IBM, and the graph edges give a concrete existence to the interactions between those nodes. If we define <em>functions</em> that can modify nodes and edges and their descriptors, the graph becomes dynamic. A <strong>3Worlds</strong> simulation runs a dynamic graph where nodes, edges, descriptors, functions can be adapted to the user&#8217;s particular application. Nodes are called <em>system components</em>, edges <em>system relations</em>, and descriptors <em>properties</em>.</p>
</div>
<div id="fig-graph-descriptors" class="imageblock text-"center">
<div class="content">
<img src="graph-with-descriptors.svg" alt="graph with descriptors">
</div>
<div class="title">Figure 2. An example of graph descriptors (redrawn from Gignoux et al. 2017).</div>
</div>
</div>
<div class="sect3">
<h4 id="truecategories"><a class="anchor" href="#truecategories"></a>1.2.3. Categories</h4>
<div class="paragraph">
<p>In an IBM, every individual differs from all others. But it is common practice to assume that some groups of individuals share some things in common. This is the essence of modelling: finding commonalities within an ocean of particular cases. We use the concept of <em>category</em> to group system components that 'look like each other' in some way. Categories are used to express how alike and how different certain groups of components are from each other.</p>
</div>
<div class="paragraph">
<p>In a dynamic graph, categories are used to specify common descriptors to groups of components (e.g. a plant species average growth rate, an animal cohort survival rate, &#8230;&#8203;) and functions that operate on a group of components of the same category. They are also used to specify which <em>type of relation</em> is possible between components of different categories.</p>
</div>
<div class="paragraph">
<p>This category concept is similar in many ways to the class concept used in the <a href="http://uml.org/what-is-uml.htm">UML</a> language and in  <a href="https://en.wikipedia.org/wiki/Object-oriented_programming">object oriented programming</a> . Categories can be nested, and can be exclusive of each other or not. They are central to the organisation and execution of a simulation in <strong>3Worlds</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truetime-with-simultaneous-events"><a class="anchor" href="#truetime-with-simultaneous-events"></a>1.2.4. Time with simultaneous events</h4>
<div class="paragraph">
<p>Because ecosystems are both biological and physical systems, they not only deal with individuals and populations of living organisms, but also with fluxes of matter and energy. To properly compute a mass or energy balance typical of physical questions, we need a time model that insures that all system components are modified synchronously - otherwise, leaks in mass and energy budgets may occur (<a href="#fig-3w-main-loop">Figure 3</a>). This is where IBMs differ somewhat from MASs in their most common current implementations: MASs emphasize the <em>autonomy</em> of agents by allowing them to modify their state immediately. In other words, MASs assume that no two events occurring in a simulation can be simultaneous, while mass/energy balance requires simultaneity of events. 3Worlds assumes that simultaneous events are the default, but by using particular time models it is possible to relax this constraint.</p>
</div>
<div id="fig-3w-main-loop" class="imageblock text-center">
<div class="content">
<img src="state-change-loop.svg" alt="state change loop">
</div>
<div class="title">Figure 3. The time model of 3Worlds. The overall dynamics of a system is computed as X(t+dt) = f(X(t)) where X represents the state of all system components, t is time and f is the function (or rather, the set of functions) used to compute the change over the time interval dt.</div>
</div>
<div class="paragraph">
<p>Given the diversity of topics subject to ecological modelling, ecological processes span many orders of magnitude in their rate of action. Demographic models often use a yearly time step, while ecophysiological models may use daily time steps and physiological models may run with time steps of a second. <strong>3Worlds</strong> provides three types of <em>time model</em> that can be used in interaction: '<em>clock</em>' models using a constant time step, <em>event-driven </em>time models where time events trigger computations that can generate further events in the future, and <em>scenarios</em> where the list of events determines when computations are to be made. Time steps span the whole scale of time units relevant to ecology, i.e. from milliseconds to millenia. Standard Gregorian calendar time can also be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="truespace-as-a-mediator-for-interactions"><a class="anchor" href="#truespace-as-a-mediator-for-interactions"></a>1.2.5. Space as a mediator for interactions</h4>
<div class="paragraph">
<p>IBMs are often 'spatialized', which means they include some representation of the physical space in which organisms of an ecosystem interact. We argued in Gignoux et al. (2011) that space is not a requirement of the ecosystem definition, but rather an optional feature. Besides the usual 3-dimensional space, we called the place where organisms interact in an ecosystem the <em>arena</em>, i.e. the place where things happen and where a public (of ecological modellers) is watching them. This does not mean an Euclidian (or any other kind of) space must be associated with the ecosystem representation. Using a dynamic graph is sufficient.</p>
</div>
<div class="paragraph">
<p>However, it is often the case that explicitly considering space in a model is necessary for computing ecological interactions. In most ecological process models, there are actually implicit assumptions about space and how it affects organism interactions. For example, seed dispersal in plants is easily computed in a 2-dimensional space where the location of seeds depends on that of parent plants and some simple distance law; water flow in a catchment relies on a 2-dimensional space plus an elevation of ground surface to some x and y resolution; competition between individual trees in a forest assume a vertical distribution of leaves depicted with varying degrees of detail.</p>
</div>
<div class="paragraph">
<p>Following Gignoux et al. (2011), we optionally provide predefined spatial representations to include in a simulator. Different spaces can be used within a single simulator, depending on the needs of the process computations. They are associated with optimal search algorithms (e.g. Kd-trees) that speed up the search of components with which to form dynamic relations.</p>
</div>
</div>
<div class="sect3">
<h4 id="truemodelling-made-easy"><a class="anchor" href="#truemodelling-made-easy"></a>1.2.6. Modelling made easy</h4>
<div class="paragraph">
<p>The community of ecological scientists has been developing an impressively large number of models, yet most of them are poorly designed in terms of programming, as ecologists are not necessarily software engineers. Ecosystem simulators are among the most complex programs (Coquillard &amp; Hill 1997). They require high programming skills and constitute a huge investment in time, which makes their production slow and hazardous. As a result, once built, they tend to be used beyond their initial domain of application (e.g. the overuse and abuse of the CENTURY model: Parton et al. 1988), issues of provenance and repeatability are rarely addressed, shedding some doubt on the discipline as a whole.</p>
</div>
<div class="paragraph">
<p>With <strong>3Worlds</strong>, we wanted to provide a simulation platform for ecosystem modelling using state-of-the-art concepts and algorithms, and sound programming techniques (e.g. systematic code testing, separated concerns), so that ecological modellers can concentrate on the ecological part of the problem and forget about the computer science part. We used <em>automatic code generation</em> to ensure that researchers need only edit one code file to build a simulator for their particular model. We used a <em>graph editor</em> to build the configuration and organise the data required for a particular study. In <strong>3Worlds</strong> therefore, an ecosystem model only requires two files: a specification file organised as a graph, and a computer code file where all relevant ecological processes are written. None of this prevents the modeller from using software libraries, either their own or from a third party, to extend their coding capabilities.</p>
</div>
<div class="paragraph">
<p>When designing a model, it is important to get quick visual feedback of how the system behaves when one changes equations or their implementation. <strong>3Worlds</strong> comes with a library of user-interface objects (graphs, maps, time series) that can be freely assembled to adapt outputs to the needs of the researcher.</p>
</div>
</div>
<div class="sect3">
<h4 id="truemodel-comparison-graphs-can-be-compared"><a class="anchor" href="#truemodel-comparison-graphs-can-be-compared"></a>1.2.7. Model comparison: graphs can be compared</h4>
<div class="paragraph">
<p>Climate change modelling relies on 19 major general circulation models (GCMs) all based on the same equations. When run with identical datasets (initial data plus forcings), they all yield different results. This is expected given the size of their code, but what is troubling is that nobody is able to trace within the code where the differences come from  (Lim &amp; Roderick 2009). This problem arises again and again in the modelling literature (e.g. Melilo et al. 1995; Roxburgh et al. 2004). The ultimate reason for this impossibility is that all the knowledge invested into these huge models is represented in computer code, which are very difficult to compare for any but the simplest of models.</p>
</div>
<div class="paragraph">
<p><strong>3Worlds</strong> is an attempt to solve this issue <em>in the future</em> (there is nothing we can do for past model codes). If models are developed within the standard framework of <strong>3Worlds</strong>, the only thing that needs to be compared among models is their specification file (a graph) and their code file - hundreds to thousands of lines, not more. Everything else is equal. In theory this should facilitate model comparison.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueproblem-upscaling"><a class="anchor" href="#trueproblem-upscaling"></a>1.2.8. Problem upscaling</h4>
<div class="paragraph">
<p>Developing a simulator is only a small part of the ecological modelling exercise: once the simulator is ready, it is used as a real ecosystem in <em>simulation experiments</em>. Designing and running such experiments is a very important part of the job - if not the most important, as it is the one which will produce ecologically relevant, publishable results.</p>
</div>
<div class="paragraph">
<p>IBMs are often stochastic, as population rates translate into probabilities at the individual level: e.g., the code has to decide which individuals to delete to satisfy a mortality rate of 10%. This is usually based on drawing random numbers. As a result, every simulation is different even when using identical parameters, and an asymptotic behaviour of the system can only be obtained by running multiple simulations. Fortunately, this is easily parallelized with modern computers.</p>
</div>
<div class="paragraph">
<p>3Worlds is interfaced with <a href="https://openmole.org/">OpenMole</a>  to provide access to big computing power. Through OpenMole, big simulation experiments can be deployed on networks of computers, grids, or supercomputers.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueportability-and-performance"><a class="anchor" href="#trueportability-and-performance"></a>1.2.9. Portability and performance</h4>
<div class="paragraph">
<p><strong>3Worlds</strong> is written in Java to ensure portability between all operating systems. Its code has been carefully optimised, although generality inevitably comes with some performance cost.</p>
</div>
<div class="paragraph">
<p><strong>Cited references:</strong></p>
</div>
<div class="paragraph">
<p>Bousquet, F., &amp; Le Page, C. (2004). Multi-agent simulations and ecosystem management: a review. <em>Ecological Modelling</em>, 176:313–332. <a href="https://doi.org/10.1016/j.ecolmodel.2004.01.011" class="bare">https://doi.org/10.1016/j.ecolmodel.2004.01.011</a></p>
</div>
<div class="paragraph">
<p>Coquillard, P., &amp; Hill, D. (1997). <em>Modélisation et simulation d’écosystèmes. Des modèles déterministes aux simulations à événements discrets</em>. Masson, Paris.</p>
</div>
<div class="paragraph">
<p>Flint, S. R. (2006). <em>Aspect-Oriented Thinking - An approach to bridging the disciplinary divides</em>. PhD, Australian National University.</p>
</div>
<div class="paragraph">
<p>Gignoux, J., I.D. Davies, S.R. Flint, &amp; J.D. Zucker (2011). The Ecosystem in Practice: Interest and
Problems of an Old Definition for Constructing Ecological Models. <em>Ecosystems</em> 14: 1039‑54. <a href="https://doi.org/10.1007/s10021-011-9466-2" class="bare">https://doi.org/10.1007/s10021-011-9466-2</a>.</p>
</div>
<div class="paragraph">
<p>Gignoux, J., G. Chérel, I.D. Davies, S.R. Flint, &amp; E. Lateltin (2017). Emergence and Complex Systems: The
Contribution of Dynamic Graph Theory. <em>Ecological Complexity</em> 31: 34‑49. <a href="https://doi.org/10.1016/j.ecocom.2017.02.006" class="bare">https://doi.org/10.1016/j.ecocom.2017.02.006</a>.</p>
</div>
<div class="paragraph">
<p>Grimm, V., &amp; Railsback, S. (2005). <em>Individual-based modelling and ecology</em>. Princeton University Press.</p>
</div>
<div class="paragraph">
<p>Harary, F., &amp; Gupta, G. (1997). Dynamic graph models. <em>Mathematical and Computer Modelling</em>, 25(7), 79–87. <a href="https://doi.org/10.1016/S0895-7177(97)00050-2" class="bare">https://doi.org/10.1016/S0895-7177(97)00050-2</a></p>
</div>
<div class="paragraph">
<p>Lim, W. H., &amp; Roderick, M. L. (2009). <em>An atlas of the global water cycle based on the IPCC AR4 climate models.</em> ANU E Press.</p>
</div>
<div class="paragraph">
<p>Melilo, J. M., Borchers, J., Chaney, J., Fisher, H., Fox, S., Haxeltine, A., Janetos, A., Kicklighter, D. C., Kittel, T. G. F., McGuire, A. D., McKeown, R., Neilson, R., Nemani, R., Ojima, D. S., Painter, T., Pan, Y., Parton, W. J., Pierce, L., Pitelka, L., … Woodward, F. I. (1995). Vegetation/ecosystem modeling and analysis project: comparing biogeography and biogeochemistry models in a continental-scale study of terrestrial ecosystem responses to climate change and CO<sub>2</sub> doubling. <em>Global Biogeochemical Cycles</em>, 9(4), 407–437.</p>
</div>
<div class="paragraph">
<p>Parton, W., Stewart, J., &amp; Cole, C. (1988). Dynamics of C,N, P and S in grassland soils: a model. <em>Biogeochemistry</em>, 5, 109–131.</p>
</div>
<div class="paragraph">
<p>Roxburgh, S. H., Barrett, D. J., Berry, S. L., Carter, J. O., Davies, I. D., Gifford, R. M., Kirschbaum, M. U. E., McBeth, B. P., Noble, I. R., Parton, W. G., Raupach, M. R., &amp; Roderick, M. L. (2004). A critical overview of model estimates of net primary productivity for the Australian continent. <em>Functional Plant Biology</em>, 31(11), 1043–1059.</p>
</div>
<div class="paragraph">
<p>Tansley, A G. (1935). The use and abuse of vegetational concepts and terms. <em>Ecology</em> 16: 284‑307.</p>
</div>
<div class="paragraph">
<p>Zucker, J.D. (2003). A Grounded Theory of Abstraction in Artificial Intelligence. <em>Philosophical Transactions of
the Royal Society B: Biological Sciences</em> 358: 1293‑1309. <a href="https://doi.org/10.1098/rstb.2003.1308" class="bare">https://doi.org/10.1098/rstb.2003.1308</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truegetting-started-download-and-installation"><a class="anchor" href="#truegetting-started-download-and-installation"></a>2. Getting started - download and installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truebasics-what-you-must-know-before-starting"><a class="anchor" href="#truebasics-what-you-must-know-before-starting"></a>2.1. Basics - what you must know before starting</h3>
<div class="paragraph">
<p>3Worlds is an application designed to develop and launch simulations of ecosystems.
It is highly versatile and can simulate any kind of ecosystem using any kind of mathematical logic.</p>
</div>
<div class="paragraph">
<p>The application and use of 3Worlds to a particular ecosystem for a particular study case is called a <em>model</em>&#8201;&#8212;&#8201;or, more precisely a <em>simulation</em> model.
The model must first be specified and developed (this involves writing some code in the java programming language) before it can be executed for a particular case study.
This execution is called a <em>simulation experiment</em>.</p>
</div>
<div class="paragraph">
<p>3Worlds comprises two main applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ModelMaker</code>, to configure a model;</p>
</li>
<li>
<p><code>ModelRunner</code>, to run the model.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creating a model involves creating a configuration with <code>ModelMaker</code> and developing some associated java code to specify details particular to your model.
To do this, you must use the <a href="https://www.eclipse.org/downloads/">eclipse</a> programming software (freeware). Later versions of 3Worlds may support other packages, but at the time of writing, 3Worlds will only work with <a href="https://www.eclipse.org/downloads/">eclipse</a>.</p>
</div>
<div class="paragraph">
<p><code>ModelMaker</code> will generate java code for data structures specific to a model (based on the configuration file you have developed) and <em>template</em> java code for each process you have defined. These process templates are where you enter programming code to implement your model. You only need to write  code for your processes and for model initialisation. All else is managed by 3Worlds.</p>
</div>
<div class="paragraph">
<p>3Worlds is written in <a href="https://en.wikipedia.org/wiki/Java_(programming_language)">java</a>, which makes it OS-independent. It can be run on MacOS, Linux or Windows computers.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueprerequisites"><a class="anchor" href="#trueprerequisites"></a>2.2. Prerequisites</h3>
<div class="paragraph">
<p>You must have the following software installed on your computer prior to install 3Worlds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>java JDK (<strong>J</strong>ava <strong>D</strong>evelopment <strong>K</strong>it), version 11 or greater (<a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk11-downloads-5066655.html">oracle</a> or <a href="http://openjdk.java.net/">open</a> version)</p>
</li>
<li>
<p>java fx (graphical user interface library for java: <a href="http://www.oracle.com/technetwork/java/javase/overview/javafx-overview-2158620.html">oracle</a> or <a href="http://openjdk.java.net/projects/openjfx/">open</a> version)</p>
</li>
<li>
<p>an <a href="https://www.eclipse.org/downloads/">eclipse</a> java code development environment. You must:</p>
<div class="ulist">
<ul>
<li>
<p>install <a href="https://www.eclipse.org/downloads/">eclipse</a></p>
</li>
<li>
<p>install the <a href="https://www.eclipse.org/efxclipse/install.html">e(fx)clipse plugin</a> required to use javafx</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="truerunning-modelmaker"><a class="anchor" href="#truerunning-modelmaker"></a>2.3. Running ModelMaker</h3>
<div class="paragraph">
<p>This assumes you have downloaded <code>3w.zip</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unzip <code>3w.zip</code> in your user home directory (important), keeping the internal directory tree. This will extract a file <code>modelMaker.jar</code> and a <code>.3w</code> directory containing more jar files.</p>
</li>
<li>
<p>Double-click on <code>modelMaker.jar</code>. This should launch the ModelMaker application.</p>
</li>
<li>
<p>If this does not work, open a terminal and type <code>java -jar modelMaker.jar</code>. This should launch the ModelMaker application.</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This way of launching 3Worlds is sensitive to the relative location of <code>modelMaker.jar</code> and the other jars that are in the <code>.3w</code> directory, ie <code>modelMaker.jar</code> <strong>must</strong> be exactly one directory above <code>.3w</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To remove this constraint, you can bypass <code>modelMaker.jar</code> by directly launching it from the jars contained in <code>.3w</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">java -cp .3w/tw-dep.jar au.edu.anu.twuifx.mm.Main</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last is the preferred method as any errors that may arise will appear in the terminal window.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
to develop your model-specific code, you will need to setup a java development environment as shown in section <a href="#truesetting-up-a-java-development-environment-for-the-user-code">Setting up Java</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truesetting-up-a-java-development-environment-for-the-user-code"><a class="anchor" href="#truesetting-up-a-java-development-environment-for-the-user-code"></a>2.4. Setting up a java development environment for the user code</h3>
<div class="sect3">
<h4 id="truesetting-up-an-eclipse-integrated-development-environment-ide-for-3worlds"><a class="anchor" href="#truesetting-up-an-eclipse-integrated-development-environment-ide-for-3worlds"></a>2.4.1. Setting up an eclipse <em>i</em>ntegrated <em>d</em>evelopment <em>e</em>nvironment (IDE) for 3Worlds</h4>
<div class="paragraph">
<p>This assumes you have downloaded <code>UserCodeRunner.java</code> and <code>tw-dep.jar</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If not yet done, install <a href="https://www.eclipse.org/downloads/">eclipse</a> (don&#8217;t forget <a href="https://www.eclipse.org/efxclipse/install.html">e(fx)clipse</a>!)</p>
</li>
<li>
<p>Create at <em>workspace</em> (= a working directory for eclipse - eclipse will ask for it when launched). e.g., <em>&lt;my_workspace&gt;</em></p>
</li>
<li>
<p>Within eclipse, create a <em>project</em>:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>File &#8594; New &#8594; Java project</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, type a project name (e.g. <em>&lt;my_project&gt;</em>)</p>
</li>
<li>
<p>Click the <code>Finish</code> button</p>
</li>
</ul>
</div>
</li>
<li>
<p>Import <code>UserCodeRunner.java</code> in the project:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>File &#8594; Import</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, select <code>general &gt; File System</code></p>
</li>
<li>
<p>Click the <code>next</code> button</p>
</li>
<li>
<p>Click on the <code>Browse</code> button to select the directory where <code>UserCodeRunner.java</code> is located</p>
</li>
<li>
<p>Select the proper file in the list</p>
</li>
<li>
<p>Select <code>/src</code> as the destination location in the project</p>
</li>
<li>
<p>Click the <code>Finish</code> button</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>UserCodeRunner.java</code> should now appear as the unique member of a <code>default</code> package, with a compile error message attached to it.</p>
</div>
</li>
<li>
<p>Update libraries required by the project:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>Project &#8594; Properties</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, select <code>Java Build Path</code></p>
</li>
<li>
<p>Select the <code>Libraries</code> tab</p>
</li>
<li>
<p>Click on the <code>Add external JARs&#8230;&#8203;</code> button; this open a file selection dialog box</p>
</li>
<li>
<p>In the file selection dialog box, browse and select <code>tw-dep.jar</code></p>
</li>
<li>
<p>Click the <code>Apply and Close</code> button</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>UserCodeRunner.java</code> should now have no compile errors.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truerunning-modelmaker-from-eclipse"><a class="anchor" href="#truerunning-modelmaker-from-eclipse"></a>2.4.2. Running ModelMaker from eclipse</h4>
<div class="paragraph">
<p>ModelMaker can be run as a standalone application, or from eclipse since it is included in the <code>tw-dep.jar</code> library required to develop the user code.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>package explorer</code> window, expand the <code>Referenced libraries</code> entry</p>
</li>
<li>
<p>Right-click on the <code>tw-dep.jar</code> entry, select <code>Run as &#8594; Java Application</code>. This opens a dialog box</p>
</li>
<li>
<p>In the dialog box, type <em>Main</em></p>
</li>
<li>
<p>In the list of matching items, select <code>Main - au.edu.anu.twuifx.mm</code> and click <code>OK</code></p>
</li>
<li>
<p>If a dialog box appears warning for errors, click <code>Proceed</code>. This launches the ModelMaker application</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="truelinking-user-code-with-model-configuration"><a class="anchor" href="#truelinking-user-code-with-model-configuration"></a>2.4.3. Linking user code with model configuration</h4>
<div class="paragraph">
<p>This requires the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In ModelMaker,</p>
<div class="ulist">
<ul>
<li>
<p>create or open a <em>3Worlds</em> project (<code>Projects</code> entry of the main menu)</p>
</li>
<li>
<p>select <code>Preferences &#8594; Java Project &#8594; Connect&#8230;&#8203;</code>. This opens a dialog box with a file selector</p>
</li>
<li>
<p>select the root directory of the <em>eclipse</em> project as created above (e.g. <em>&lt;my_workspace&gt;</em>/<em>&lt;my_project&gt;</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This operation tells <code>ModelMaker</code> to generate its code into the user java project.
When you want to edit your code in eclipse, you must first <strong>refresh</strong> the eclipse project:</p>
</div>
</li>
<li>
<p>In eclipse,</p>
<div class="ulist">
<ul>
<li>
<p>select the project name at the very top of the <code>package explorer</code> window</p>
</li>
<li>
<p>right-click on it and select <code>Refresh</code></p>
</li>
<li>
<p>or, alternatively: press the <strong>F5</strong> key</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You don&#8217;t <strong>have</strong> to do this. We provide it as a facility if you want to run ModelMaker from eclipse rather than directly for some profound reason of your own.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truedebugging-and-testing-user-code"><a class="anchor" href="#truedebugging-and-testing-user-code"></a>2.4.4. Debugging and testing user code</h4>
<div class="paragraph">
<p>The user code, first generated by <code>ModelMaker</code> and further edited by the user, can be run using <code>UserCodeRunner.java</code>.
It requires two command line arguments (we assume that you know how to setup and run a <code>Run Configuration</code> in eclipse):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the name of the directory of the 3Worlds project as created by <code>ModelMaker</code> (e.g. <em>project_test_model9_2019-09-05-08-50-20-458</em>). This project directory is located under the <code>.3w</code> directory automatically created by <code>ModelMaker</code> as its working directory</p>
</li>
<li>
<p>the name of the model configuration file in this directory (e.g. <em>test_model_9.ugt</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With this, the user code should be executed as a test simulation by <code>UserCodeRunner</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Further edits and modifications of the configuration can be made in <code>ModelMaker</code>, but do not forget to keep the eclipse project content synchronized with the ModelMaker project by refreshing the eclipse project as often as necessary.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truemodelmaker-reference-creating-and-editing-a-model"><a class="anchor" href="#truemodelmaker-reference-creating-and-editing-a-model"></a>3. ModelMaker reference: creating and editing a model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truegeneral-concepts-structure-of-a-3worlds-configuration"><a class="anchor" href="#truegeneral-concepts-structure-of-a-3worlds-configuration"></a>3.1. General concepts: structure of a 3Worlds configuration</h3>
<div class="sect3">
<h4 id="truea-tree-structure"><a class="anchor" href="#truea-tree-structure"></a>3.1.1. A tree structure&#8230;&#8203;</h4>
<div class="paragraph">
<p>The configuration of a 3Worlds <em>simulation experiment</em> is organised as a tree (<a href="#fig-configuration-tree">Figure 4</a>). Each tree <em>node</em> specifies a subset of the parameters of the whole configuration. Each <em>node</em> has <em>child nodes</em> linked through a <em>tree edge</em>, so that large pieces of configuration can be broken down into the relevant details. At each level of this hierarchy, <em>properties</em> can be attached to <em>nodes</em>.</p>
</div>
<div class="paragraph">
<p><em>Nodes</em> have a <em>label</em> and a <em>name</em> that are displayed in the <code>ModelMaker</code> interface as <code>label:name</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>label</em> specifies what role this particular <em>node</em> plays in the whole configuration. For example, the <em>node</em> labelled <code>experiment</code> is used to configure a <em>simulation experiment</em>.</p>
</li>
<li>
<p>The <em>name</em> is used to differentiate <em>nodes</em>. It must be unique over the whole configuration tree. By default, <code>ModelMaker</code> generates unique names (by adding a number to the name if replicates are found).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>root node</em> of a configuration is always labelled <code>3worlds</code>.</p>
</div>
<div id="fig-configuration-tree" class="imageblock text-center">
<div class="content">
<img src="dsl-tree3.svg" alt="dsl tree3">
</div>
<div class="title">Figure 4. Tree structure of a simulation experiment configuration in 3Worlds</div>
</div>
<div class="paragraph">
<p>The configuration tree is stored in a file in a specially designed text format, ending with the extension <code>.ugt</code> or <code>.twg</code>. Such files are produced by <code>ModelMaker</code> and can then be exchanged and imported into <code>ModelMaker</code> via the <code>Projects &#8594; Import&#8230;&#8203;</code> menu entry. Their format is human-readable, but they must <strong>never</strong> be edited with another software than <code>ModelMaker</code> - <strong>the risk is to corrupt all your configuration</strong> and be unable to run it (or even edit it with <code>ModelMaker</code> again).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<strong>NEVER</strong> edit the 3worlds configuration <code>.ugt</code> file 'by hand'! You may make it unreadable to <code>ModelMaker</code> and lose all your work.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each node in the configuration has a particular meaning for <code>ModelRunner</code>: the configuration must comply with certain rules and constraints, the first one being the particular set of <em>nodes</em> that have been designed and appear on <a href="#fig-configuration-tree">Figure 4</a>. The detailed meaning of all <em>nodes</em> and their <em>properties</em> is described in <a href="#trueconfiguration-options-reference">Section 3.3</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truewith-cross-links"><a class="anchor" href="#truewith-cross-links"></a>3.1.2. &#8230;&#8203;with cross-links</h4>
<div class="paragraph">
<p>Actually, the 3Worlds configuration is not stritcly hierarchical (<a href="#fig-configuration-tree2">Figure 5</a>): according to their role in <code>ModelRunner</code>, some configuration <em>nodes</em> need to gather information from other parts of the configuration tree. This is done by allowing for some cross-reference <em>edges</em> to be defined, that overlay with the strict hierarchical structure of the tree. As a result fo these cross links, the whole configuration is a <em>graph</em> rather than a tree.</p>
</div>
<div id="fig-configuration-tree2" class="imageblock text-center">
<div class="content">
<img src="dsl-tree3links.svg" alt="dsl tree3links">
</div>
<div class="title">Figure 5. Tree structure of a simulation experiment configuration in 3Worlds, showing the cross-links between tree nodes (NB: not all cross-links are drawn)</div>
</div>
<div class="paragraph">
<p><em>Edges</em> representing cross links have a <em>label</em>, <em>name</em>, and may have <em>properties</em> just as <em>nodes</em> do. The detailed meaning of all cross-reference <em>edges</em> and their <em>properties</em> is described in <a href="#trueconfiguration-options-reference">Section 3.3</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truewhat-modelmaker-does-for-you"><a class="anchor" href="#truewhat-modelmaker-does-for-you"></a>3.1.3. What ModelMaker does for you</h4>
<div class="paragraph">
<p><code>ModelMaker</code> knows the details of the configuration constraints. It facilitates the design of a configuration by only letting you add the <em>nodes</em>, <em>edges</em> and <em>properties</em> that will produce a valid, runnable configuration file. During the configuration building process, it constantly checks the validity of the graph and reports any errors or missing parts in its <code>log</code> panel. <code>ModelMaker</code> is far more than a nice visual editor producing a graph: a configuration graph produced with <code>ModelMaker</code> is <strong>guaranteed</strong> to run with <code>ModelRunner</code> because of all these internal consistency and validity checks.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueusing-modelmaker-software-interface-and-functioning"><a class="anchor" href="#trueusing-modelmaker-software-interface-and-functioning"></a>3.2. Using ModelMaker: software interface and functioning</h3>
<div class="paragraph">
<p><strong>TO DO</strong>: step-by-step description of using the user interface. With screenshots.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueconfiguration-options-reference"><a class="anchor" href="#trueconfiguration-options-reference"></a>3.3. Configuration options: reference</h3>
<div class="paragraph">
<p>In this section,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>node and edge labels are indicated in <code><strong>bold</strong></code></p>
</li>
<li>
<p>text in triangular brackets (<code>&lt;&gt;</code>) mean a user-defined value is expected; the text usually specifies what kind of value is expected (e.g. <code>&lt;<em>name</em>&gt;</code> for a name, <code>&lt;<em>int</em>&gt;</code> for an integer number, etc.). If the text is required, it will be <span class="underline">underlined</span>, otherwise it is optional</p>
</li>
<li>
<p>a <em>multiplicity</em> in curly braces {} tells how many times the item may appear in a configuration:</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
{1}
</td>
<td class="hdlist2">
<p>exactly one item is required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{0..1}
</td>
<td class="hdlist2">
<p>the item is optional, i.e. one or zero is required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{1..*}
</td>
<td class="hdlist2">
<p>one to many items are required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{0..*}
</td>
<td class="hdlist2">
<p>any number of items is possible</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>levels in the tree hierarchy are indicated by slashes <code>/</code>.</p>
</li>
<li>
<p>a column <code>:</code> separates a node label from its name.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="truethe-3worlds-node"><a class="anchor" href="#truethe-3worlds-node"></a>3.3.1. The <em>3Worlds</em> node</h4>
<div class="paragraph">
<p><code>/<strong>3worlds</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node is the root of any 3Worlds configuration file (<a href="#fig-root-example">Figure 6</a>). The name will appear in <code>ModelMaker</code>'s main window title, in the <strong>project directory name</strong> and in the <strong>configuration graph file</strong>. The name is requested and set when creating a new project (<code>Projects&gt;New</code> menu entry in <code>ModelMaker</code>).</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>3worlds</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>authors</code>
</td>
<td class="hdlist2">
<p>The list of this project author names.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>contacts</code>
</td>
<td class="hdlist2">
<p>The list of the author contacts (e.g. e-mail addresses), in the same order as the author names (1-1 match).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>precis</code>
</td>
<td class="hdlist2">
<p>A short description of the model contained in this project.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>publication</code>
</td>
<td class="hdlist2">
<p>A list of bibliographic references in relation with the project.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>built-by</code>
</td>
<td class="hdlist2">
<p>The user name under which this project was constructed and saved, together with the date of saving. This property is automatically set by ModelMaker.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>version</code>
</td>
<td class="hdlist2">
<p>A user-defined version identifier for this project.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All these properties appear in the about box of <code>ModelRunner</code> and are saved in the ODD file describing the model.</p>
</div>
<div id="fig-root-example" class="imageblock text-center">
<div class="content">
<img src="example-root.png" alt="example root">
</div>
<div class="title">Figure 6. The base tree of any 3Worlds configuration</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-system-node"><a class="anchor" href="#truethe-system-node"></a>3.3.2. The <em>system</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>system</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains all the ecological concepts used to define a simulation model: what entities are modelled, what biological processes apply to them, at what time step they should run. The name is used to differentiate models as a simulation experiment may involve more than one model.</p>
</div>
<div class="paragraph">
<p>A 3Worlds ecosystem is constructed as a population of 'biological entities', called <em>system components</em>, which establish interactions called <em>system relations</em>. Components and relations have <em>variables</em> that may change value over time, according to various <em>ecological processes</em> attached to components. In other words, an ecosystem is represented as a <em>dynamic graph</em> which changes state and structure over time. To reflect this, <code><strong>system</strong></code> has two sub-trees called <code><strong>structure</strong></code> and <code><strong>dynamics</strong></code>.</p>
</div>
<div class="paragraph">
<p>For very simple models, where the modelled system is not further subdivided into components, the structure sub-tree is not required. In this case,the system node will be used as a unique 'component' describing the system (cf tutorial: <a href="#TODO">logistic</a>).</p>
</div>
<div class="paragraph">
<p><em>Cross-links</em> for <code>system</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>belongsTo &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells to which categories the system node belongs. The categories must not belong to the same category set. If there are nested categories, membership is inherited.The categories targets of these links must be specific to the system, i.e. no <code>componentType</code>, <code>groupType</code> or <code>lifeCycleType</code> should refer (<code>belongTo</code> cross-link) to any of them.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*arena*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*arena*</code> is required in all models. The arena is 'the place where things happen', i.e. it describes the part of the system where components interact. If no components are modelled, then it is the system.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*atomic*|*assemblage*</code> {1}</dt>
<dd>
<p>This link to either the predefined category <code>*atomic*</code> or <code>*assemblage*</code> is required in all models. Only if the system is very simple (no components, no groups, no life cycles) should <code>*atomic*</code> be selected. It means the system has no further subdivision. In any other case (i.e. as long as there is a structure sub-tree), the system should be an <code>*assemblage*</code>. Assemblages have three automatic variables: the system size (number of components) <code>count</code>, the number of new components added during last time step <code>nAdded</code>, and the number of components deleted during the last time step <code>nRemoved</code>.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*permanent*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*permanent*</code> is required in all models. It specifies that the system is going to stay forever (permanent) during a simulation.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="truethe-systemstructure-node"><a class="anchor" href="#truethe-systemstructure-node"></a>3.3.3. The <em>system/structure</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/system/<strong>structure</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains the description of the system component and relation types. It is based on the concept of <em>category</em>. A category is a set of components with an identical description, e.g. the same set of state variables or the same growth function.</p>
</div>
<div class="sect4">
<h5 id="truethe-category-and-related-concepts-specification-of-groups-of-entities"><a class="anchor" href="#truethe-category-and-related-concepts-specification-of-groups-of-entities"></a>The <em>category</em> and related concepts: specification of groups of entities</h5>
<div class="paragraph">
<p>3Worlds uses these concepts to specify and generate the ecological entities manipulated during a simulations.</p>
</div>
<div class="sect5">
<h6 id="truecategory"><a class="anchor" href="#truecategory"></a>Category</h6>
<div class="paragraph">
<p><code>&#8230;&#8203;/categorySet/<strong>category</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>A <code><strong>category</strong></code> is simply a name attached to a set of objects sharing common properties (<a href="#truecategories">Section 1.2.3</a>). These common properties are descriptors (<a href="#truethe-complex-system-as-a-dynamic-graph">Section 1.2.2</a>), and dynamic behaviours (or <em>processes</em>). Categories, grouped into <code><strong>categorySet</strong></code>s, constitute a user-defined <em>classification</em> of <em>system component types</em> relevant for a particular model.</p>
</div>
<div class="paragraph">
<p>Descriptors consist in <em>drivers</em>, <em>decorators</em>, <em>constants</em> and <em>automatic variables</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>drivers</em></dt>
<dd>
<p>are <em>independent</em> variables (numbers, text, logical values) that characterize the state of a system component at an instant in time (<em>e.g.</em> biomass, age, sex, social status&#8230;&#8203;). They will vary during a simulation. 'Independent' means that these variables cannot be computed from each other within a simulation step, they also depend on their previous step values. For example, if some category is described by drivers <em>age</em> and <em>biomass</em>, neither of them can be computed from the other: <em>age</em> is computed from its previous value by adding the time step duration; <em>biomass</em> is computed in some other way probably involving its previous value. The values of drivers are carried over from a simulation step to the next, i.e. they <em>drive</em> the dynamics of the system.</p>
</dd>
<dt class="hdlist1"><em>decorators</em></dt>
<dd>
<p>are <em>dependent</em> variables that are computed from drivers and other decorators within a simulation step. For example, <em>leaf area</em> could be computed as some constant times <em>biomass</em>: its value is completely determined by the value of <em>biomass</em>. As such, decorators are not independent from the drivers and are used only for convenience in computations or output display. They are not carried over from a simulation step to the next, they are always automatically reset to zero at the end of each step.</p>
</dd>
<dt class="hdlist1"><em>constants</em></dt>
<dd>
<p>are values (numbers, text, logical values) that do not change during a simulation. For example, <em>sex</em> or <em>number of legs</em> are not going to change during the lifetime of animal. They are set at birth and never changed after.</p>
</dd>
<dt class="hdlist1"><em>automatic variables</em></dt>
<dd>
<p>are values internally managed by 3Worlds and only available as read-only values for computation. For components representing individuals, these are <em>age</em> and <em>birth date</em>. For components representing populations, these are <em>number of individualls</em>, <em>number of births</em>, <em>number of deaths</em>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The exact data structures for descriptors are specified under the <code>dataDefinition</code> node (<a href="#truethe-datadefinition-node">Section 3.3.5</a>) and linked to the category through the following:</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>category</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>drivers &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dt class="hdlist1"><code>decorators &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dt class="hdlist1"><code>constants &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>These links tell which data structure in the <code>dataDefinition</code> node (<a href="#truethe-datadefinition-node">Section 3.3.5</a>) is used to store  <em>drivers</em>, <em>decorators</em>  and <em>constants</em>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Automatic variables</em> do not need to be specified - because they are automatic.</p>
</div>
<div class="paragraph">
<p>A category may be defined with no drivers, decorators or constants.</p>
</div>
<div class="paragraph">
<p>There are <em>predefined categories</em> in 3Worlds under the node <code>/3worlds/<strong>predefined</strong></code>, used to specify particular components of the system. They will be explained in time.</p>
</div>
</div>
<div class="sect5">
<h6 id="truecategoryset"><a class="anchor" href="#truecategoryset"></a>CategorySet</h6>
<div class="paragraph">
<p><code>/3worlds/system/structure/<strong>categorySet</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>Some categories must be exclusive of each other: for example, an ecological entity is either a plant or an animal, but can&#8217;t be both. For this reason, <em>exclusive</em> categories are grouped into <code><strong>categorySets</strong></code>. A <code>categorySet</code> is <em>a set of <strong>mutually exclusive</strong> categories</em>. Categories can be nested, by simply defining a <code>categorySet</code> as a child of a <code>category</code>:</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203;/category/<strong>categorySet</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
</div>
<div class="sect5">
<h6 id="truerelationtype"><a class="anchor" href="#truerelationtype"></a>RelationType</h6>
<div class="paragraph">
<p><code>/3worlds/system/structure/<strong>relationType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <code><strong>relationType</strong></code> is just a name representing a meaningful link between two kinds of categories. It is specified by giving it a name and cross-linking it to the relevant categories with <code>fromCategory</code> and <code>toCategory</code> cross-links. Note that a <code>relationType</code> can link more than one 'from' categories to more than one 'to' categories if required. <code>RelationType</code>s are used to implement specific processes acting on ecological entities (for example, a predation process).</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>relationType</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fromCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells which categories are at the start of the relation.</p>
</dd>
<dt class="hdlist1"><code>toCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells which categories are at the end of the relation.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>relationType</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>lifespan</code>
</td>
<td class="hdlist2">
<p>This property specifies if this type of relation will stay attached to its <code>systemComponents</code> during all their life, or may get created and deleted during their lifespan.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>permanent</code>
</td>
<td class="hdlist2">
<p>relation stays as long as both its ends stay (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ephemeral</code>
</td>
<td class="hdlist2">
<p>relations are created during a simulation by the means of a  <code>relateTo</code> function, and kept or deleted by means of a <code>maintainRelation</code> decision function. If no <code>maintainRelation</code> function is provided, then the relation only lasts for one simulation step.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-a-category-tree"><a class="anchor" href="#trueexample-a-category-tree"></a>Example: a category tree</h6>
<div class="paragraph">
<p>On this diagram (generated with <code>ModelMaker</code>), hierarchical links are in green and cross-links are in red.</p>
</div>
<div id="fig-category-example" class="imageblock text-center">
<div class="content">
<img src="example-category.png" alt="example category">
</div>
<div class="title">Figure 7. Example of a configuration with category sets, categories and relations</div>
</div>
<div class="paragraph">
<p>In this example, a <em>plant</em> can be a <em>C3 tree</em> but cannot be simultaneously a <em>grass</em> and a <em>forb</em>. Similarly, an <em>animal</em> cannot be both <em>herbivore</em> and <em>carnivore</em>. The <em>predation</em> relation links an <em>animal</em> of any kind (the prey) to a <em>carnivore</em> (its predator). A member of category <em>plant</em> will have two driver variables, <em>height</em> and <em>leaf area</em>. A member of category <em>tree</em> will have three driver variables, <em>height</em>, <em>leaf area</em> and <em>DBH</em>, as it inherits all the properties of the <em>plant</em> category in which it is nested.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-specification-of-ecological-entities-system-components"><a class="anchor" href="#truethe-specification-of-ecological-entities-system-components"></a>The specification of ecological entities: <em>system components</em></h5>
<div class="sect5">
<h6 id="truesystem-component"><a class="anchor" href="#truesystem-component"></a>System component</h6>
<div class="paragraph">
<p><code>/3worlds/system/structure/<strong>componentType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>3Worlds simulates a <em>system</em> made of <em>system components</em>. These are the things which are instantiated at run time, hold descriptors, and are dynamically changed over the time course of a simulation. When setting up a simulation, one must attach <em>categories</em> to <em>system components</em>. The rules prevailing to build up category hierarchies mean that a system can belong to a number of non-exclusive categories, as long as the exclusion and nesting rules are respected. For example, we could define a system as belonging to the <em>plant</em> and <em>tree</em> categories, but not to the <em>animal</em> and <em>tree</em> categories.</p>
</div>
<div class="paragraph">
<p><em>Cross-links</em> for <code>componentType</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>belongsTo &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells to which categories a system component type belongs. The categories must not belong to the same category set. If there are nested categories, membership is inherited (e.g. in the previous example, belonging to the <em>C3</em> category automatically implies the system component is also a <em>plant</em>).The categories targets of these links must be specific to component types, i.e. no <code>groupType</code> or <code>lifeCycleType</code> should refer (<code>belongTo</code> cross-link) to any of them.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*component*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*component*</code> is required in all models.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*atomic*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*atomic*</code> is required in all models. It means that a component has no further subdivisions.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*ephemeral*|*permanent*</code> {1}</dt>
<dd>
<p>This link to either of the predefined category <code>*ephemeral*</code> or <code>*permanent*</code> is required in all models. It specifies if components of this <code>componentType</code> are going to stay forever (permanent) or can be created and deleted (ephemeral) during a simulation. Ephemeral components have two automatic variables, <code>birthDate</code> and <code>age</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truecomponent-group"><a class="anchor" href="#truecomponent-group"></a>Component group</h6>
<div class="paragraph">
<p><code>/3worlds/system/structure/<strong>groupType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Sometimes it makes sense to group components of a given <code>componentType</code> into <em>groups</em>; the best example of this in ecology is the species. Animals of different species may be described by the same descriptors, but nevertheless they will only reproduce within their species. Typically, animals of a species would share some constants, like plumage coloration, average body size, main diet etc. The <code><strong>groupType</strong></code> node is meant to fullfil this use case.</p>
</div>
<div class="paragraph">
<p>To make a <code>componentType</code> belong to a <code>groupType</code>, you just need to declare it as a child of the <code>groupType</code>:</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203;/groupType/<strong>componentType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p><em>Cross-links</em> for <code>componentType</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>belongsTo &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells to which categories a system component type belongs. The categories must not belong to the same category set. If there are nested categories, membership is inherited. The categories targets of these links must be specific to groups, i.e. no <code>componentType</code> or <code>lifeCycleType</code> should refer (<code>belongTo</code> cross-link) to any of them.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*group*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*group*</code> is required in all models.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*assemblage*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*assemblage*</code> is required in all models. It means that a group is a population of components. Assemblages have three automatic variables: the group size (number of components) <code>count</code>, the number of new components added during last time step <code>nAdded</code>, and the number of components deleted during the last time step <code>nRemoved</code>.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*permanent*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*permanent*</code> is required in all models. It means that groups will stay forever in the system, even if all components of this groups are gone.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truelife-cycle"><a class="anchor" href="#truelife-cycle"></a>Life cycle</h6>
<div class="paragraph">
<p><code>/3worlds/system/structure/<strong>lifeCycleType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>As <em>system component</em>s are designed to represent&#8201;&#8212;&#8201;among other things&#8201;&#8212;&#8201;individual organisms, they are able to create other system components at runtime, or to transform themselves into a system component of another category assemblage. These abilities are captured in a <code><strong>lifeCycle</strong></code>, which describes the possible creations and transitions of system components of a given category set into another.</p>
</div>
<div class="paragraph">
<p>Since <code>components</code> belong to <code>categories</code>, different types of system components represented by different state variables, subject to different ecological processes, can coexist in a simulation. It may occur in a particular model that one wishes to represent a transition between, e.g. development stages: think for example of a caterpillar turning into a butterfly. There are chances that you don&#8217;t want to describe the caterpillar with the same variables and behaviours as the adult butterfly. The operation of transforming a system component from a selection of categories to another is called <em>recruitment</em>. Computationally, it means that the simulator must keep track of the system component&#8217;s identity and age in the first stage and carry these properties on to the new system component of the second stage, and call an appropriate function to transform state variables of the first stage into the new one.</p>
</div>
<div class="paragraph">
<p><em>Reproduction</em> is the second process by which system components of a given group of categories may produce other system components belonging to possibly different categories.</p>
</div>
<div class="paragraph">
<p>A specification of a life cycle requires:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>categorySet</code> in which the categories represent the various stages of the life cycle;</p>
</li>
<li>
<p>at least one <code>groupType</code> definition per <code>category</code> of the above <code>categorySet</code>;</p>
</li>
<li>
<p><code>recruit</code> and <code>produce</code> nodes linking categories within the above <code>categorySet</code> to describe possible recruitment and reproduction transitions;</p>
</li>
<li>
<p>optionnally, <code>categories</code> can be linked to a <code>lifeCycle</code> if one wants to attach descriptors to the life cycle.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To define a <code>groupType</code> within the context of a <code>lifeCycleType</code>, simply make it a child node of the lifeCycleType:</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203;/lifeCycleType/<strong>groupType</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>lifeCycle</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>appliesTo &#8594; categorySet:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This links indicates which categories define the stages of the life cycle. <code>recruit</code> or <code>produce</code> nodes can only link categories of this set.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>These links enable to attach descriptors to a <code>lifeCycle</code>, if needed by some ecological processes. The categories targets of these links must be specific to life cycles, i.e. no <code>componentType</code> or <code>groupType</code> should refer (<code>belongTo</code> cross-link) to any of them.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*life cycle*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*life cycle*</code> is required in all models.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*assemblage*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*assemblage*</code> is required in all models. It means that a life cycle is a population of components. Assemblages have three automatic variables: size (number of components) <code>count</code>, the number of new components added during last time step <code>nAdded</code>, and the number of components deleted during the last time step <code>nRemoved</code>.</p>
</dd>
<dt class="hdlist1"><code>belongsTo &#8594; category:*permanent*</code> {1}</dt>
<dd>
<p>This link to the predefined category <code>*permanent*</code> is required in all models. It means that life cycles will stay forever in the system.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truerecruitment"><a class="anchor" href="#truerecruitment"></a>Recruitment</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/lifeCycle/<strong>recruit</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that two categories of the life cycle <code>categorySet</code> are linked by a <em>recruitment</em> process.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>recruit</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fromCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is getting changed by the recruitment.</p>
</dd>
<dt class="hdlist1"><code>toCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is the result of the recruitment.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
multiple targets are possible from the same category, i.e. a component of a category may recruit to different categories. E.g., a bee larva can recruit to a worker or a queen.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>effectedBy &#8594; process:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which ecological process is used to compute the recruitment. This process must implement exactly one <code>ChangeCategoryDecision</code> function (<a href="#truefunction">Section 3.3.4.2.2</a>).</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truereproduction"><a class="anchor" href="#truereproduction"></a>Reproduction</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/lifeCycle/<strong>produce</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that two categories of the life cycle <code>categorySet</code> are linked by a <em>reproduction</em> process.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>produce</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fromCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is producing new system components.</p>
</dd>
<dt class="hdlist1"><code>toCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is the result of the reproduction.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
multiple targets are possible from the same category, i.e. a component of a category may produce components of different categories. E.g., a tree can produce seedlings through sexual reproduction and root suckers through vegetative reproduction.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>effectedBy &#8594; process:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which ecological process is used to compute the production of new system components. This process must implement exactly one <code>CreateOtherDecision</code> function (<a href="#truefunction">Section 3.3.4.2.2</a>).</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-of-a-life-cycle-specification"><a class="anchor" href="#trueexample-of-a-life-cycle-specification"></a>Example of a life cycle specification</h6>
<div class="paragraph">
<p>This life cycle:</p>
</div>
<div id="fig-life-cycle-example" class="imageblock text-center">
<div class="content">
<img src="example-life-cycle.svg" alt="example life cycle">
</div>
<div class="title">Figure 8. Example of a life cycle</div>
</div>
<div class="paragraph">
<p>is specified with this graph:</p>
</div>
<div id="fig-life-cycle-config-example" class="imageblock text-center">
<div class="content">
<img src="example-life-cycle.png" alt="example life cycle">
</div>
<div class="title">Figure 9. Example of a life cycle configuration</div>
</div>
<div class="paragraph">
<p>The life cycle has two categories, <em>seedling</em> and <em>adult</em>, and three transitions: a <em>recruit</em> transition called <em>recruitment</em>, effected by the function <em>Recruit</em>, and two <em>produce</em> transitions, effected by the functions <em>Seed</em> and <em>Sprout</em>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-representation-of-space"><a class="anchor" href="#truethe-representation-of-space"></a>The representation of space</h5>
<div class="paragraph">
<p>Sometimes modellers want an explicit representation of space for their model. 3Worlds provides a library of different spaces for this need (<a href="#true3worlds-library-of-spaces">Section 3.3.3.3.2</a>).
Technically, space could just be treated as a component related to other components through particular relations. But since many optimal algorithms have been coded to handle particular aspects of space in relation to other entities, we use space as a kind of container for system components optimized for various operations such as searches for partners for establishing relations (see <a href="#trueprocess">Section 3.3.4.2.1</a>).</p>
</div>
<div class="sect5">
<h6 id="truespace-and-spatial-indexing"><a class="anchor" href="#truespace-and-spatial-indexing"></a>Space and spatial indexing</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/<strong>space</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This defines a space, i.e. a container where system components can be located by their <em>spatial coordinates</em> and where distances can be computed. More than one space can coexist in 3Worlds, applying to possibly different types of components and processes. Spaces can be of 1 to 3 dimensions (this is set by choosing a space type).</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>space</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>The type of spatial representation</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>continuousFlatSurface</code>
</td>
<td class="hdlist2">
<p>a flat plan with continuous coordinates (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>squareGrid</code>
</td>
<td class="hdlist2">
<p>a flat square 2D grid for e.g. cellular automata</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>topographicSurface</code>
</td>
<td class="hdlist2">
<p>a topographic plan with elevations <strong>(not yet implemented)</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>linearNetwork</code>
</td>
<td class="hdlist2">
<p>a graph of connected segments for e.g., hydrologic networks  <strong>(not yet implemented)</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>borderType</code>
</td>
<td class="hdlist2">
<p>The space border behaviour</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>wrap</code>
</td>
<td class="hdlist2">
<p>a soft teletransporting border which sends objects crossing it to the other side of the space (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>reflection</code>
</td>
<td class="hdlist2">
<p>a hard border on which objects bounce back if they try to escape</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sticky</code>
</td>
<td class="hdlist2">
<p>a hard border on which objects stick if they try to escape</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>oblivion</code>
</td>
<td class="hdlist2">
<p>a soft border into oblivion – objects that cross it disappear into nothingness</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>infinite</code>
</td>
<td class="hdlist2">
<p>no border – space extends following object movements</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>edgeEffects</code>
</td>
<td class="hdlist2">
<p>The most common edge effect corrections</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>periodic</code>
</td>
<td class="hdlist2">
<p>wrap-around in all dimensions, i.e. leaving objects enter through the other end (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>reflective</code>
</td>
<td class="hdlist2">
<p>all borders are reflective, i.e. objects bounce on borders as on rubber walls</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>island</code>
</td>
<td class="hdlist2">
<p>a space with oblivious borders in all directions, i.e. leaving objects are lost forever</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>unbounded</code>
</td>
<td class="hdlist2">
<p>an infinite space adapting to location of items</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>bounded</code>
</td>
<td class="hdlist2">
<p>a space with sticky borders in all directions, i.e. objects that bump into the border stay there</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>tubular</code>
</td>
<td class="hdlist2">
<p>wrap around borders in the first dimension, sticky borders in all other dimensions</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>custom</code>
</td>
<td class="hdlist2">
<p>user-specified border properties – provide a borderType property</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>precision</code>
</td>
<td class="hdlist2">
<p>Spatial resolution (in space units). Two locations are considered identical if their distance is below this value.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>units</code>
</td>
<td class="hdlist2">
<p>The measurement unit for distances and coordinates in this space</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>guardAreaWidth</code>
</td>
<td class="hdlist2">
<p>The width of a guard area around the space used to define an observation window</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>observationWindow</code>
</td>
<td class="hdlist2">
<p>A rectangle defining which part of the space is visible</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>space</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>coordinate &#8594; space:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells which descriptors are used as coordinates to locate system components in this space. This link has a required property <code>rank</code> which tells to which dimension of space a coordinate refers to. For example, you may set to 1 the rank of the <em>x</em> field and to 2 the rank of the <em>y</em> field if you want your 2D space coordinates to be <em>x</em> and <em>y</em>, in this order.</p>
</dd>
<dt class="hdlist1"><code>useRNG &#8594; rng:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>Points to the random number generator channel (<a href="#truerandom-number-channels">Section 3.3.5.3</a>) to use with this space (e.g., to generate random locations). If unset, the default random number channel is used.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="true3worlds-library-of-spaces"><a class="anchor" href="#true3worlds-library-of-spaces"></a>3Worlds library of spaces</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>FlatSurface</code>: This is a 2 dimensional, continuous space with rectangular limits. Internally, it is coupled to a Quadtree (ref) to optimise the search of nearby points when establishing relations (<code>relateToDecision</code> function).</p>
<div class="paragraph">
<p><em>Additional properties for space type</em> <code>FlatSurface</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>x-limits</code>
</td>
<td class="hdlist2">
<p>An <code>Interval</code> representing the minimum and maximum values of the x (first) dimension.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>y-limits</code>
</td>
<td class="hdlist2">
<p>An <code>Interval</code> representing the minimum and maximum values of the y (second) dimension.</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>SquareGrid</code>: This is a 2 dimensional, discrete space with rectangular limits and square cells. The locations are only known at the cell level, which helps optimize searches for nearby locations.</p>
<div class="paragraph">
<p><em>Additional properties for space type</em> <code>SquareGrid</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>cellSize</code>
</td>
<td class="hdlist2">
<p>The length of the side of the (square) cells in space units</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>x-nCells</code>
</td>
<td class="hdlist2">
<p>The number of cells in the x (first) dimension.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>y-nCells</code>
</td>
<td class="hdlist2">
<p>The number of cells in the y (second) dimension.</p>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="trueshapes-and-topology"><a class="anchor" href="#trueshapes-and-topology"></a>Shapes and topology</h6>
<div class="paragraph">
<p><strong>This part is still under construction.</strong></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-setup-of-an-initial-state-for-a-simulation"><a class="anchor" href="#truethe-setup-of-an-initial-state-for-a-simulation"></a>The setup of an initial state for a simulation</h5>
<div class="paragraph">
<p>To run a simulation, an initial population of system component, group, life cycle, and system <em>instances</em> must be constructed from their respective <em>types</em> (e.g. <code>groupType</code>, <code>componentType</code>, etc.). They constitute the <em>initial state</em> of a simulation. The initial state is kept in memory by the simulator, and is re-loaded at every simulator reset prior to a new simulation run. To set descriptor values in initial instances, two methods are possible: through the use of a specific <em>function</em> (<code>setInitialState</code>, see <a href="#truefunction">Section 3.3.4.2.2</a>), or through external data files listed as <em>data sources</em><strong>[TO DO: cross ref to data source]</strong>.</p>
</div>
<div class="sect5">
<h6 id="truecomponent"><a class="anchor" href="#truecomponent"></a>Component</h6>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/componentType/<strong>component</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Use this node to instantiate components of a given <code>componentType</code>.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>component</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>nInstances</code>
</td>
<td class="hdlist2">
<p>Number of instances to create. If not set, the default behaviour is to create only one instance of this component. Otherwise, <code>nInstances</code> components are created, all with identical descriptors - unless a <code>setInitialState</code> function is used that can use random numbers to differentiate instances.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>component</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>instanceOf &#8594; group:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells to which <code>group</code> these component instances belong. It is required if <code>groupTypes</code> have been defined in the model, optional otherwise. This property is ignored if a <code>loadFrom</code> link (see below) is present.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truegroup"><a class="anchor" href="#truegroup"></a>Group</h6>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/groupType/<strong>group</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Use this node to instantiate a group of components. Use groups to set properties that are shared by a set of component instances, e.g. a species name or group-level constants.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>group</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>groupOf &#8594; componentType:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>If no <code>component</code> node is defined for this group, this link is required to specify which <code>componentType</code> should be used for instantiation of components of this group. In any other case it is not required. You can view this as a replacement for the <code>instanceOf</code> link above: either must be present for a group, but not both.</p>
</dd>
<dt class="hdlist1"><code>cycle &#8594; lifeCycle:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells in which <code>lifeCycle</code> instance this group is involved. The <code>groupType</code> of this <code>group</code> must be compatible with the <code>lifeCycleType</code> category requirements.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truelife-cycle-2"><a class="anchor" href="#truelife-cycle-2"></a>Life cycle</h6>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/lifeCycleType/<strong>lifeCycle</strong>:&lt;<em>name</em>&gt;</code></p>
</div>
<div class="paragraph">
<p>Use this node to instantiate a life cycle applying to a set of groups.</p>
</div>
</div>
<div class="sect5">
<h6 id="truesetting-decriptor-values"><a class="anchor" href="#truesetting-decriptor-values"></a>Setting decriptor values</h6>
<div class="paragraph">
<p>A first method to set descriptor values is to define a <code>setInitialState</code> function as a child of the <code>componentType</code>, <code>groupType</code>, <code>lifeCycleType</code> or <code>system</code> nodes. Such functions are only called once, at the beginning of a simulation, to setup the <em>initial state</em> of a model. In a <code>setInitialState</code> function, only drivers and constants can be set (it is the only place where constants can be set).</p>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/componentType/<strong>initFunction</strong>:&lt;<em>name</em>&gt;</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/groupType/<strong>initFunction</strong>:&lt;<em>name</em>&gt;</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/lifeCycleType/<strong>initFunction</strong>:&lt;<em>name</em>&gt;</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/system/<strong>initFunction</strong>:&lt;<em>name</em>&gt;</code></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>initFunction</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>The type of function used: only <code>setInitialState</code> is possible (cf. <a href="#truefunction">Section 3.3.4.2.2</a> for more detail on function types) .</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>initFunction</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>useRNG &#8594; rng:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>Points to the random number generator channel (<a href="#truerandom-number-channels">Section 3.3.5.3</a>) to use in this function. If unset, the default random number channel is used.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A second method to set descriptor values is to import data from an external source. This is done by defining a <code>dataSource</code> (cf. <strong>REF</strong>) and linking a <code>component</code>, <code>group</code>, <code>lifeCycle</code> or <code>system</code> to it:</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>component</code>, <code>group</code>, <code>lifeCycle</code>, and <code>system</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>loadFrom &#8594; dataSource:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells where to read the initial values of the descriptors from.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-systemdynamics-node"><a class="anchor" href="#truethe-systemdynamics-node"></a>3.3.4. The <em>system/dynamics</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/system/<strong>dynamics</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains the description of the processes that will change the state of the system and create its dynamics. It is based on the concepts of <em>time model</em>, <em>ecological process</em>, and <em>life cycle</em>. Internally, the <code><strong>dynamics</strong></code> node is the <em>simulator</em>, i.e. the object which, when kicked to do so, will make all the computations necessary to run a simulation.</p>
</div>
<div class="sect4">
<h5 id="truethe-representation-of-time"><a class="anchor" href="#truethe-representation-of-time"></a>The representation of time</h5>
<div class="paragraph">
<p>Simulation is about mimicking the dynamics of a real system. Here, dynamics is specified by attaching particular behaviours (called processes) to either <code>Categories</code> (<a href="#truecategory">Section 3.3.3.1.1</a>) or <code>relationType</code>s (<a href="#truerelationtype">Section 3.3.3.1.3</a>). Processes may act at a different rhythm or rate in nature, so we need to have a great flexibility in the way time is represented.</p>
</div>
<div class="sect5">
<h6 id="truetime-line"><a class="anchor" href="#truetime-line"></a>Time line</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/<strong>timeLine</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>Every simulator has a reference <em>time line</em>. Since different ecological processes may run according to different time models, they must refer to a common time frame for interaction to be possible among them. A <code><strong>timeLine</strong></code> defines what kind of time scale and time units can be used in a simulation. In 3Worlds, time is always discrete in the end, so that the selected values of time scale and time unit define the time <em>grain</em> of the simulation, i.e. the duration below which events are considered simultaneous. Internally, the <code>ModelRunner</code> uses integers to represent time, with 1 = one time grain.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timeLine</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>scale</code>
</td>
<td class="hdlist2">
<p>This property specifies the type of time scale to use. The usual time units pose many problems, because years, months, weeks and days are not integer multiples of each other. The option is either to use a real calendar time scale – but this is not needed in most simulation studies – or to use approximations which enable year, months, weeks and days to be integer multiples of each other (e.g. an easy approximation is to assume 30-day months, but this means years must be only 360-day long). This property proposes a set of such simplified, compatible sets of units, denoted as time scales.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>ARBITRARY</code>
</td>
<td class="hdlist2">
<p>arbitrary time units with no predefined name (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>GREGORIAN</code>
</td>
<td class="hdlist2">
<p>real calendar time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_365D</code>
</td>
<td class="hdlist2">
<p>365-days years, no weeks, no months</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_13M</code>
</td>
<td class="hdlist2">
<p>28-days months, 13-months/52-weeks years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WMY</code>
</td>
<td class="hdlist2">
<p>28-days months, 12-months/48-weeks years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_30D</code>
</td>
<td class="hdlist2">
<p>30-days months, weeks replaced by 15-days fortnights</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_366D</code>
</td>
<td class="hdlist2">
<p>366-days year, months replaced by 61-days bi-months</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LONG_TIMES</code>
</td>
<td class="hdlist2">
<p>long time units only (month or longer), calendar-compatible</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SHORT_TIMES</code>
</td>
<td class="hdlist2">
<p>short time units only (week or shorter), calendar-compatible</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONO_UNIT</code>
</td>
<td class="hdlist2">
<p>single time unit, calendar-compatible</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>shortestTimeUnit</code>
</td>
<td class="hdlist2">
<p>The shortest time unit used in this model. Note that the time scale constraints the time units compatible with each other for this property.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>UNSPECIFIED</code>
</td>
<td class="hdlist2">
<p>an arbitrary time unit (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MICROSECOND</code>
</td>
<td class="hdlist2">
<p>microsecond</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MILLISECOND</code>
</td>
<td class="hdlist2">
<p>millisecond = 1000 microseconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SECOND</code>
</td>
<td class="hdlist2">
<p>second = 1000 milliseconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MINUTE</code>
</td>
<td class="hdlist2">
<p>minute = 60 seconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>HOUR</code>
</td>
<td class="hdlist2">
<p>hour = 60 minutes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DAY</code>
</td>
<td class="hdlist2">
<p>day = 24 hours</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WEEK</code>
</td>
<td class="hdlist2">
<p>week = 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FORTNIGHT_15</code>
</td>
<td class="hdlist2">
<p>French-style fortnight = 15 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_28</code>
</td>
<td class="hdlist2">
<p>month = 4 weeks of 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_30</code>
</td>
<td class="hdlist2">
<p>month = 30 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH</code>
</td>
<td class="hdlist2">
<p>calendar month (= 1/12 of a calendar year), <em>i.e.</em> approx. 30,44 days, but with irregular durations (28,29, 30 or 31 days)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BIMONTH_61</code>
</td>
<td class="hdlist2">
<p>2 months = 61 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_336</code>
</td>
<td class="hdlist2">
<p>year = 12 months of 4 weeks of 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_360</code>
</td>
<td class="hdlist2">
<p>year = 12 months of 30 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_364</code>
</td>
<td class="hdlist2">
<p>year = 52 weeks of 7 days = 13 months of 28 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_365</code>
</td>
<td class="hdlist2">
<p>year = 365 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR</code>
</td>
<td class="hdlist2">
<p>calendar year, <em>i.e.</em> approx. 365.25 days, but with irregular durations (365 or 366 days)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_366</code>
</td>
<td class="hdlist2">
<p>year = 6 bimonths of 61 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DECADE</code>
</td>
<td class="hdlist2">
<p>decade = 10 years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CENTURY</code>
</td>
<td class="hdlist2">
<p>century = 10 decades</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MILLENNIUM</code>
</td>
<td class="hdlist2">
<p>millennium = 10 centuries</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>longestTimeUnit</code>
</td>
<td class="hdlist2">
<p>The longest time unit used in this model. <em>cf.</em> <code>shortestTimeUnit</code> for valid values</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truetimers"><a class="anchor" href="#truetimers"></a>Timers</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/timeLine/<strong>timer</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>Ecological processes may be run following different times. A timer is a particular way of representing time in the simulator. Timers may differ in parameters, like e.g. two timers using different time steps; but they can also be radically different in their logic: e.g. clock-like ticking vs. event-driven simulation.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timer</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>timeUnit</code>
</td>
<td class="hdlist2">
<p>the base time unit used by this model. <em>cf.</em> <code>timeLine.shortestTimeUnit</code> for the valid values of this property</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>nTimeUnits</code>
</td>
<td class="hdlist2">
<p>the number of base time units in the time unit of this model (<em>e.g.</em>, a model may have a 2 year time unit)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>runAtTimeZero</code>
</td>
<td class="hdlist2">
<p>whether model state must be computed at time origin, <em>i.e.</em> before simulation start</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>subclass</code>
</td>
<td class="hdlist2">
<p>the type of <code>timer</code> to use.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>ClockTimer</code>
</td>
<td class="hdlist2">
<p>Time is incremented by a constant amount <em>dt</em>. This is commonly used to simulate regular processes like growth.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>EventTimer</code>
</td>
<td class="hdlist2">
<p>Model dynamics generates <em>events</em> and computes the date in the future at which they are going to occur. This is commonly used to generate irregular processes like fire occurrence.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ScenarioTimer</code>
</td>
<td class="hdlist2">
<p><strong>Not yet implemented</strong>.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ClockTimer</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dt</code>
</td>
<td class="hdlist2">
<p>The constant time increment used in this <code>ClockTimer</code>, expressed as an integer number of <code>timer</code> base unit (=<code>timer.nTimeUnits</code> × <code>timer.timeUnit</code>). For example, if the <code>timer</code> has <code>timeUnit</code> = <code>DAY</code> and <code>nTimeUnits</code> = 3, <code>dt</code> is expressed in units of 3 days (e.g. <code>dt</code> = 2 means the time increment is 6 days).</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if calendar time is used (<code>timeLine.scale</code> = <code>GREGORIAN</code>), then <code>dt</code> will sometimes not be constant (e.g. if <code>dt</code> = 2 <code>MONTH</code>, <code>dt</code> will vary in duration between 59 and 62 days according to the exact date).
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional sub-tree when</em> <code>class = EventTimer</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/timeLine/timer/<strong>eventQueue</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>An <code>EventTimer</code> maintains a queue of time events that gets populated by ecological processes. Time events are stored in this queue based on their date and activated by the simulator following time order.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>eventQueue</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>populatedBy &#8594; function:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</dt>
<dd>
<p>These links indicate which ecological processes will populate the event queue with time events.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truesimulation-stopping-condition"><a class="anchor" href="#truesimulation-stopping-condition"></a>Simulation stopping condition</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/<strong>stoppingCondition</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A simulation may be run indefinitely (interactively), but in big simulation experiment it is useful to automatically stop the simulations according to some criterion. Besides the simplest stopping condition, reaching a maximal time value, 3Worlds provides many other possibilities to stop a simulation (e.g. based on a population size, on a variable passing a threshold value, etc.).</p>
</div>
<div class="paragraph">
<p>When no stopping condition is defined, the simulation will run indefinitely.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>stoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>subclass</code>
</td>
<td class="hdlist2">
<p>The type of stopping condition to use</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SimpleStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a maximal time value is reached.</p>
</dd>
<dt class="hdlist1"><code>ValueStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system component reaches a given value.</p>
</dd>
<dt class="hdlist1"><code>InRangeStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system gets within the given range.</p>
</dd>
<dt class="hdlist1"><code>OutRangeStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system gets out of the given range.</p>
</dd>
<dt class="hdlist1"><code>MultipleOrStoppingCondition</code></dt>
<dd>
<p>Compound stopping condition: simulation stops when <em>any</em> of the elementary stopping conditions within this multiple condition&#8217;s list is true.</p>
</dd>
<dt class="hdlist1"><code>MultipleAndStoppingCondition</code></dt>
<dd>
<p>Compound stopping condition: simulation stops when <em>all</em> of the elementary stopping conditions within this multiple condition&#8217;s list are true.</p>
</dd>
</dl>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = SimpleStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>endTime</code>
</td>
<td class="hdlist2">
<p>The time at which the simulation will stop, in time line <code>shortestTimeUnits</code>.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional cross-links when</em> <code>class = ValueStoppingCondition</code>, <code>InRangeStoppingCondition</code>,  <code>OutRangeStoppingCondition</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stopSystem &#8594; component:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>The system component in which some variable will be checked to stop the simulation.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ValueStoppingCondition</code>, <code>InRangeStoppingCondition</code>,  <code>OutRangeStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>stopVariable</code>
</td>
<td class="hdlist2">
<p>The name of the variable in <code>stopSystem</code> which values are used to decide to stop the simulation.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ValueStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>stopValue</code>
</td>
<td class="hdlist2">
<p>The value of <code>stopVariable</code> at which to stop the simulation.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = InRangeStoppingCondition</code>, <code>OutRangeStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>upper</code>
</td>
<td class="hdlist2">
<p>The upper value of the <code>stopVariable</code> range. Only <code>double</code> values are accepted.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>lower</code>
</td>
<td class="hdlist2">
<p>The lower value of the <code>stopVariable</code> range. Only <code>double</code> values are accepted.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional cross-links when</em> <code>class = MultipleOrStoppingCondition</code>, <code>MultipleAndStoppingCondition</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>condition &#8594; stoppingCondition:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>These links point to the stopping conditions that will be used as elementary stopping conditions by the multiple and/or stopping condition. Use these links to construct complex stopping conditions.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-transformations-of-a-system-component"><a class="anchor" href="#truethe-transformations-of-a-system-component"></a>The transformations of a system component</h5>
<div class="paragraph">
<p>Changes in a <em>system component</em> through time may be of different kinds: changes in <em>state</em>, i.e. in its driver and decorator variables; or more radical changes where the component actually changes <em>category</em>, so becomes represented by a different set of variables. Plus, a component may have an ephemeral life (lifespan property), which means component objects are dynamically created or deleted during a simulation.</p>
</div>
<div class="sect5">
<h6 id="trueprocess"><a class="anchor" href="#trueprocess"></a>Process</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/timeLine/timer/<strong>process</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p><em>Processes</em> are used in 3Worlds to compute change in <em>system components</em>. Each process acts on system components of a particular group of categories (cf. <a href="#truecategories">Section 1.2.3</a>, <a href="#truesystem-component">Section 3.3.3.2.1</a>) and is scheduled by a particular timer (<a href="#truetimers">Section 3.3.4.1.2</a>). Processes contain user-defined code that represents ecological processes. This gives 3Worlds its versatility: one can mix in a single model completely different ecological entities (system components of different categories), implement any ecological process depending on user needs, and put them to work on different time scales (times). A <code>process</code> is run according to its parent <code>timer</code>.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>process</code></p>
</div>
<div class="paragraph">
<p>A process can act on a single system component at a time (called the <em>focal</em> system component), or on a pair of components linked by a relation (called the <em>focal</em> and the <em>other</em> system components). This is specified using the <code>appliesTo</code> cross-link (one at least must be present):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>appliesTo &#8594; category:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>These links indicate the categories of system components that will be acted on by the process.</p>
</dd>
<dt class="hdlist1"><code>appliesTo &#8594; relation:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link indicates to which relation type between system component the process applies.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A process <strong>must</strong> apply either to categories (<em>category process</em>) or to a single relation type (<em>relation process</em>), but cannot apply to both.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dependsOn &#8594; process:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>This link tells that the process must be activated <em>after</em> the processes targeted by the links. Use this link to organize computations when there are dependencies between them.</p>
</dd>
<dt class="hdlist1"><code>inSpace &#8594; space:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link indicates that this process will make use of this space (<a href="#truethe-representation-of-space">Section 3.3.3.3</a>) for its optimisation of neighbour searches. Use this link when you want fast search for candidates to establish a relation, i.e. in association with the <code>relateToDecision</code> function. The required property <code>searchRadius</code> in the <code>inSpace</code> link tells to which <em>maximal</em> distance candidates for establishing a relation must be searched. 3Worlds will only present components at a shorter distance than <code>searchRadius</code> (possibly none) to the <code>relateToDecision</code> function. A value of zero means the algorithm searches for the closest neighbour only (possibly more than one if all exactly at the same distance), whatever its distance to the focal component.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Forgetting to set the value of <code>searchRadius</code> is a common source of unexpected behaviour in spatial models.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truefunction"><a class="anchor" href="#truefunction"></a>Function</h6>
<div class="paragraph">
<p><code>/3worlds/system/dynamics/timeLine/timer/<strong>function</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node is used to specify the details of the computations made in a <code>process</code>. The <code>process</code> defines which system components are going to be activated and at what time in the simulation course; the <code>function</code> defines which computations, in detail, will be applied to the system components of that process. This enables to build complex computations applying to one component (a series of <code>function</code>s within a <code>process</code>) in the context of a particular subset of components (<code>process</code>).</p>
</div>
<div class="paragraph">
<p>There are different types of functions, differing by the way they affect system components and relations. The selection of a function type will trigger the generation in the model java source file of a method having the name specified in the <code>function</code> node name. This method is expected to be edited by the modeller in order to implement her/his favourite version of the ecological process modelled by the function.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The name of a function must be a valid java class name, starting with an uppercase letter.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>function</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>This property specifies which kind of biological function will be implemented within the linked <code>Process</code> obect.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>ChangeState</code>
</td>
<td class="hdlist2">
<p>change the state, i.e. the values of the descriptors of a system component (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeCategoryDecision</code>
</td>
<td class="hdlist2">
<p>change category of a system component according to life cycle (has no effect if no life cycle is specified)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CreateOtherDecision</code>
</td>
<td class="hdlist2">
<p>create another system component, of the same categories if no life cycle is present, otherwise as specified by the life cycle</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DeleteDecision</code>
</td>
<td class="hdlist2">
<p>delete self</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeOtherState</code>
</td>
<td class="hdlist2">
<p><em>focal</em> changes the state of <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>RelateToDecision</code>
</td>
<td class="hdlist2">
<p><em>focal</em> establishes a new relation to <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MaintainRelationDecision</code>
</td>
<td class="hdlist2">
<p>decision to maintain or remove an existing relation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeRelationState</code>
</td>
<td class="hdlist2">
<p>change the state of a relation, i.e. possibly both the state of <em>focal</em> and <em>other</em> at the same time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SetInitialState</code>
</td>
<td class="hdlist2">
<p>sets the initial state of a newly created SystemComponent</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SetOtherInitialState</code>
</td>
<td class="hdlist2">
<p>sets the initial state of a newly created SystemComponent given a parent component</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>relateToDecision</code> function has a special status among relation processes as it is used to establish a relation, whereas all other functions for relation processes use an already established relation. As a result, a process parent to a <code>relateToDecision</code> function cannot be parent to any other type of function. For computation efficiency, it is recommended to associate a <em>space</em> (<a href="#truethe-representation-of-space">Section 3.3.3.3</a>) to the process parent to a <code>relateToDecision</code> function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>function</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>useRNG &#8594; rng:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>Points to the random number generator channel (<a href="#truerandom-number-channels">Section 3.3.5.3</a>) to use in this function. If unset, the default random number channel is used.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>function = createOtherDecision</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>relateToProduct</code>
</td>
<td class="hdlist2">
<p>A logical value (<code>false</code> by default) which tells to establish a permanent <code>parentTo</code> relation (defined in the <code>predefined</code> sub-tree:<strong>CROSSREF needed</strong>) between a parent component and its offspring created by calling <code>createOtherDecision</code>.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/function/<strong>snippet</strong>:&lt;<em>name</em>&gt;</code> {0..1}</p>
</div>
<div class="paragraph">
<p>This node is used in 3Worlds tutorial and test models  to store the java code of functions (in its <code>javaCode</code> property).</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
We recommend not to use snippets, or only for simple models, since it may cause problems when the code contained in a snippet contains compile errors, something very easy to achive when, e.g., renaming a field or table. If you use it, do it with caution.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truefunction-consequences"><a class="anchor" href="#truefunction-consequences"></a>Function consequences</h6>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/process/function/<strong>consequence</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Some functions may imply consequences: for example, a decision to delete another system component may be followed by a change in state based on the deleting component&#8217;s state at the time it is deleted. Such functions that are only activated when certain events take place are called <em>consequences</em> and may be specified by a child node to a function. Here also, rules apply:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">function</th>
<th class="tableblock halign-left valign-top">consequence</th>
<th class="tableblock halign-left valign-top">use to</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeState</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeRelationState</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeOtherState</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deleteDecision</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeOtherState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carry over values to another component linked by a <code>returnsTo</code> relation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>createOtherDecision</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setOtherInitialState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set the initial state of the new component</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relateToDecision</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>changeCategoryDecision</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setOtherInitialState</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carry over and compute values from the former component (<em>focal</em>) to the new recruit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maintainRelationDecision</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>relateToDecision</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Consequence functions have the same properties and cross-links as functions (cf. above).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truedata-tracking"><a class="anchor" href="#truedata-tracking"></a>Data tracking</h5>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/process/<strong>dataTracker</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Data trackers are used to get output from a simulation. This output can then be redirected either to graphic windows of <code>ModelRunner</code> or to a data file for later processing with other software. Using a data tracker is similar to what happens in the real world: you set a sensor into the system you want to monitor and wire it to a data logger which translates the signal into human-readable data. There are different kinds of data trackers according to the output format and the sampling method you want to use; and different ways of wiring these trackers to the simulated system and its components.</p>
</div>
<div class="paragraph">
<p>A data tracker will record values of descriptors (except constants) of a sample of system components or groups, or of the system itself and send them to any listener (usually a widget<strong>[TO DO: crossref]</strong>) linked to it. The frequency of data sending is determined by the <em>timer</em> of the parent <em>process</em> of the data tracker.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A <code>dataTracker</code> node can only be specified in a <em>category process</em>, not in a <em>relation process</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataTracker</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>samplingMode</code>
</td>
<td class="hdlist2">
<p>This property specifies how to pick system components for data tracking <em>within a group</em>. The data will be either (1) selected for one particular system component within each group, or (2) taken from that group’s own data, if any (e.g. species population size), or (3) aggregated using some statistical method ; all this, depending on the cross-links of the <code>dataTracker</code>. For (1), the default behaviour is that once a system component is selected, it will be tracked until its deletion by the simulator. In all cases, remember that the maximal number of data tracking channels is set by the <code>sampleSize</code> property; this property only tells the software how to fit the data coming from possibly many system components into the requested number of output channels.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>RANDOM</code>
</td>
<td class="hdlist2">
<p>selects system components randomly to constitute the sample (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FIRST</code>
</td>
<td class="hdlist2">
<p>selects the first system components of their group (as internally stored) to constitute the sample. Notice that components may come in any order and that this order may change unpredictably during a simulation.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LAST</code>
</td>
<td class="hdlist2">
<p>selects the last system components of their group (as internally stored) to constitute the sample. Notice that components may come in any order and that this order may change unpredictably during a simulation.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sampleSize</code>
</td>
<td class="hdlist2">
<p>How many system components at most will be tracked. Valid values are any positive integer or the keyword <code>ALL</code> to sample all the components of a given group.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>statistics</code>
</td>
<td class="hdlist2">
<p>This property lists transformations of the raw data to compute when a group contains more than one system component.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>mean</code>
</td>
<td class="hdlist2">
<p>mean (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>var</code>
</td>
<td class="hdlist2">
<p>variance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>se</code>
</td>
<td class="hdlist2">
<p>standard error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>cv</code>
</td>
<td class="hdlist2">
<p>coefficient of variation (%)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sum</code>
</td>
<td class="hdlist2">
<p>sum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>N</code>
</td>
<td class="hdlist2">
<p>count</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>min</code>
</td>
<td class="hdlist2">
<p>minimum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>max</code>
</td>
<td class="hdlist2">
<p>maximum</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>tableStatistics</code>
</td>
<td class="hdlist2">
<p>This property lists transformations of the raw data to compute in case of a table variable. The grouping is determined by the index specification in the track variable list. cf. property <code>statistics</code> for valid values.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>subclass</code>
</td>
<td class="hdlist2">
<p>The type of data tracker to use</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>DataTracker0D</code></dt>
<dd>
<p>time series tracker; returns (<em>t</em>, <em>x<sub>1</sub></em>, &#8230;&#8203;, <em>x<sub>n</sub></em>) values (where <em>t</em> is time and <em>x<sub>i</sub></em> the descriptors of interest).</p>
</dd>
<dt class="hdlist1"><code>DataTrackerXY</code></dt>
<dd>
<p>raw tracker; returns (<em>x</em>,<em>y</em>) values at each time step.</p>
</dd>
<dt class="hdlist1"><code>DataTracker2D</code></dt>
<dd>
<p><strong>unimplemented yet</strong></p>
</dd>
</dl>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>dataTracker</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>trackComponent &#8594; component:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>The <code>dataTracker</code> will track all initial components pointed by these links. If these are <em>permanent</em> components, they will be tracked until the end of the simulation. If they are <em>ephemeral</em>, <strong>they must all belong to the same <em>group</em></strong> and, when they are deleted, they will be replaced by other components of the same <em>group</em> using the sampling strategy defined by the <code>samplingMode</code> and <code>sampleSize</code> properties.</p>
</dd>
<dt class="hdlist1"><code>trackComponent &#8594; group:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>If the categories of the <code>process</code> parent of this <code>dataTracker</code> are the same as those of the <code>groupType</code> parent of the <em>group</em> pointed by this link, then the group data are tracked. If they are the same as the <code>componentType</code> of this group&#8217;s <em>components</em>, the <code>dataTracker</code> will sample the <em>group</em>  for components using the sampling strategy defined by the <code>samplingMode</code> and <code>sampleSize</code> properties.</p>
</dd>
<dt class="hdlist1"><code>trackComponent &#8594; groupType:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>The <code>dataTracker</code> will sample the <em>group type</em> pointed by this link for <em>groups</em> using the sampling strategy defined by the <code>samplingMode</code> and <code>sampleSize</code> properties.</p>
</dd>
<dt class="hdlist1"><code>trackComponent &#8594; system:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>The <code>dataTracker</code> will only track the <em>system</em> data.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The items pointed by all the <code>trackComponent</code> cross-links must belong to categories compatible with the parent <code>process</code> of the <code>dataTracker</code> (<code>process</code> <code>appliesTo</code> cross-links).
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The four <code>trackComponent</code> cross-links types cannot be used together with the same data tracker.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>trackField &#8594; field:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>The <code>dataTracker</code> will track all fields pointed by these cross-links in all objects (<em>components</em>, <em>groups</em>, or <em>system</em>) it is sampling.</p>
</dd>
<dt class="hdlist1"><code>trackTable &#8594; table:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>The <code>dataTracker</code> will track all tables pointed by these cross-links in all objects (<em>components</em>, <em>groups</em>, or <em>system</em>) it is sampling.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
the trackField or trackTable cross-links must be refer to fields or tables present in the categories of the parent <code>process</code> of the <code>dataTracker</code> (<code>process</code> <code>appliesTo</code> cross-links).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>trackField</code> <em>and</em> <code>trackTable</code> <em>cross-links</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>index</code>
</td>
<td class="hdlist2">
<p>A list of <code>String</code>s giving the range of table indices to track. The following rules are used to specify which cells of the table should be picked:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>an index specification for a table is enclosed in square brackets: <code>[]</code>;</p>
</li>
<li>
<p>vertical bars separate dimensions: e.g. <code>[||]</code> refers to a table with three dimensions;</p>
</li>
<li>
<p>a single number is used to specify a single cell in one dimension: e.g. <code>[1||]</code> refers to the cell 1 in dimension 1 (Note: this is the <em>second</em> cell in this dimension as all dimension indices start at 0 = first cell);</p>
</li>
<li>
<p>a list of cells in one dimension is specified using commas: e.g. <code>[1|0,2,7|]</code> refers to the cells 0, 2 and 7 in the second dimension;</p>
</li>
<li>
<p>a range of cells in one dimension is specified using a column: e.g. <code>[1|0,2,7|2:4]</code> refers to the cells 2,3 and 4 in the third dimension;</p>
</li>
<li>
<p>a negative number means that all cells in a dimension must be tracked <em>except</em> this number: e.g. <code>[-1|0,2,7|2:4]</code> indicates that all cells in the first dimension except cell 1 must be tracked.</p>
</li>
<li>
<p>a minus sign in front of a range means that all cells in a dimension must be tracked <em>except</em> this whole range: e.g. <code>[1|0,2,7|-2:4]</code> indicates that all cells in the third dimension except cells 2, 3 and 4 must be tracked.</p>
</li>
<li>
<p>an empty dimension means all cells in this dimension are to be tracked: e.g. <code>[1||2:4]</code> indicates that all cells in the second dimension will be tracked;</p>
</li>
<li>
<p>an empty index string <code>[]</code>, or no index string, means that the whole table (all cells) is to be tracked.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The descriptors may be elaborate hierarchical data structure which include a table at some level (<a href="#truethe-descriptor-tree">Section 3.3.5.1</a>). For each table in this hierarchy, an index <code>String</code> as described above must be given in the index property, in a comma-separated list, e.g.: [0:2|0],[4,6] means that index [0:2|0] should be used for the top-level table of the descriptor, and index [4,6] for the bottom-level table.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>[TO DO: a few examples]</strong></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-datadefinition-node"><a class="anchor" href="#truethe-datadefinition-node"></a>3.3.5. The <em>dataDefinition</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>dataDefinition</strong></code> {1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains the detailed specifications of descriptors used in a model. This information is used by 3Worlds to generate java code for the data structures that will be used in simulations of this particular model. These data structures are then made available to descendants of 3Worlds functions (<a href="#truefunction">Section 3.3.4.2.2</a>) that users will edit and modify to describe their particular model.</p>
</div>
<div class="sect4">
<h5 id="truethe-descriptor-tree"><a class="anchor" href="#truethe-descriptor-tree"></a>The descriptor tree</h5>
<div class="paragraph">
<p>Every <em>system component</em> (<a href="#truethe-specification-of-ecological-entities-system-components">Section 3.3.3.2</a>) of 3Worlds potentially holds four kinds of descriptors (<a href="#truecategory">Section 3.3.3.1.1</a>). Each of these (<em>drivers</em>, <em>decorators</em>, <em>constants</em> and <em>automatic variables</em>) is a <em>tree</em> of two kinds of data structures: <em>records</em> and <em>tables</em>. Records contain <em>fields</em>, i.e. atomic (i.e. not breakable into smaller parts) pieces of data of different types (numbers, character strings, logical values), each field having a name to access its value (i.e. field = (name,value) pair). Tables are multi-dimensional arrays of values of the same atomic type.</p>
</div>
<div class="paragraph">
<p>The data tree is constructed by allowing records to contain tables as fields (but not records), and by allowing tables to contain records all made of the same fields (but not tables) instead of atomic types. This gives end-user modellers great flexibility to organise their data into elaborate structures.</p>
</div>
<div class="sect5">
<h6 id="truerecord"><a class="anchor" href="#truerecord"></a>Record</h6>
<div class="paragraph">
<p><code>/3worlds/dataDefinition/<strong>record</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/table/<strong>record</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>record</em> is a data structure made of <em>fields</em> (=(name,value) pairs) or <em>tables</em> that represent the <em>descriptors</em> of a <em>category</em> of <em>components</em>. All descriptor trees must start with a record as their root. The record name will be turned into a java class name by the 3Worlds code generator for use in end-user code. A record may be nested in a <em>table</em>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A record cannot be empty, i.e. it <strong>must</strong> have at least one child node (field or table), see below.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truefield"><a class="anchor" href="#truefield"></a>Field</h5>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/record/<strong>field</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>field</em> is an atomic piece of data accessed by its name within a record.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>field</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>The data type of this field.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>Double</code>
</td>
<td class="hdlist2">
<p>a single precision floating point number (4 10^-38 to 3.4 10^38) with 15 significant digits (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Integer</code>
</td>
<td class="hdlist2">
<p>an integer [-2147483648; 2147483647]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Long</code>
</td>
<td class="hdlist2">
<p>a long integer [-9223372036854775808; 9223372036854775807]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Float</code>
</td>
<td class="hdlist2">
<p>a single precision floating point number (4 10^-38 to 3.4 10^38) with 6 significant digits</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Boolean</code>
</td>
<td class="hdlist2">
<p>a logical value {true, false}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>String</code>
</td>
<td class="hdlist2">
<p>a text string</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Short</code>
</td>
<td class="hdlist2">
<p>a short integer [-32768; 32767]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Char</code>
</td>
<td class="hdlist2">
<p>a character value (16-bit Unicode = UTF16, i.e. 65535 different values)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Byte</code>
</td>
<td class="hdlist2">
<p>a very, very short integer [-128 ; 127]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Object</code>
</td>
<td class="hdlist2">
<p>anything else <strong>TODO: should we keep this? it’s probably useless</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>description</code>
</td>
<td class="hdlist2">
<p>A long description of the field</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>units</code>
</td>
<td class="hdlist2">
<p>Measurement units of field values</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>precision</code>
</td>
<td class="hdlist2">
<p>Precision used for display of field values</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>interval</code>
</td>
<td class="hdlist2">
<p>Range of possible values for this field (real number types)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>range</code>
</td>
<td class="hdlist2">
<p>Range of possible values for this field (integer number types)</p>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="truedimensioner"><a class="anchor" href="#truedimensioner"></a>Dimensioner</h6>
<div class="paragraph">
<p><code>/3worlds/dataDefinition/<strong>dimensioner</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>dimensioner</em> is used to define the number of entries in a table.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dimensioner</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>size</code>
</td>
<td class="hdlist2">
<p>The number of table cells in this dimension.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truetable"><a class="anchor" href="#truetable"></a>Table</h6>
<div class="paragraph">
<p><code>/3worlds/&#8230;&#8203;/record/<strong>table</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A table is a multi-dimensional data structure containing either atomic data types or <em>records</em>, all of the same type.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>table</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dataElementType</code>
</td>
<td class="hdlist2">
<p>The data type of the elements of the table. cf property <code>field.type</code> for valid values.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>description</code>
</td>
<td class="hdlist2">
<p>A long description of the table</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>units</code>
</td>
<td class="hdlist2">
<p>Measurement units of table values</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>precision</code>
</td>
<td class="hdlist2">
<p>Precision used for display of table values</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>interval</code>
</td>
<td class="hdlist2">
<p>Range of possible values for this table (real number types)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>range</code>
</td>
<td class="hdlist2">
<p>Range of possible values for this table (integer number types)</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
These properties are not needed when the table is a table of records (cf. above).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross links for</em> <code>table</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>sizedBy &#8594; dimensioner:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link sets one dimension of a table to be of the length found in the dimensioner <code>size</code> property. The required property <code>rank</code> in the <code>sizedBy</code> edge tells the rank of the dimension. All <code>sizedBy</code> links of a table should have a different rank, in increasing order starting from 0 to the number of dimensions -1.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truerandom-number-channels"><a class="anchor" href="#truerandom-number-channels"></a>Random number channels</h5>
<div class="paragraph">
<p><code>/3worlds/dataDefinition/<strong>rng</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Simulation models make extensive use of random numbers to make decisions on components (e.g. decision to delete a component or to create new ones). 3Worlds defines random number channels, that can be attached to specific functions (<a href="#truefunction">Section 3.3.4.2.2</a>). These channels can be held constant by using the same seed in a series of simulations, thus enabling to conduct factorial experiments controlling for a source of random numbers or another.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>rng</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>algorithm</code>
</td>
<td class="hdlist2">
<p>Algorithm used to produce random numbers</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>PCG32</code>
</td>
<td class="hdlist2">
<p>Implementation of a permuted congruential generator with 32-bit output (<a href="https://en.wikipedia.org/wiki/Permuted_congruential_generator">PGC32</a>); fast (56% faster than <code>JAVA</code>) and good quality (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>JAVA</code>
</td>
<td class="hdlist2">
<p>The default Java random number generator of <code>java.util.Random</code>; medium speed, poor quality</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>XSRANDOM</code>
</td>
<td class="hdlist2">
<p>Implementation of a Xorshift random number generator as found <a href="http://demesos.blogspot.com/2011/09/replacing-java-random-generator.html">here</a>; very fast (76% faster than <code>JAVA</code>), medium quality</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>seedSource</code>
</td>
<td class="hdlist2">
<p>How to create the seed of the random number generator</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>PSEUDO</code>
</td>
<td class="hdlist2">
<p>The random number seed is produced from a call to a unique instance of <code>java.util.Random.Random()</code>. It uses time to the nanosecond to produce a ‘very likely to be distinct’ seed (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>NATURAL</code>
</td>
<td class="hdlist2">
<p>The random number seed is taken as an element in a table of 1000 natural random numbers that have been obtained from atmospheric noise. Use the property <code>tableIndex</code> to specify which item in this table should be taken for the seed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CONSTANT</code>
</td>
<td class="hdlist2">
<p>The random number seed is a constant (either 0 or 1, depending on the algorithm)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>resetTime</code>
</td>
<td class="hdlist2">
<p>When to reset the random number channel seed</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>NEVER</code>
</td>
<td class="hdlist2">
<p>The random number seed is never reset after initialisation of the random number channel (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ONRUNSTART</code>
</td>
<td class="hdlist2">
<p>The random number seed is reset to its former value for every simulation run (producing the same series of random numbers for every simulation)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>tableIndex</code>
</td>
<td class="hdlist2">
<p>Index into an <code>array[0..999]</code> of naturally generated random numbers to act as seeds for resetting</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If no random number channel is specified, 3Worlds uses a single default channel with algorithm <code>XSRANDOM</code>, seedSource <code>PSEUDO</code> and resetTime <code>NEVER</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-experiment-node"><a class="anchor" href="#truethe-experiment-node"></a>3.3.6. The <em>experiment</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>experiment</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree describe the experimental design to run using a given <em>model</em> and external data sets. Typically, il will tell <code>ModelRunner</code> how many simulations should be run, possibly varying some parameters of the model according to some plan, where data should be read and saved. The name is used to differentiate simulation experiments in a meaningful way.</p>
</div>
<div class="paragraph">
<p>The default, simplest, simulation experiment is just to run a single simulation of the <em>baseline</em> model.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>experiment</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>nReplicates</code>
</td>
<td class="hdlist2">
<p>The number of times all elementary treatments must be replicated. Use this only if there is an internal source of variation in simulations, like random numbers. Otherwise all simulations will be strictly identical.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>experiment</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>baseLine &#8594; system:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link points to a model setup (<a href="#truethe-system-node">Section 3.3.2</a>) that will be used as a <em>base line</em> simulation. A base line simulation is the equivalent of a control in a real experiment, i.e. a reference case that serves as a basis to which other treatments are compared. Often, the base line is the setup for which data is available to compare simulation outputs to.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="truesimulation-duration"><a class="anchor" href="#truesimulation-duration"></a>Simulation duration</h5>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>timePeriod</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>The duration of a particular simulation is specified using a <code>timePeriod</code> node.</p>
</div>
<div class="paragraph">
<p><strong>[TO DO: sort out the conflict between this and the stopping conditions]</strong></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timePeriod</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>start</code>
</td>
<td class="hdlist2">
<p>The starting time of a simulation in <code>timeLine</code> shortest time units.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>end</code>
</td>
<td class="hdlist2">
<p>The ending time of a simulation in <code>timeLine</code> shortest time units.</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Both properties are optional. If none is set, the simulation will start at time 0 and run indefinitely.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>timePeriod</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stopOn &#8594; stoppingCondition:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells how to stop the simulation in case no <code>end</code> property is given.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The stopping condition has the priority over the <code>end</code> property.
<strong> TO DO: check this</strong>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueexperimental-design"><a class="anchor" href="#trueexperimental-design"></a>Experimental design</h5>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>design</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>An experimental design specifies the method used to perform the simulations, e.g. number of replicate simulations, treatments as changes in parameter values or initial states, etc. An experimental design can be specified by using standard designs, or by passing a design description file.</p>
</div>
<div class="paragraph">
<p>For more information on experimental designs for simulation experiments, we recommend reading the documentation of the R software <em>planor</em> and <em>mtk</em> packages (e.g. these packages could be used to generate design files for use in 3Worlds).</p>
</div>
<div class="paragraph">
<p><strong>[TO DO: OpenMole integration]</strong></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>design</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>This property specifies an experimental design for the simulation experiment. It only provides basic, standard experimental designs. For more elaborate or specialized designs, use an ad-hoc file description of the design (<code>file</code> property, <em>cf.</em> below)</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>singleRun</code>
</td>
<td class="hdlist2">
<p>an experiment consisting of a single simulation run (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>crossFactorial</code>
</td>
<td class="hdlist2">
<p>a cross-factorial experiment based on a limited set of parameter values (factors)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>file</code>
</td>
<td class="hdlist2">
<p>This property gives the name of an experimental design file <strong>TODO : expand on this description</strong></p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueexperimental-treatments"><a class="anchor" href="#trueexperimental-treatments"></a>Experimental treatments</h5>
<div class="sect5">
<h6 id="truetreatments"><a class="anchor" href="#truetreatments"></a>Treatments</h6>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>treatment</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>An experimental treatment records a particular set of parameter values and initial state to run a simulation or a series of replicated simulations. It is the basic block of the experiment, just as in real-world experimentation.</p>
</div>
<div class="paragraph">
<p>Treatements may be specified</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in full detail: this is done by specifying more than one <code>system</code> nodes, each <code>system</code> being used for a different treatment;</p>
</li>
<li>
<p>as (minor) changes relative to the experiment <code>baseLine</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>NB: not fully implemented yet</strong></p>
</div>
</div>
<div class="sect5">
<h6 id="truetreatments-as-changes-relative-to-baseline"><a class="anchor" href="#truetreatments-as-changes-relative-to-baseline"></a>Treatments as changes relative to <em>baseLine</em></h6>
<div class="paragraph">
<p><code>/3worlds/experiment/treatment/<strong>modelChange</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p><strong>NB: not fully implemented yet</strong></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truemanaging-experiment-data"><a class="anchor" href="#truemanaging-experiment-data"></a>Managing experiment data</h5>
<div class="sect5">
<h6 id="trueinputs-datasource"><a class="anchor" href="#trueinputs-datasource"></a>Inputs: <em>dataSource</em></h6>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>dataSource</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node describes a source of data to use to instantiate a model: name of the data source, access method, etc.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataSource</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>file</code>
</td>
<td class="hdlist2">
<p>A valid data file name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>subclass</code>
</td>
<td class="hdlist2">
<p>A data format to use to read that file</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>CsvFileLoader</code>
</td>
<td class="hdlist2">
<p><a href="https://en.wikipedia.org/wiki/Comma-separated_values">comma separated value</a> <code>.csv</code> text file</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>OdfFileLoader</code>
</td>
<td class="hdlist2">
<p><a href="https://en.wikipedia.org/wiki/OpenDocument">OpenDocument</a> <code>.ods</code> spreadsheet</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>subclass = CsvFileLoader</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>separator</code>
</td>
<td class="hdlist2">
<p>the field separator used for this <code>.csv</code> file (default: tabulation <code>"\t"</code>)</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>subclass = OdfFileLoader</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>sheet</code>
</td>
<td class="hdlist2">
<p>the name of the spreadsheet to load from this <code>.ods</code> file (different spreadsheets in the same <code>.ods</code> file must be specified as different <code>dataSource</code> nodes). If this property is absent or not set, the first spreadsheet will be loaded.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>subclass = CsvFileLoader</code>, <code>OdfFileLoader</code></p>
</div>
<div class="paragraph">
<p><code>.csv</code> and <code>.ods</code> file formats both assume the data come in 2 dimensional tables with cross-references between the tables. Table columns must match parameter and driver field or table names. Table rows must match species, stage or system component instances.</p>
</div>
<div class="paragraph">
<p>The following rules must be respected when preparing the data files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The data must not contain any missing value or structural empty cells.</p>
</li>
<li>
<p>Empty lines are permitted (they are skipped).</p>
</li>
<li>
<p>Text data must not be quoted.</p>
</li>
<li>
<p>The first data line of any file or spreadsheet must contain column headers. They must match field names as defined under the <code>dataDefinition</code> node (<a href="#truethe-datadefinition-node">Section 3.3.5</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>[TO DO how to handle data hierarchy - DataLabels. cf file configuration-dataIO.adoc for other properties as this is going to change in reimplementation]</strong></p>
</div>
<div class="paragraph">
<p><em>Additional sub-tree when</em> <code>class = CsvFileLoader</code>, <code>OdfFileLoader</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/dataSource/<strong>read</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that a particular parameter/driver must be read from the file/spreadsheet. The <em>name</em> property of the <code>read</code> node must match the parameter/driver name to read. By default, when no <code>read</code> node is present, <em>all</em> parameters/drivers found in the file/spreadsheet will be read. Use <code>read</code> nodes to restrict the number of columns to read in a data source.</p>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/dataSource/<strong>dim</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node is used when reading data into tables (<a href="#truetable">Section 3.3.5.2.2</a>). The node name must be an integer matching the dimension declared in a table under the <code>dataDefinition</code> node. It must then have the following property:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>col</code>
</td>
<td class="hdlist2">
<p>header of the column containing the index values for this dimension.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>dim</code> nodes are present, the index values contained in the dimension columns specified in <code>col</code> are used to fill a table within the same 3Worlds data structure.</p>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-of-a-datasource-specification"><a class="anchor" href="#trueexample-of-a-datasource-specification"></a>Example of a <em>dataSource</em> specification</h6>
<div class="paragraph">
<p><strong>[TO DO: refactor this example when data sources are reimplemented - this example no longer holds]</strong></p>
</div>
<div class="paragraph">
<p>This <code>.csv</code> file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dim_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fecundity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mortality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dispersal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>with the following specifications:</p>
</div>
<div id="fig-data-source-example" class="imageblock text-center">
<div class="content">
<img src="example-data-source.png" alt="example data source">
</div>
<div class="title">Figure 10. Example of a data source configuration.</div>
</div>
<div class="paragraph">
<p>will result in the instantiation of a single parameter set with species='site', stage='population', and data contained in an 10-cell array of records with 3 fields, fecundity, mortality and dispersal.</p>
</div>
<div class="paragraph">
<p>How?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>property <code>idSpecies</code> states that the column labelled 'site' is the species identifier (last column of the csv file).</p>
</li>
<li>
<p>property <code>idStage</code> states that the column labelled 'stage' is the stage identifier (first column of the csv file).</p>
</li>
<li>
<p>since there is no <code>idComponent</code> property, it means this file contains stage parameter data.</p>
</li>
<li>
<p>node <code>dim</code> with <code>name</code>=1 specifies that the data to be read go into a table</p>
</li>
<li>
<p>property <code>col</code> states that the column labelled <code>dim_1</code> contains the indices for dimension 1 of the table.</p>
</li>
<li>
<p>the <code>read</code> nodes specify that the columns labelled 'fecundity', 'dispersal' and 'mortality' are to be read. Notice that these nodes were not required, since the default behaviour would have caused all these columns to be read anyway.</p>
</li>
<li>
<p>finally, the 10 different lines with different table indices (CAUTION: the indices start at 0 for 3Worlds table data structures) will all go into the same parameter set since only one (species name, stage name) pair is given here. Hence only one stage parameter set is instantiated.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="trueoutputs-datasink"><a class="anchor" href="#trueoutputs-datasink"></a>Outputs: <em>dataSink</em></h6>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>dataSink</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node describes a 'sink' where data resulting from simulation output is to be stored for later processing by other software.</p>
</div>
<div class="paragraph">
<p><strong>[Not yet implemented]</strong></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataSink</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>file</code>
</td>
<td class="hdlist2">
<p>A valid data file name</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>dataSink</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>source &#8594; dataTracker:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link the origin of the data to save into the sink. Usually, a data tracker (<a href="#truedata-tracking">Section 3.3.4.3</a>)</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-userinterface-node"><a class="anchor" href="#truethe-userinterface-node"></a>3.3.7. The <em>userInterface</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>userInterface</strong>:&lt;<em>name</em>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree specifies the look of the <code>ModelRunner</code> user interface. <code>ModelRunner</code> is highly configurable and can show many graphs during a simulation run, as help when debugging a new model; or only show a progress bar to improve computing performance when running a big simulation experiment.</p>
</div>
<div class="paragraph">
<p><strong>[HERE: refactor this part]</strong></p>
</div>
<div class="paragraph">
<p>3Worlds provides a series of interface <em>widgets</em>, i.e. graphical ojects that can be assembled to yield a usable <strong>g</strong>raphical <strong>u</strong>ser <strong>i</strong>nterface (GUI). Examples of widgets are: a window to display time series graphs, or XY maps, or simulation control buttons, or progress bars, etc&#8230;&#8203; The basic <code>ModelRunner</code> GUI just provides places where to put widgets: a <em>tool bar</em>, a <em>status bar</em>, four <em>quadrants</em>, and <em>tabs</em> within quadrants. <em>Widgets</em> can be placed inside the <em>tool bar</em>, the <em>status bar</em>, or <em>tabs</em>.</p>
</div>
<div id="fig-GUI-ModelRunner" class="imageblock text-center">
<div class="content">
<img src="GUI-ModelRunner.png" alt="GUI ModelRunner">
</div>
<div class="title">Figure 11. The ModelRunner graphical user interface.</div>
</div>
<div class="paragraph">
<p><strong>TODO: improve this figure</strong></p>
</div>
<div class="sect4">
<h5 id="truetool-bar"><a class="anchor" href="#truetool-bar"></a>Tool bar</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>toolBar</strong></code> {1}</p>
</div>
<div class="paragraph">
<p>The tool bar (always present) appears at the top of the GUI. Widgets placed there will appear beside each other <strong>[in random order ?]</strong>. The tool bar is typically the place where to put (small) widgets that must always remain visible at all time (as e.g., the widget containing the simulation controller buttons).</p>
</div>
</div>
<div class="sect4">
<h5 id="truestatus-bar"><a class="anchor" href="#truestatus-bar"></a>Status bar</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>statusBar</strong></code> {0..1}</p>
</div>
<div class="paragraph">
<p>The status bar, appearing at the bottom of the GUI <strong>[TODO: check this!]</strong>, is optional. It is meant to show quick information about the simulation run (like the current time step or the overall completion).</p>
</div>
</div>
<div class="sect4">
<h5 id="truetabs"><a class="anchor" href="#truetabs"></a>Tabs</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>tab</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>Tabs are placed within four quadrants. They are meant to host large widgets, typically output graphs and maps. Within a quadrant, tabs appear on top of each other, i.e. only the content of the top tab is visible. <strong>[NOTE: in the archetype there is no requirement for a name for tabs -  I suggest it should be a requirement that a tab has a name]</strong></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>tab</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>quadrant</code>
</td>
<td class="hdlist2">
<p>The ThreeWorlds user interface now has four areas where tabs can be placed. Each user <code>Tab</code> must have a property to specify in which quadrant it is to be added. <strong>TODO : fix this description</strong></p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>TopLeftPanel</code>
</td>
<td class="hdlist2">
<p>top left quadrant of the  ModelRunner  UI (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TopRightPanel</code>
</td>
<td class="hdlist2">
<p>top right quadrant of the  ModelRunner  UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BottomLeftPanel</code>
</td>
<td class="hdlist2">
<p>bottom left quadrant of the  ModelRunner UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BottomRightPanel</code>
</td>
<td class="hdlist2">
<p>bottom right quadrant of the ModelRunner  UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ToolbarTop</code>
</td>
<td class="hdlist2">
<p>Toolbar at the top of the ModelRunner UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ToolbarBottom</code>
</td>
<td class="hdlist2">
<p>Toolbar at the bottom  of the ModelRunner UI</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>layout</code>
</td>
<td class="hdlist2">
<p>Javafx layouts. Remove Swing constants when we are finished with Swing. There is no equivalent of Desktop in Swing - MDI is considered obsolete. It may turn out that we have to provide much more sophisticated options than this -  <strong>TODO : fix this description</strong></p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>GridPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong> (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>AnchorPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FlowPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BorderPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>HBox</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>VBox</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>StackPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TabPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TilePane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Accordion</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truewidgets"><a class="anchor" href="#truewidgets"></a>Widgets</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/&#8230;&#8203;/<strong>widget</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>Widgets are the interesting part of the GUI configuration since they do the real work. A widget may be placed inside the <code>toolBar</code>, <code>statusBar</code>, or any <code>tab</code>.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>widget</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>order</code>
</td>
<td class="hdlist2">
<p>An integer <strong>[what&#8217;s it used for?]</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>A widget class</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>TimeDisplayWidgetfx</code>
</td>
<td class="hdlist2">
<p>display simulation time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SimpleSimulationControlWidgetfx</code>
</td>
<td class="hdlist2">
<p>control a single simulation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TimeSeriesPlotWidgetfx</code>
</td>
<td class="hdlist2">
<p>plot time series output</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LabelValuePair</code>
</td>
<td class="hdlist2">
<p><strong>???</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SingleGridWidget</code>
</td>
<td class="hdlist2">
<p><strong>???</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>widget</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dataListener &#8594; dataTracker:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>This link tells the widget where to get the data from.</p>
</dd>
</dl>
</div>
<div class="sect5">
<h6 id="truetime-display"><a class="anchor" href="#truetime-display"></a>Time display</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>TimeDisplayWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>timeListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get the time values from.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truesimulation-control"><a class="anchor" href="#truesimulation-control"></a>Simulation control</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>SimpleSimulationControlWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget which engine it is going to control.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="trueplotting-time-series-data"><a class="anchor" href="#trueplotting-time-series-data"></a>Plotting time series data</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>TimeSeriesPlotWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get simulation status information (e.g. when the simulation is over, reset, paused, etc.)</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truevalue-pair-widget"><a class="anchor" href="#truevalue-pair-widget"></a>[Value pair widget]</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>LabelValuePair</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get simulation status information (e.g. when the simulation is over, reset, paused, etc.)</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truedeveloping-and-testing-model-code"><a class="anchor" href="#truedeveloping-and-testing-model-code"></a>3.4. Developing and testing model code</h3>
<div class="paragraph">
<p>This section gives general rules to follow to successfully edit the generated <code>TwFunction</code>-descendant classes in order for your model to behave as you wish. Section <a href="#truesetting_up_a_java_development_environment_for_the_user_code">Setting up a user coding environment</a> describes how to link your ModelMaker session with an eclipse development enviromnent where you can edit the generated code. Section <a href="#truefunction">Function</a> describes all the options you can setup in <code>ModelMaker</code> to specify your function.</p>
</div>
<div class="paragraph">
<p>All the generated function classes look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package system1;

import au.edu.anu.rscs.aot.collections.tables.*;
import au.edu.anu.twcore.ecosystem.runtime.system.SystemComponent;
import au.edu.anu.twcore.ecosystem.runtime.biology.ChangeStateFunction;

/*
[... some big comment...]
* Class Function1
* Model "system1" -  - Mon Sep 23 09:05:33 CEST 2019
* CAUTION: Edit this template but do not change class declaration.
*/

public class Function1 extends ChangeStateFunction {

	@Override
	public void changeState(double t, double dt, SystemComponent focal) {
		// INSERT YOUR CODE HERE
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, "<strong>system1</strong>" was the name given to the <code>system</code> node, while "<strong>Function1</strong>" was the name given to the <code>function</code> node. The <code>type</code> property set for the <code>function</code> was "<strong>ChangeState</strong>", as shown by the generated code. Other function types would have caused the generation of different methods in the class.</p>
</div>
<div class="sect3">
<h4 id="truegeneric-method-arguments"><a class="anchor" href="#truegeneric-method-arguments"></a>3.4.1. generic method arguments</h4>
<div class="paragraph">
<p>All generated methods share the following arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the first and second argument are <em>the current time</em> <em><strong>t</strong></em> and <em>current time step <strong>dt</strong></em>, passed by the simulator as double values in units of the <code>timeModel</code> of the parent <code>process</code> of the <code>function</code>.</p>
</li>
<li>
<p>For all function types which process applies to categories (<code>appliesTo &#8594;  category</code>), i.e. <code>ChangeCategoryDecision</code>, <code>ChangeState</code>, <code>DeleteDecision</code>, <code>CreateOtherDecision</code>, there is an additional argument, the system component which will be affected by the computations, called <em>focal</em>.</p>
</li>
<li>
<p>For all function types which process applies to relations (<code>appliesTo &#8594;  relationType</code>), i.e. <code>ChangeOtherCategoryDecision</code>, <code>ChangeOtherState</code>, <code>DeleteOtherDecision</code>, <code>ChangeRelationState</code>, <code>MaintainRelationDecision</code>, and for <code>RelateToDecision</code>, there  is another additional argument, a second system component, the one at the other end of the relation starting from <em>focal</em>, called <em>other</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="truegeneric-method-fields"><a class="anchor" href="#truegeneric-method-fields"></a>3.4.2. generic method fields</h4>
<div class="paragraph">
<p>In addition to these arguments, every function class has a protected field called <code>localContext</code> that contain contextual data that may be used in computations. The local context data consist in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ecosystem</em>-level data, i.e. ecosystem population data (= number [source,]</p>
<div class="listingblock">
<div class="content">
<pre>focalContext.ecosystemPopulationData
focalContext.ecosystemName</pre>
</div>
</div>
</li>
<li>
<p><em>life cycle</em>-level data, i.e. life cycle parameters, population data, and name:</p>
<div class="listingblock">
<div class="content">
<pre>focalContext.lifeCycleParameters
focalContext.lifeCyclePopulationData
focalContext.lifeCycleName</pre>
</div>
</div>
</li>
<li>
<p><em>group</em>-level data, i.e. group parameters, population data, and name. A group represents here components sharing the same categories and same parameter set (eg <em>species</em> characteristics for living organisms).</p>
<div class="listingblock">
<div class="content">
<pre>focalContext.groupParameters
focalContext.groupPopulationData
focalContext.groupCycleName</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>PopulationData</code> has 3 accessible fields: <code>count</code>, <code>nremoved</code> and <code>nAdded</code>.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> update this</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>changeState(&#8230;&#8203;)</code> method of the <code>ChangeState</code> and <code>ChangeRelationState</code> function types, and the <code>changeOtherState(&#8230;&#8203;)</code> method of the <code>ChangeOtherState</code> function type,  are expected to compute changes in state variables of the <em>focal</em> component or relation <strong>[NB: this is not yet implemented for relations]</strong>, or the <em>other</em> component in the case of the <code>ChangeOtherState</code> function. The state variables are found in <code>focal.currentState()</code>, a read-only set of values, and new values may be computed into <code>focal.nextState()</code>.</p>
</li>
<li>
<p>The <code>delete(&#8230;&#8203;)</code> method of the <code>DeleteDecision</code> and <code>DeleteOtherDecision</code> must return a <code>boolean</code> value. If <code>true</code> is returned, this will trigger the removal of the <em>focal</em> (for <code>DeleteDecision</code>) or <em>other</em> component (for <code>DeleteOtherDecision</code>).</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In all <code>&#8230;&#8203;Decision</code> functions except <code>CreateOtherDecision</code>, a helper method called <code>decide(double proba)</code> is available. This method will return true with probability <code>proba</code> and can be used to return a boolean result based on a probability computation. This method uses the in-built <a href="#a">random stream facility</a> of 3Worlds.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>nNew(&#8230;&#8203;)</code> method of the <code>CreateOtherDecision</code> function takes an extra argument called <code>newType</code>, which is the category name of the newly created component, as per the life cycle. <code>nNew(&#8230;&#8203;)</code> returns a number of new components to create as a decimal number (<code>double</code>): the <em>integral part</em> directly translates into a number of new components, while the <em>decimal part</em> is used as a probability of an extra new component. This way, very low fecundity probabilities can be simulated.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If there are &gt;1 possible descendant categories, the <code>nNew(&#8230;&#8203;)</code> method will be called as many times, with the <code>newType</code> parameter changing accordingly. The <code>nNew(&#8230;&#8203;)</code> method must be prepared to handle multiple choices in such case (for example with a <code>switch</code> statement).
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>changeCategory(&#8230;&#8203;)</code> method of the <code>ChangeCategoryDecision</code> and <code>ChangeOtherCategoryDecision</code> function types returns a category name (<code>String</code>), that of the new recruit. This name must be consistent with the life cycle information. After the function is executed, the  <em>focal</em> (for <code>ChangeCategoryDecision</code>) or the <em>other</em> (for <code>ChangeOtherCategoryDecision</code>) component is recruited to its new category.</p>
</li>
<li>
<p>The <code>maintainRelation(&#8230;&#8203;)</code> method of the <code>MaintainRelationDecision</code> and the <code>relate(&#8230;&#8203;)</code> method of the <code>RelateToDecision</code> both return a <code>boolean</code> value. If <code>true</code> is returned, the relation is maintained/set between the two components, otherwise it is removed/not set.<strong>[TODO: a lot to add when indexers come in]</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truefeeding-the-model-with-data"><a class="anchor" href="#truefeeding-the-model-with-data"></a>3.5. Feeding the model with data</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="truemodelrunner-reference-running-a-simulation-experiment"><a class="anchor" href="#truemodelrunner-reference-running-a-simulation-experiment"></a>4. ModelRunner reference: running a simulation experiment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truegeneral-concepts"><a class="anchor" href="#truegeneral-concepts"></a>4.1. General concepts</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="trueusing-modelrunner-software-interface-and-functioning"><a class="anchor" href="#trueusing-modelrunner-software-interface-and-functioning"></a>4.2. Using ModelRunner: software interface and functioning</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="truegetting-output-from-a-simulation-experiment"><a class="anchor" href="#truegetting-output-from-a-simulation-experiment"></a>4.3. Getting output from a simulation experiment</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truesample-models-and-tutorials"><a class="anchor" href="#truesample-models-and-tutorials"></a>5. Sample models and tutorials</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.3<br>
Last updated 2021-04-07 16:48:06 +0200
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>