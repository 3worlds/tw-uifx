<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5.dev">
<meta name="author" content="Jacques Gignoux, Ian D. Davies, Shayne R. Flint">
<title>3Worlds user manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>3Worlds user manual</h1>
<div class="details">
<span id="author" class="author">Jacques Gignoux</span><br>
<span id="email" class="email"><a href="mailto:jacques.gignoux@upmc.fr">jacques.gignoux@upmc.fr</a></span><br>
<span id="author2" class="author">Ian D. Davies</span><br>
<span id="email2" class="email"><a href="mailto:ian.davies@anu.edu.au">ian.davies@anu.edu.au</a></span><br>
<span id="author3" class="author">Shayne R. Flint</span><br>
<span id="email3" class="email"><a href="mailto:shayne.flint@anu.edu.au">shayne.flint@anu.edu.au</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#truepurpose-and-motivation">1. Purpose and motivation</a></li>
<li><a href="#truegetting-started-download-and-installation">2. Getting started - download and installation</a>
<ul class="sectlevel2">
<li><a href="#truebasics-what-you-must-know-before-starting">2.1. Basics - what you must know before starting</a></li>
<li><a href="#trueprerequisites">2.2. Prerequisites</a></li>
<li><a href="#truerunning-modelmaker-standalone">2.3. Running ModelMaker standalone</a></li>
<li><a href="#truesetting-up-a-java-development-environment-for-the-user-code">2.4. Setting up a java development environment for the user code</a>
<ul class="sectlevel3">
<li><a href="#truesetting-up-an-eclipse-ide-for-3worlds">2.4.1. Setting up an eclipse IDE for 3Worlds</a></li>
<li><a href="#truerunning-modelmaker-from-eclipse">2.4.2. Running ModelMaker from eclipse</a></li>
<li><a href="#truelinking-user-code-with-model-configuration">2.4.3. Linking user code with model configuration</a></li>
<li><a href="#truedebugging-and-testing-user-code">2.4.4. Debugging and testing user code</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truemodelmaker-reference-creating-and-editing-a-model">3. ModelMaker reference: creating and editing a model</a>
<ul class="sectlevel2">
<li><a href="#truegeneral-concepts-structure-of-a-3worlds-configuration">3.1. General concepts: structure of a 3Worlds configuration</a>
<ul class="sectlevel3">
<li><a href="#truea-tree-structure">3.1.1. A tree structure&#8230;&#8203;</a></li>
<li><a href="#true-with-cross-links">3.1.2. &#8230;&#8203;with cross-links</a></li>
<li><a href="#truewhat-modelmaker-does-for-you">3.1.3. What ModelMaker does for you</a></li>
</ul>
</li>
<li><a href="#trueusing-modelmaker-software-interface-and-functioning">3.2. Using ModelMaker: software interface and functioning</a></li>
<li><a href="#trueconfiguration-options-reference">3.3. Configuration options: reference</a>
<ul class="sectlevel3">
<li><a href="#truethe-em-3worlds-em-node">3.3.1. The <em>3Worlds</em> node</a></li>
<li><a href="#truethe-em-ecology-em-node">3.3.2. The <em>ecology</em> node</a></li>
<li><a href="#truethe-em-codesource-em-node">3.3.3. The <em>codeSource</em> node</a></li>
<li><a href="#truethe-em-dataio-em-node">3.3.4. The <em>dataIO</em> node</a></li>
<li><a href="#truethe-em-experiment-em-node">3.3.5. The <em>experiment</em> node</a></li>
<li><a href="#truethe-em-userinterface-em-node">3.3.6. The <em>userInterface</em> node</a></li>
<li><a href="#truethe-em-hardware-em-node">3.3.7. The <em>hardware</em> node</a></li>
</ul>
</li>
<li><a href="#truedeveloping-and-testing-model-code">3.4. Developing and testing model code</a></li>
<li><a href="#truefeeding-the-model-with-data">3.5. Feeding the model with data</a>
<ul class="sectlevel3">
<li><a href="#truelet-the-model-decide">3.5.1. Let the model decide</a></li>
<li><a href="#trueprovide-parameters-and-initial-state-through-modelmaker">3.5.2. Provide parameters and initial state through ModelMaker</a></li>
<li><a href="#trueimport-data-from-external-sources">3.5.3. Import data from external sources</a></li>
<li><a href="#trueuse-previously-saved-initial-states">3.5.4. Use previously saved initial states</a></li>
<li><a href="#truegenerate-an-initialstate-using-the-initwizard">3.5.5. Generate an initialState using the InitWizard</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truemodelrunner-reference-running-a-simulation-experiment">4. ModelRunner reference: running a simulation experiment</a>
<ul class="sectlevel2">
<li><a href="#truegeneral-concepts">4.1. General concepts</a></li>
<li><a href="#trueusing-modelrunner-software-interface-and-functioning">4.2. Using ModelRunner: software interface and functioning</a></li>
<li><a href="#truegetting-output-from-a-simulation-experiment">4.3. Getting output from a simulation experiment</a></li>
</ul>
</li>
<li><a href="#truesample-models-and-tutorials">5. Sample models and tutorials</a>
<ul class="sectlevel2">
<li><a href="#truetutorial-1-construct-and-run-a-model-for-the-first-time">5.1. Tutorial 1: Construct and run a model for the first time</a>
<ul class="sectlevel3">
<li><a href="#truecreating-a-model-configuration">5.1.1. Creating a model configuration</a></li>
<li><a href="#truerunning-a-model">5.1.2. Running a model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="truepurpose-and-motivation"><a class="anchor" href="#truepurpose-and-motivation"></a>1. Purpose and motivation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Why another simulation environment?</p>
</div>
<div class="paragraph">
<p>Ecosystems, as first proposed by Arthur Tansley in 1935, have both physical and biological aspects. They comprise not only energy and chemical stocks and flows but also living things that are born, reproduce and die, exhibiting particular behaviours over the course of their existence. They are made from and return to the physical world (dust to dust, ashes to ashes) and at one and the same time, are part of it – compete with and facilitate the existence of other living things. To this day, reconciling these two aspects remains a key problem in ecosystem studies.</p>
</div>
<div class="paragraph">
<p>In addition to this physical and biological duality, ecosystems are multi-scale and the ability to modify scale, in not only the ordinary sense of a change in extent and resolution but also by increasing or decreasing detail through adding or removing sub-systems at different scales, is a key motivation behind this project. At what level of detail should we model our system to capture its important behaviour? How does changing scale (in the broadest sense) effect model outcomes?</p>
</div>
<div class="paragraph">
<p>Models built using 3Worlds conform to an archetype of what we believe constitutes an ecosystem – a recursive and multi-scale system of interacting entities. They are recursive because (eco)systems can be made of (eco)systems. They are multi-scale because the processes we may wish to include in our model system may operate at different rates. The great benefit of this is that while we believe it’s possible to construct any type of model within this archetype, imposing specification constraints greatly assists in model comparison: why should two models, ostensibly constructed for the same purpose, differ in their outputs? How does a change in temporal or spatial scale affect projections?  How does adding or removing sub-systems change model projections?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truegetting-started-download-and-installation"><a class="anchor" href="#truegetting-started-download-and-installation"></a>2. Getting started - download and installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truebasics-what-you-must-know-before-starting"><a class="anchor" href="#truebasics-what-you-must-know-before-starting"></a>2.1. Basics - what you must know before starting</h3>
<div class="paragraph">
<p>3Worlds is an application designed to develop and launch simulations of ecosystems.
It is highly versatile and can simulate any kind of ecosystem using any kind of mathematical logic.</p>
</div>
<div class="paragraph">
<p>The application and use of 3Worlds to a particular ecosystem for a particular study case is called a <em>model</em>&#8201;&#8212;&#8201;or, more precisely a <em>simulation</em> model.
The model must first be specified and developed (this involves writing some code in the java programming language) before it can be executed for a particular case study.
This execution is called a <em>simulation experiment</em>.</p>
</div>
<div class="paragraph">
<p>3Worlds comprises two main applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ModelMaker</code>, to configure a model;</p>
</li>
<li>
<p><code>ModelRunner</code>, to run the model.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creating a model involves creating a configuration with <code>ModelMaker</code> and developing some associated java code to specify details particular to your model.
To do this, you must use the <a href="https://www.eclipse.org/downloads/">eclipse</a> programming software (freeware). Later versions of 3Worlds may support other packages, but at the time of writing, 3Worlds will only work with <a href="https://www.eclipse.org/downloads/">eclipse</a>.</p>
</div>
<div class="paragraph">
<p><code>ModelMaker</code> will generate java code for data structures specific to a model (based on the configuration file you have developed) and <em>template</em> java code for each process you have defined. These process templates are where you enter programming code to implement your model. You only need to write  code for your processes and for model initialisation. All else is managed by 3Worlds.</p>
</div>
<div class="paragraph">
<p>3Worlds is written in <a href="https://en.wikipedia.org/wiki/Java_(programming_language)">java</a>, which makes it OS-independent. It can be run on MacOS, Linux or Windows computers.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueprerequisites"><a class="anchor" href="#trueprerequisites"></a>2.2. Prerequisites</h3>
<div class="paragraph">
<p>You must have the following software installed on your computer prior to install 3Worlds:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>java JDK (<strong>J</strong>ava <strong>D</strong>evelopment <strong>K</strong>it), version 8 or greater (<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">oracle</a> or <a href="http://openjdk.java.net/">open</a> version)</p>
</li>
<li>
<p>java fx (graphical user interface library for java: <a href="http://www.oracle.com/technetwork/java/javase/overview/javafx-overview-2158620.html">oracle</a> or <a href="http://openjdk.java.net/projects/openjfx/">open</a> version)</p>
</li>
<li>
<p>an <a href="https://www.eclipse.org/downloads/">eclipse</a> java code development environment. You must:</p>
<div class="ulist">
<ul>
<li>
<p>install <a href="https://www.eclipse.org/downloads/">eclipse</a></p>
</li>
<li>
<p>install the <a href="https://www.eclipse.org/efxclipse/install.html">e(fx)clipse plugin</a> required to use javafx</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="truerunning-modelmaker-standalone"><a class="anchor" href="#truerunning-modelmaker-standalone"></a>2.3. Running ModelMaker standalone</h3>
<div class="paragraph">
<p>This assumes you have downloaded <code>3w.zip</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unzip <code>3w.zip</code> in your user home directory (important), keeping the internal directory tree. This will extract a file <code>modelMaker.jar</code> and a <code>.3w</code> directory containing more jar files.</p>
</li>
<li>
<p>Double-click on <code>modelMaker.jar</code>. This should launch the ModelMaker application.</p>
</li>
<li>
<p>If this does not work, open a terminal and type <code>java -jar modelMaker.jar</code>. This should launch the ModelMaker application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The last is the preferred method as any errors that may arise will appear in the terminal window.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: to develop your model-specific code, you will need to setup a java development environment as shown in section <a href="#truesetting-up-a-java-development-environment-for-the-user-code">Setting up Java</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="truesetting-up-a-java-development-environment-for-the-user-code"><a class="anchor" href="#truesetting-up-a-java-development-environment-for-the-user-code"></a>2.4. Setting up a java development environment for the user code</h3>
<div class="sect3">
<h4 id="truesetting-up-an-eclipse-ide-for-3worlds"><a class="anchor" href="#truesetting-up-an-eclipse-ide-for-3worlds"></a>2.4.1. Setting up an eclipse IDE for 3Worlds</h4>
<div class="paragraph">
<p>This assumes you have downloaded <code>UserCodeRunner.java</code>, <code>threeWorlds.jar</code> and <code>tw-dep.jar</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If not yet done, install <a href="https://www.eclipse.org/downloads/">eclipse</a> (don&#8217;t forget <a href="https://www.eclipse.org/efxclipse/install.html">e(fx)clipse</a>!)</p>
</li>
<li>
<p>Create at <em>workspace</em> (= a working directory for eclipse - eclipse will ask for it when launched). e.g., <em>&lt;my_workspace&gt;</em></p>
</li>
<li>
<p>Within eclipse, create a <em>project</em>:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>File &#8594; New &#8594; Java project</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, type a project name (e.g. <em>&lt;my_project&gt;</em>)</p>
</li>
<li>
<p>Click the <code>Finish</code> button</p>
</li>
</ul>
</div>
</li>
<li>
<p>Import <code>UserCodeRunner.java</code> in the project:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>File &#8594; Import</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, select <code>general &gt; File System</code></p>
</li>
<li>
<p>Click the <code>next</code> button</p>
</li>
<li>
<p>Click on the <code>Browse</code> button to select the directory where <code>UserCodeRunner.java</code> is located</p>
</li>
<li>
<p>Select the proper file in the list</p>
</li>
<li>
<p>Select <code>/src</code> as the destination location in the project</p>
</li>
<li>
<p>Click the <code>Finish</code> button</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>UserCodeRunner.java</code> should now appear as the unique member of a <code>default</code> package, with a compile error message attached to it.</p>
</div>
</li>
<li>
<p>Update libraries required by the project:</p>
<div class="ulist">
<ul>
<li>
<p>Select menu <code>Project &#8594; Properties</code>; this opens a dialog box</p>
</li>
<li>
<p>In the dialog box, select <code>Java Build Path</code></p>
</li>
<li>
<p>Select the <code>Libraries</code> tab</p>
</li>
<li>
<p>Click on the <code>Add external JARs&#8230;&#8203;</code> button; this open a file selection dialog box</p>
</li>
<li>
<p>In the file selection dialog box, browse and select <code>threeWorlds.jar</code></p>
</li>
<li>
<p>Repeat the two previous operations for <code>tw-dep.jar</code></p>
</li>
<li>
<p>Click the <code>Apply and Close</code> button</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>UserCodeRunner.java</code> should now have no compile errors.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truerunning-modelmaker-from-eclipse"><a class="anchor" href="#truerunning-modelmaker-from-eclipse"></a>2.4.2. Running ModelMaker from eclipse</h4>
<div class="paragraph">
<p>ModelMaker can be run as a standalone application, or from eclipse since it is included in the <code>threeWorlds.jar</code> library required to developed the user code.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>package explorer</code> window, expand the <code>Referenced libraries</code> entry</p>
</li>
<li>
<p>Right-click on the <code>threeWorlds.jar</code> entry, select <code>Run as &#8594; Java Application</code>. This opens a dialog box</p>
</li>
<li>
<p>In the dialog box, type <code>ModelMakerfx</code> and click <code>OK</code></p>
</li>
<li>
<p>If a dialog box appears warning for errors, click <code>Proceed</code>. This launches the ModelMaker application</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="truelinking-user-code-with-model-configuration"><a class="anchor" href="#truelinking-user-code-with-model-configuration"></a>2.4.3. Linking user code with model configuration</h4>
<div class="paragraph">
<p>This requires the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In ModelMaker,</p>
<div class="ulist">
<ul>
<li>
<p>create or open a <em>3Worlds</em> project (<code>Projects</code> entry of the main menu)</p>
</li>
<li>
<p>select <code>Preferences &#8594; Java Project &#8594; Connect&#8230;&#8203;</code>. This opens a dialog box with a file selector</p>
</li>
<li>
<p>select the root directory of the <em>eclipse</em> project as created above (e.g. <em>&lt;my_workspace&gt;</em>/<em>&lt;my_project&gt;</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This operation tells <code>ModelMaker</code> to generate its code into the user java project.
When you want to edit your code in eclipse, you must first <strong>refresh</strong> the eclipse project:</p>
</div>
</li>
<li>
<p>In eclipse,</p>
<div class="ulist">
<ul>
<li>
<p>select the project name at the very top of the <code>package explorer</code> window</p>
</li>
<li>
<p>right-click on it and select <code>Refresh</code></p>
</li>
<li>
<p>or, alternatively: press the F5 key</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truedebugging-and-testing-user-code"><a class="anchor" href="#truedebugging-and-testing-user-code"></a>2.4.4. Debugging and testing user code</h4>
<div class="paragraph">
<p>The user code, first generated by <code>ModelMaker</code> and further edited by the user, can be run using <code>UserCodeRunner.java</code>.
It requires two command line arguments (we assume that you know how to setup and run a <code>Run Configuration</code> in eclipse):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the name of the directory of the 3Worlds project as created by <code>ModelMaker</code> (e.g. <em>project_test_model_9_D89EF3043496-000001636846F7AF-0000</em>). This project directory is located under the <code>.3w</code> directory automatically created by <code>ModelMaker</code> as its working directory</p>
</li>
<li>
<p>the name of the model configuration file in this directory (e.g. <em>test_model_9.dsl</em>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With this, the user code should be executed as a test simulation by <code>UserCodeRunner</code>.
Further edits and modifications of the configuration can be made in <code>ModelMaker</code>, but do not forget to keep the eclipse project content synchronized with the ModelMaker project by refreshing the eclipse project as often as necessary.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truemodelmaker-reference-creating-and-editing-a-model"><a class="anchor" href="#truemodelmaker-reference-creating-and-editing-a-model"></a>3. ModelMaker reference: creating and editing a model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truegeneral-concepts-structure-of-a-3worlds-configuration"><a class="anchor" href="#truegeneral-concepts-structure-of-a-3worlds-configuration"></a>3.1. General concepts: structure of a 3Worlds configuration</h3>
<div class="sect3">
<h4 id="truea-tree-structure"><a class="anchor" href="#truea-tree-structure"></a>3.1.1. A tree structure&#8230;&#8203;</h4>
<div class="paragraph">
<p>The configuration of a 3Worlds <em>simulation experiment</em> is organised as a tree (<em>cf.</em> figure <a href="#fig-configuration-tree">Tree structure of a simulation experiment configuration in 3Worlds</a>). Each tree <em>node</em> specifies a subset of the parameters of the whole configuration. Each <em>node</em> has <em>child nodes</em> linked through a <em>tree edge</em>, so that large pieces of configuration can be broken down into the relevant details. At each level of this hierarchy, <em>properties</em> can be attached to <em>nodes</em>.</p>
</div>
<div class="paragraph">
<p><em>Nodes</em> have a <em>label</em> and a <em>name</em> that are displayed in the <code>ModelMaker</code> interface as <code>label:name</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>label</em> specifies what role this particular <em>node</em> plays in the whole configuration. For example, the <em>node</em> labelled <code>experiment</code> is used to configure a <em>simulation experiment</em>.</p>
</li>
<li>
<p>The <em>name</em> is used to differentiate <em>nodes</em> that have the same <em>label</em>. It is optional for certain types of <em>nodes</em>. For example, a configuration could have two <em>simulation experiments</em>, one named <code>baseLine</code> and one named <code>my favourite experiment</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>root node</em> of a configuration is always labelled <code>3worlds</code>.</p>
</div>
<div id="fig-configuration-tree" class="imageblock" style="text-align: center">
<div class="content">
<img src="dsl-tree.svg" alt="dsl tree.svg">
</div>
<div class="title">Figure 1. Tree structure of a simulation experiment configuration in 3Worlds</div>
</div>
<div class="paragraph">
<p>The configuration tree is stored in a file in a specially designed text format, ending with the extension <code>.dsl</code> or <code>.twg</code>. Such files are produced by <code>ModelMaker</code> and can then be exchanged and imported into <code>ModelMaker</code> via the <code>Projects&gt;Import&#8230;&#8203;</code> menu entry. Their format is human-readable, but they must <strong>never</strong> be edited with another software than <code>ModelMaker</code> - <strong>the risk is to corrupt all your configuration</strong> and be unable to run it (or even edit it with <code>ModelMaker</code> again).</p>
</div>
<div class="paragraph">
<p>Each <em>node</em> in the configuration has a particular meaning for <code>ModelRunner</code>: the configuration must comply with certain rules and constraints, the first one being the particular set of <em>nodes</em> that have been designed and appear on figure <a href="#fig-configuration-tree">Tree structure of a simulation experiment configuration in 3Worlds</a>. The detailed meaning of all <em>nodes</em> and their <em>properties</em> is described in section <a href="#truereference-of-3worlds-configuration">3Worlds reference</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="true-with-cross-links"><a class="anchor" href="#true-with-cross-links"></a>3.1.2. &#8230;&#8203;with cross-links</h4>
<div class="paragraph">
<p>Actually, the 3Worlds configuration is not stritcly hierarchical: according to their role in <code>ModelRunner</code>, some configuration <em>nodes</em> need to gather information from other parts of the configuration tree. This is done by allowing for some cross-reference <em>edges</em> to be defined, that overlay with the strict hierarchical structure of the tree. As a result fo these cross links, the whole configuration is a <em>graph</em> rather than a tree.</p>
</div>
<div class="paragraph">
<p><em>Edges</em> representing cross links have a <em>label</em>, <em>name</em>, and may have <em>properties</em> just as <em>nodes</em> do. The detailed meaning of all cross-reference <em>edges</em> and their <em>properties</em> is described in section <a href="#">[#]</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="truewhat-modelmaker-does-for-you"><a class="anchor" href="#truewhat-modelmaker-does-for-you"></a>3.1.3. What ModelMaker does for you</h4>
<div class="paragraph">
<p><code>ModelMaker</code> knows the details of the configuration constraints. It facilitates the design of a configuration by only letting you add the <em>nodes</em>, <em>edges</em> and <em>properties</em> that will produce a valid, runnable configuration file. During the configuration building process, it constantly checks the validity of the graph and reports any errors or missing parts in its <code>log</code> panel. <code>ModelMaker</code> is far more than a nice visual editor producing a graph: a configuration graph produced with <code>ModelMaker</code> is <strong>guaranteed</strong> to run with <code>ModelRunner</code> because of all these internal consistency and validity checks.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueusing-modelmaker-software-interface-and-functioning"><a class="anchor" href="#trueusing-modelmaker-software-interface-and-functioning"></a>3.2. Using ModelMaker: software interface and functioning</h3>
<div class="paragraph">
<p><strong>TO DO</strong>: step-by-step description of using the user interface. With screenshots.</p>
</div>
</div>
<div class="sect2">
<h3 id="trueconfiguration-options-reference"><a class="anchor" href="#trueconfiguration-options-reference"></a>3.3. Configuration options: reference</h3>
<div class="paragraph">
<p>In this section,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>node and edge labels are indicated in <code><strong>bold</strong></code></p>
</li>
<li>
<p>text in triangular brackets (<code>&lt;&gt;</code>) mean a user-defined value is expected; the text usually specifies what kind of value is expected (e.g. <code>&lt;<em>name</em>&gt;</code> for a name, <code>&lt;<em>int</em>&gt;</code> for an integer number, etc.). If the text is required, it will be <span class="underline">underlined</span>, otherwise it is optional</p>
</li>
<li>
<p>a <em>multiplicity</em> in curly braces {} tells how many times the item may appear in a configuration:</p>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
{1}
</td>
<td class="hdlist2">
<p>exactly one item is required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{0..1}
</td>
<td class="hdlist2">
<p>the item is optional, i.e. one or zero is required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{1..*}
</td>
<td class="hdlist2">
<p>one to many items are required</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{0..*}
</td>
<td class="hdlist2">
<p>any number of items is possible</p>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>levels in the tree hierarchy are indicated by slashes <code>/</code>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="truethe-em-3worlds-em-node"><a class="anchor" href="#truethe-em-3worlds-em-node"></a>3.3.1. The <em>3Worlds</em> node</h4>
<div class="paragraph">
<p><code>/<strong>3worlds</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node is the root of any 3Worlds configuration file. The name will appear in <code>ModelMaker</code>'s main window title, in the <strong>project directory name</strong> and in the <strong>configuration graph file</strong>. The name is requested and set when creating a new project (<code>Projects&gt;New</code> menu entry in <code>ModelMaker</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-ecology-em-node"><a class="anchor" href="#truethe-em-ecology-em-node"></a>3.3.2. The <em>ecology</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>ecology</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains all the ecological concepts used to define a simulation model: what entities are modelled, what biological processes apply to them, at what time step they should run. The name is used to differentiate models as a simulation experiment may involve more than one model.</p>
</div>
<div class="sect4">
<h5 id="truethe-em-partition-em-em-category-em-em-relation-em-concepts-specification-of-groups-of-entities"><a class="anchor" href="#truethe-em-partition-em-em-category-em-em-relation-em-concepts-specification-of-groups-of-entities"></a>The <em>partition</em>/<em>category</em>/<em>relation</em> concepts: specification of groups of entities</h5>
<div class="paragraph">
<p>3Worlds uses these concepts to specify the ecological entities manipulated during a simulations.</p>
</div>
<div class="sect5">
<h6 id="truecategory"><a class="anchor" href="#truecategory"></a>Category</h6>
<div class="paragraph">
<p><code>&#8230;&#8203;/partition/<strong>category</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>A <code><strong>category</strong></code> is simply a name attached to a set of objects sharing common properties. Practically, these common properties are <em>state variables</em>, <em>parameters</em> and dynamic behaviours (or <em>processes</em>). Categories and partitions constitute a user-defined <em>classification</em> of <em>system component types</em> relevant for a particular model.</p>
</div>
<div class="paragraph">
<p>To make this classification useful, we attach <em>parameters</em> and <em>state variables</em> to categories. State variables are variables (numbers, text, logical values) that characterize the state of a system component at an instant in time (<em>e.g.</em> biomass, age, sex, social status&#8230;&#8203;). They will vary during a simulation. Parameters do not vary during a simulation; they are characteristic of a set of system components sharing them&#8201;&#8212;&#8201;conceptually, a 'species' (e.g. average individual growth rate, mortality rate&#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>Practically, this means that any instance of a system component of a given category will implement the state variables of this category and share parameters with other system components of the same 'species'.</p>
</div>
<div class="paragraph">
<p>The exact data structures for state variables and parameters are specified under the <a href="#truethe-em-codesource-em-node">codeSource</a> node and linked to the category through the following:</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>category</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>parameters &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells which record data structure (in <a href="#truethe-em-codesource-em-node">codeSource</a>) is used to store parameters.</p>
</dd>
<dt class="hdlist1"><code>drivers &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dt class="hdlist1"><code>decorators &#8594; record:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>Similarly, these links tell which data structure in <a href="#truethe-em-codesource-em-node">codeSource</a> is used to store state variables. State variables are further classified into <em>drivers</em>, i.e. variables that <em>drive</em> the dynamics of the system; and <em>decorators</em>, i.e. secondary state variables which values are computed from those of the drivers, only reflecting the dynamics of the drivers.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A category may be defined with no parameters, drivers or decorators, but it would be pretty useless to have neither of them.</p>
</div>
</div>
<div class="sect5">
<h6 id="truepartition"><a class="anchor" href="#truepartition"></a>Partition</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>partition</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>Some categories must be exclusive of each other: for example, an ecological entity is either a plant or an animal, but can&#8217;t be both. For this reason, <em>exclusive</em> categories are grouped into <code><strong>partitions</strong></code>. A partition is <em>a set of <strong>mutually exclusive</strong> categories</em>. A partition may apply only to categories of a particular type (defined in another, higher level, partition). Hence categories can be nested:</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203;/category/<strong>partition</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
</div>
<div class="sect5">
<h6 id="truerelation"><a class="anchor" href="#truerelation"></a>Relation</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>relation</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <code><strong>relation</strong></code> is just a name representing a meaningful link between two categories. It is specified by giving it a name and cross-linking it to the relevant categories with <code>fromCategory</code> or <code>toCategory</code> cross-links. Note that a relation can link more than one 'from' categories to more than one 'to' categories if required. Relations are used to implement specific processes acting on ecological entities (for example, a predation process).</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>relation</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fromCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells which categories are at the start of the relation.</p>
</dd>
<dt class="hdlist1"><code>toCategory &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells which categories are at the end of the relation</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>relation</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>lifespan</code>
</td>
<td class="hdlist2">
<p>This property specifies if this type of relation will stay attached to its <code>systemComponents</code> during all their life, or may get created and deleted during their lifespan.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>permanent</code>
</td>
<td class="hdlist2">
<p>(1) system component stays forever during a simulation, (2) relation stays as long as both its ends stay (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ephemeral</code>
</td>
<td class="hdlist2">
<p>system component / relations are created and deleted during a simulation by the means of the appropriate  <code>Function</code> classes (e.g. <code>DeleteDecision</code>, <code>CreateOtherDecision</code>, etc. cf. <code>TwFunctionTypes</code>)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-a-category-partition-tree"><a class="anchor" href="#trueexample-a-category-partition-tree"></a>Example: a category / partition tree</h6>
<div class="paragraph">
<p>On this diagram (generated with <code>ModelMaker</code>), hierarchical links are in green and cross-links are in black.</p>
</div>
<div id="fig-category-example" class="imageblock" style="text-align: center">
<div class="content">
<img src="example-category.png" alt="example category.png">
</div>
<div class="title">Figure 2. Example of a configuration with partitions, categories and relations</div>
</div>
<div class="paragraph">
<p>In this example, a <em>plant</em> can be a <em>C3 tree</em> but cannot be simultaneously a <em>grass</em> and a <em>liana</em>. Similarly, an <em>animal</em> cannot be both <em>herbivore</em> and <em>carnivore</em>. The <em>predation</em> relation links an <em>animal</em> of any kind (the prey) to a <em>carnivore</em> (its predator).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-specification-of-ecological-entities-em-system-components-em"><a class="anchor" href="#truethe-specification-of-ecological-entities-em-system-components-em"></a>The specification of ecological entities: <em>system components</em></h5>
<div class="sect5">
<h6 id="truesystem-component"><a class="anchor" href="#truesystem-component"></a>System component</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>system</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>3Worlds simulates a <em>system</em> made of <em>system components</em>. These are the things which are instantiated at run time, hold state variables, and are dynamically changed over the time course of a simulation. When setting up a simulation, one must attach <em>categories</em> to <em>system components</em>. The rules prevailing to build up partitions and categories mean that a system can belong to a number of non-exclusive categories, as long as the exclusion and nesting rules are respected. For example, we could define a system as belonging to the <em>plant</em> and <em>tree</em> categories, but not to the <em>animal</em> and <em>tree</em> categories.</p>
</div>
<div class="paragraph">
<p><em>Cross-links</em> for <code>system</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>memberOf &#8594; category:&lt;<em>name</em>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells to which categories a system component type belongs. The categories must not belong to the same partition. If there are nested categories, membership is inherited (e.g. in the previous example, belonging to the <em>C3</em> category automatically implies the system component is also a <em>plant</em>).</p>
</dd>
<dt class="hdlist1"><code>initialiser &#8594; initialiser:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>Use this optional link to specify a function to initialise state variables of a <code>systemComponent</code> at the beginning of a simulation.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>system</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>lifespan</code>
</td>
<td class="hdlist2">
<p>This property specifies if this type of system component will stay forever, or may get created and deleted during a simulation</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>permanent</code>
</td>
<td class="hdlist2">
<p>(1) system component stays forever during a simulation, (2) relation stays as long as both its ends stay (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ephemeral</code>
</td>
<td class="hdlist2">
<p>system component / relations are created and deleted during a simulation by the means of the appropriate  <code>Function</code> classes (e.g. <code>DeleteDecision</code>, <code>CreateOtherDecision</code>, etc. cf. <code>TwFunctionTypes</code>)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truelife-cycle"><a class="anchor" href="#truelife-cycle"></a>Life cycle</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>lifeCycle</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>As <em>system component</em>s are designed to represent&#8201;&#8212;&#8201;among other things&#8201;&#8212;&#8201;individual organisms, they are able to create other system components ar runtime, or to transform themselves into system component of another category set. These abilities are captured in the description of a <code><strong>lifeCycle</strong></code>, which describes the possible creations and transitions of system components of a given category set into another.</p>
</div>
<div class="paragraph">
<p>Since <code>systemComponents</code> belong to <code>categories</code>, different types of system components represented by different state variables, subject to different ecological processes, can coexist in a simulation. It may occur in a particular model that one wishes to represent a transition between, e.g. development stages: think for example of a caterpillar turning into a butterfly. There are chances that you don&#8217;t want to describe the caterpillar with the same variables and behaviours as the adult butterfly. The operation of transforming a system component from a set of categories to another is called <em>recruitment</em>. Computationally, it means that the simulator must keep track of the system component&#8217;s identity and age in the first stage and carry these properties on to the new system component of the second stage, and call an appropriate method to transform state variables of the first stage into the new one.</p>
</div>
<div class="paragraph">
<p><em>Reproduction</em> is the second process by which system components of a given category set may produce other system components belonging to possibly different categories.</p>
</div>
<div class="paragraph">
<p>A specification of a life cycle is made by specifying <code>recruit</code> and <code>produce</code> nodes to match these two behaviours.</p>
</div>
</div>
<div class="sect5">
<h6 id="truerecruitment"><a class="anchor" href="#truerecruitment"></a>Recruitment</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/lifeCycle/<strong>recruit</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that two <code>systemComponent</code> types are linked by a <em>recruitment</em> process.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>recruit</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>from &#8594; system:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is getting changed by the recruitment.</p>
</dd>
<dt class="hdlist1"><code>to &#8594; system:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is the result of the recruitment.</p>
</dd>
<dt class="hdlist1"><code>process &#8594; process:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which ecological process is used to compute the recruitment.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truereproduction"><a class="anchor" href="#truereproduction"></a>Reproduction</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/lifeCycle/<strong>produce</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that two <code>systemComponent</code> types are linked by a <em>reproduction</em> process.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>produce</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>from &#8594; system:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is producing new system components.</p>
</dd>
<dt class="hdlist1"><code>to &#8594; system:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type is the result of the reproduction.</p>
</dd>
<dt class="hdlist1"><code>process &#8594; process:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which ecological process is used to compute the production of new system components.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-of-a-life-cycle-specification"><a class="anchor" href="#trueexample-of-a-life-cycle-specification"></a>Example of a life cycle specification</h6>
<div class="paragraph">
<p>This life cycle:</p>
</div>
<div id="fig-life-cycle-example" class="imageblock" style="text-align: center">
<div class="content">
<img src="example-life-cycle.svg" alt="example life cycle.svg">
</div>
<div class="title">Figure 3. Example of a life cycle</div>
</div>
<div class="paragraph">
<p>is specified with this graph:</p>
</div>
<div id="fig-life-cycle-config-example" class="imageblock" style="text-align: center">
<div class="content">
<img src="example-life-cycle.png" alt="example life cycle.png">
</div>
<div class="title">Figure 4. Example of a life cycle configuration</div>
</div>
<div class="paragraph">
<p><strong>[TODO: fix the graph with the missing 'to' node for vegetative reproduction + add processes]</strong></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-setup-of-an-initial-state-for-a-simulation"><a class="anchor" href="#truethe-setup-of-an-initial-state-for-a-simulation"></a>The setup of an initial state for a simulation</h5>
<div class="sect5">
<h6 id="trueinitial-state"><a class="anchor" href="#trueinitial-state"></a>Initial state</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>initialState</strong>:&lt;<em>name</em>&gt;</code> {0..1}</p>
</div>
<div class="paragraph">
<p>To run a simulation, an initial population of <code>systemComponents</code> must be provided. Nodes under the <code>initialState</code> node are used to input data to create such an initial state.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please note that 3Worlds allows for five different ways of initialising a simulation. These methods are explained in detail in section <a href="#truefeeding-the-model-with-data">feeding the system with data</a>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truespecies"><a class="anchor" href="#truespecies"></a>Species</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/community/<strong>species</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies an instance of a <em>species</em>, characterized by a <em>life cycle</em>. Different instances of this life cycle may be specified by means of different names.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>species</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>speciesType &#8594; lifeCycle:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells which life cycle should be used for this species. It is not required if the species only has one <em>stage</em> (see below).</p>
</dd>
<dt class="hdlist1"><code>loadFrom &#8594; dataSource:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells which data source the species data should be read from. It is required if no <code>name</code> is given to the species. If no <code>name</code> is given, the file may contain data for more than one species and a species instance will be setup for every species entry found in the data file.  cf. section <a href="#truethe-em-dataio-em-node">dataIO</a>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if no <code>name</code> is given, the data must be read from a file, i.e. there must be a <code>loadFrom</code> cross-link.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truedevelopmental-stages"><a class="anchor" href="#truedevelopmental-stages"></a>Developmental stages</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/community/species/<strong>stage</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies an instance of a <em>stage</em>, characterized by a <em>system type</em>. Different instances of this system type may be specified by means of different names.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>stage</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>systemType &#8594; system:&lt;<em>name</em>&gt;</code> {1}</dt>
<dd>
<p>This link tells which system component type should be used for system components belonging to this stage.</p>
</dd>
<dt class="hdlist1"><code>loadFrom &#8594; dataSource:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells which data source the stage data should be read from. It is required if no <code>name</code> is given to the stage. If no <code>name</code> is given, the file may contain data for more than one stage and a stage instance will be setup for every stage entry found in the data file. cf. section <a href="#truethe-em-dataio-em-node">dataIO</a>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if no <code>name</code> is given, the data must be read from a file, i.e. there must be a <code>loadFrom</code> cross-link.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trueindividuals-present-at-simulation-start"><a class="anchor" href="#trueindividuals-present-at-simulation-start"></a>Individuals present at simulation start</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/community/species/stage/<strong>individual</strong>:&lt;<em>name</em>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies an instance of a <em>system component</em> to be created at the beginning of a simulation.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>individual</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>loadFrom &#8594; dataSource:&lt;<em>name</em>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells which data source the system component data should be read from. It is required if no <code>name</code> is given to the individual. If no <code>name</code> is given, the file may contain data for more than one individual and a system component instance will be setup for every individual entry found in the data file. cf. section <a href="#truethe-em-dataio-em-node">dataIO</a>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if no <code>name</code> is given, the data must be read from a file, i.e. there must be a <code>loadFrom</code> cross-link.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Format of data files are described in section <a href="#truethe-em-dataio-em-node">dataIO</a>.</p>
</div>
<div class="paragraph">
<p>It is possible to directly input data in ModelMaker (recommended for small amounts of data only) by using a <code>load</code> node as a child node of either <code>species</code>, <code>stage</code> or <code>individual</code>:</p>
</div>
</div>
<div class="sect5">
<h6 id="trueusing-em-load-em-to-directly-input-data-from-modelmaker"><a class="anchor" href="#trueusing-em-load-em-to-directly-input-data-from-modelmaker"></a>Using <em>load</em> to directly input data from ModelMaker</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/community/&#8230;&#8203;/<strong>load</strong></code></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>load</code>:</p>
</div>
<div class="paragraph">
<p>Any field or leaf table defined in the <a href="#truethe-em-codesource-em-node">codeSource</a> section can be instantiated with a properly typed value here.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truethe-representation-of-time"><a class="anchor" href="#truethe-representation-of-time"></a>The representation of time</h5>
<div class="paragraph">
<p>Simulation is about mimicking the dynamics of a real system. Here, dynamics is specifying by attaching particular behaviours (called processes) to either categories or relations.</p>
</div>
<div class="sect5">
<h6 id="truesimulator"><a class="anchor" href="#truesimulator"></a>Simulator</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>engine</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node specifies the type of simulator to use.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Currently, there is only one type of simulator available, so it is set by default without user intervention. This may change in the future, so that user choice may be needed here.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truetime-line"><a class="anchor" href="#truetime-line"></a>Time line</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/engine/<strong>timeLine</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>Every simulation experiment has a reference <em>time line</em>. Since different ecological processes may run according to different time models, they must refer to a common time frame for interaction to be possible among them. A <code><strong>timeLine</strong></code> defines what kind of time scale and time units can be used in this experiment, and more importantly what is the time <em>grain</em>, i.e. the duration below which events are considered simultaneous. Internally, the <code>ModelRunner</code> uses integers to represent time, with 1 = one time grain.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timeLine</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>scale</code>
</td>
<td class="hdlist2">
<p>This property specifies the type of time scale to use. The usual time units pose many problems, because years, months, weeks and days are not integer multiples of each other. The option is either to use a real calendar time scale – but this is not needed in most simulation studies – or to use approximations which enable year, months, weeks and days to be integer multiples of each other (e.g. an easy approximation is to assume 30-day months, but this means years must be only 360-day long). This property proposes a set of such simplified, compatible sets of units, denoted as time scales.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>MONO_UNIT</code>
</td>
<td class="hdlist2">
<p>single time unit, calendar-compatible (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>GREGORIAN</code>
</td>
<td class="hdlist2">
<p>real calendar time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_365D</code>
</td>
<td class="hdlist2">
<p>365-days years, no weeks, no months</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_13M</code>
</td>
<td class="hdlist2">
<p>28-days months, 13-months/52-weeks years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WMY</code>
</td>
<td class="hdlist2">
<p>28-days months, 12-months/48-weeks years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_30D</code>
</td>
<td class="hdlist2">
<p>30-days months, weeks replaced by 15-days fortnights</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_366D</code>
</td>
<td class="hdlist2">
<p>366-days year, months replaced by 61-days bi-months</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LONG_TIMES</code>
</td>
<td class="hdlist2">
<p>long time units only (month or longer), calendar-compatible</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SHORT_TIMES</code>
</td>
<td class="hdlist2">
<p>short time units only (week or shorter), calendar-compatible</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ARBITRARY</code>
</td>
<td class="hdlist2">
<p>arbitrary time units with no predefined name</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>shortestTimeUnit</code>
</td>
<td class="hdlist2">
<p>The shortest time unit used in this model. Note that the time scale constraints the time units compatible with each other for this property.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>UNSPECIFIED</code>
</td>
<td class="hdlist2">
<p>an arbitrary time unit (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MICROSECOND</code>
</td>
<td class="hdlist2">
<p>microsecond</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MILLISECOND</code>
</td>
<td class="hdlist2">
<p>millisecond = 1000 microseconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SECOND</code>
</td>
<td class="hdlist2">
<p>second = 1000 milliseconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MINUTE</code>
</td>
<td class="hdlist2">
<p>minute = 60 seconds</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>HOUR</code>
</td>
<td class="hdlist2">
<p>hour = 60 minutes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DAY</code>
</td>
<td class="hdlist2">
<p>day = 24 hours</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>WEEK</code>
</td>
<td class="hdlist2">
<p>week = 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FORTNIGHT_15</code>
</td>
<td class="hdlist2">
<p>French-style fortnight = 15 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_28</code>
</td>
<td class="hdlist2">
<p>month = 4 weeks of 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH_30</code>
</td>
<td class="hdlist2">
<p>month = 30 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MONTH</code>
</td>
<td class="hdlist2">
<p>calendar month (= 1/12 of a calendar year), <em>i.e.</em> approx. 30,44 days, but with irregular durations (28,29, 30 or 31 days)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BIMONTH_61</code>
</td>
<td class="hdlist2">
<p>2 months = 61 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_336</code>
</td>
<td class="hdlist2">
<p>year = 12 months of 4 weeks of 7 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_360</code>
</td>
<td class="hdlist2">
<p>year = 12 months of 30 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_364</code>
</td>
<td class="hdlist2">
<p>year = 52 weeks of 7 days = 13 months of 28 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_365</code>
</td>
<td class="hdlist2">
<p>year = 365 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR</code>
</td>
<td class="hdlist2">
<p>calendar year, <em>i.e.</em> approx. 365.25 days, but with irregular durations (365 or 366 days)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>YEAR_366</code>
</td>
<td class="hdlist2">
<p>year = 6 bimonths of 61 days</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DECADE</code>
</td>
<td class="hdlist2">
<p>decade = 10 years</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CENTURY</code>
</td>
<td class="hdlist2">
<p>century = 10 decades</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MILLENIUM</code>
</td>
<td class="hdlist2">
<p>millenium = 10 centuries</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>longestTimeUnit</code>
</td>
<td class="hdlist2">
<p>The longest time unit used in this model. <em>cf.</em> <code>shortestTimeUnit</code> for valid values</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>grain</code>
</td>
<td class="hdlist2">
<p>The finest time interval used in this model: this value is the number of time intervals within a shortest time unit (e.g.  if <code>shortestTimeUnit</code>=<code>MINUTE</code> and <code>grain</code>=10, the shortest time interval in the model is 6 seconds. It means dates and times will be considered equal if differing by less than 6 seconds.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truetime-models"><a class="anchor" href="#truetime-models"></a>Time models</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/engine/timeLine/<strong>timeModel</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>Ecological processes may be run following different time models. A time model is a particular way of representing time in the simulator. Time models may differ in parameters, like e.g. two time models using different time steps; but they can also be radically different in their logic: e.g. clock-like ticking vs. event-driven simulation.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timeModel</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>timeUnit</code>
</td>
<td class="hdlist2">
<p>the base time unit used by this model. <em>cf.</em> <code>timeLine.shortestTimeUnit</code> for the valid values of this property</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>nTimeUnits</code>
</td>
<td class="hdlist2">
<p>the number of base time units in the time unit of this model (<em>e.g.</em>, a model may have a 2 year time unit)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>runAtTimeZero</code>
</td>
<td class="hdlist2">
<p>whether model state must be computed at time origin, <em>i.e.</em> before simulation start</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>the type of <code>timeModel</code> to use.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>ClockTimeModel</code>
</td>
<td class="hdlist2">
<p>Time is incremented by a constant amount <em>dt</em>. This is commonly used to simulate regular processes like growth.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>EventTimeModel</code>
</td>
<td class="hdlist2">
<p>Model dynamics generates <em>events</em> and computes the date in the future at which they are going to occur. This is commonly used to generate irregular processes like fire occurrence.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ScenarioTimeModel</code>
</td>
<td class="hdlist2">
<p><strong>Not yet implemented</strong>.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ClockTimeModel</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dt</code>
</td>
<td class="hdlist2">
<p>The constant time increment used in this <code>ClockTimeModel</code>, expressed as an integer number of <code>TimeModel</code> base unit (=<code>TimeModel.nTimeUnits</code> x <code>TimeModel.timeUnit</code>). For example, if the TimeModel has <code>timeUnit</code> = <code>DAY</code> and <code>nTimeUnits</code> = 3, <code>dt</code> is expressed in units of 3 days (e.g. <code>dt</code> = 2 means the time increment is 6 days).</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if calendar time is used (<code>timeLine.scale</code> = <code>GREGORIAN</code>), then <code>dt</code> will sometimes not be constant (e.g. if <code>dt</code> = 2 <code>MONTH</code>, <code>dt</code> will vary in duration between 28 and 31 days according to the exact date).
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional sub-tree when</em> <code>class = EventTimeModel</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/ecology/engine/timeLine/timeModel/<strong>eventQueue</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>An <code>EventTimeModel</code> maintains a queue of time events that gets populated by ecological processes. Time events are stored in this queue based on their date and activated by the simulator following time order.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>eventQueue</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>populatedBy &#8594; function:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</dt>
<dd>
<p>These links indicate which ecological processes will populate the event queue with time events.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truesimulation-stopping-condition"><a class="anchor" href="#truesimulation-stopping-condition"></a>Simulation stopping condition</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>stoppingCondition</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A simulation may be run indefinitely (interactively), but in big simulation experiment it is useful to automatically stop the simulations according to some criterion. Besides the simplest stopping condition, reaching a maximal time value, 3Worlds provides many other possibilities to stop a simulation (e.g. based on a population size, on a variable passing a threshold value, etc.).</p>
</div>
<div class="paragraph">
<p>Although not directly attached to the simulation engine (they are managed by the <a href="#truethe-em-experiment-em-node">simulation experiment</a> node), stopping conditions sometimes have to know about the system modelled, for example when they must read a variable value in the simulated system. This is why they are defined here.</p>
</div>
<div class="paragraph">
<p>When no stopping condition is defined, the simulation will run indefinitely.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>stoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>The type of stopping condition to use</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SimpleStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a maximal time value is reached.</p>
</dd>
<dt class="hdlist1"><code>ValueStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system component is reached.</p>
</dd>
<dt class="hdlist1"><code>InRangeStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system gets within the given range.</p>
</dd>
<dt class="hdlist1"><code>OutRangeStoppingCondition</code></dt>
<dd>
<p>Simulation stops when a variable in a reference system gets out of the given range.</p>
</dd>
<dt class="hdlist1"><code>MultipleOrStoppingCondition</code></dt>
<dd>
<p>Compound stopping condition: simulation stops when <em>any</em> of the elementary stopping conditions within this multiple condition&#8217;s list is true.</p>
</dd>
<dt class="hdlist1"><code>MultipleAndStoppingCondition</code></dt>
<dd>
<p>Compound stopping condition: simulation stops when <em>all</em> of the elementary stopping conditions within this multiple condition&#8217;s list are true.</p>
</dd>
</dl>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = SimpleStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>endTime</code>
</td>
<td class="hdlist2">
<p>The time at which the simulation will stop, in time line <code>shortestTimeUnits</code> (i.e. the simulation will stop at <code>endTime</code>*<code>timeLine.grain</code>).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional cross-links when</em> <code>class = ValueStoppingCondition</code>, <code>InRangeStoppingCondition</code>,  <code>OutRangeStoppingCondition</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stopSystem &#8594; system:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>The system component in which the criterion variable will be checked to stop the simulation.
<strong>[TODO: check this - seems flawed to me]</strong></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ValueStoppingCondition</code>, <code>InRangeStoppingCondition</code>, <code>OutRangeStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>stopVariable</code>
</td>
<td class="hdlist2">
<p>The name of the variable which value will be checked.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = ValueStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>stopValue</code>
</td>
<td class="hdlist2">
<p>The value of <code>stopVariable</code> at which to stop the simulation.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = InRangeStoppingCondition</code>, <code>OutRangeStoppingCondition</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>upper</code>
</td>
<td class="hdlist2">
<p>The upper value of the <code>stopVariable</code> range. Only <code>double</code> values are accepted.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>lower</code>
</td>
<td class="hdlist2">
<p>The lower value of the <code>stopVariable</code> range. Only <code>double</code> values are accepted.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional cross-links when</em> <code>class = MultipleOrStoppingCondition</code>, <code>MultipleAndStoppingCondition</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>condition &#8594; stoppingCondition:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>These links point to the stopping conditions that will be used as elementary stopping conditions by the multiple and/or stopping condition.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="trueecological-processes"><a class="anchor" href="#trueecological-processes"></a>Ecological processes</h5>
<div class="sect5">
<h6 id="trueprocess"><a class="anchor" href="#trueprocess"></a>Process</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>process</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p><em>Processes</em> are used in 3Worlds to compute change in <em>system components</em>. Each process acts on system components of a particular category set (cf. <a href="#truecategory">Category</a>, <a href="#truesystem-component">System Component</a>) and is scheduled by a particular time model (cf. <a href="#truetime-representation">time representation</a>). Processes contain user-defined code that represents ecological processes. This gives 3Worlds its versatility: one can mix in a single models completely different ecological entities (system components of different category sets), implement any ecological process depending on user needs, and put them to work on different time scales (time models).</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>process</code></p>
</div>
<div class="paragraph">
<p>A process can act on a single system component at a time (called the <em>focal</em> system component), or on a pair of components linked by a relation (called the <em>focal</em> and the <em>other</em> system components). This is specified using the <code>appliesTo</code> cross-link (one at least must be present):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>appliesTo &#8594; category:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>These links indicate the category set of the system components that will be acted on by the process.</p>
</dd>
<dt class="hdlist1"><code>appliesTo &#8594; relation:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link indicates to which relation between system component the process applies.</p>
</dd>
<dt class="hdlist1"><code>dependsOn &#8594; process:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>This link tells that the process must be activated <em>after</em> the processes targeted by the links. Use this link to organize computations when there are dependencies between them.</p>
</dd>
<dt class="hdlist1"><code>timeModel &#8594; timeModel:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells which <code>timeModel</code> shall be used to activate the process.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truefunction"><a class="anchor" href="#truefunction"></a>Function</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/process/<strong>function</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>User-defined code for computing ecological processes is located in <em>functions</em>, which constitute the modifiable part of <em>processes</em>. There are different types of predefined functions, which differ by the way they act on system components (cf. &lt;&lt; &gt;&gt;).</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>function</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>spec &#8594; functionSpec:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link points to a function code specification provided in <a href="#truethe-em-codesource-em-node"><code>codeSource</code></a>. Based on this specification, <code>ModelMaker</code> will generate the appropriate java source file for insertion of user-defined code.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>function</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>className</code>
</td>
<td class="hdlist2">
<p>The name of an <em>existing</em> java class containing the user-defined function code. <strong>[TODO: check validity of this]</strong></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Either the <code>spec</code> cross-link or the <code>className</code> property must be provided, but not both.</p>
</div>
</div>
<div class="sect5">
<h6 id="truefunction-consequences"><a class="anchor" href="#truefunction-consequences"></a>Function consequences</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/process/function/<strong>consequence</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>Some functions may imply consequences: for example, a decision to delete another system component may be followed by a change in state based on the deleting component&#8217;s state at the time it is deleted. Such functions that are only activated when certain events take place are called <em>consequences</em> and may be specified by a child node to a function.</p>
</div>
</div>
<div class="sect5">
<h6 id="truedata-tracking"><a class="anchor" href="#truedata-tracking"></a>Data tracking</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/process/<strong>dataTracker</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</p>
</div>
<div class="paragraph">
<p>Simulations are useless if data cannot be efficiently output. The <em>data tracker</em> is a particular function able to send data to an output (either the 3Worlds graphical user interface or some kind of database). Since it is associated to a <em>process</em>, it will follow a timeModel and apply to a particular set of system components. A data tracker may be attached to a process that already has a function defined, or not.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There is a potential runtime saving in attaching data trackers and functions together in a process, since their invocation will be performed in a single loop on system components.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The data tracker mimicks real-world data loggers: a channel links a 'sensor' (the internal 3Worlds variable) to an output (a chart on the user interface, a file or a database table). Channels can be attached to a single system component or to a set of them, using various statistical aggregation methods. Many properties are defined to enable to fine-tune the production of output.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataTracker</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>track</code>
</td>
<td class="hdlist2">
<p>This property specifies the list of variables that should be tracked by this datatracker</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>groupBy</code>
</td>
<td class="hdlist2">
<p>This property specifies how many tracking channels should be created for a tracked variable, depending on groups their containing system components belong to.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>NO_GROUPING</code>
</td>
<td class="hdlist2">
<p>a single data channel will be created for every system component (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ALL</code>
</td>
<td class="hdlist2">
<p>a single data tracking channel will be created for all system components in the simulation, i.e. at the whole system level</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SPECIES</code>
</td>
<td class="hdlist2">
<p>a data tracking channel per species will be created, across compatible stages</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>STAGE</code>
</td>
<td class="hdlist2">
<p>a data tracking channel per stage will be created, across all species</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SPECIES_STAGE</code>
</td>
<td class="hdlist2">
<p>a data tracking channel will be created per stage and species</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>select</code>
</td>
<td class="hdlist2">
<p>This property specifies how to pick system components for data tracking <em>within a group</em>. The data will be either (1) selected for one particular system component within each group, or (2) taken from that group’s own data, if any (e.g. species population size), or (3) aggregated using some statistical method. For (1), the default behaviour is that once a system component is selected, it will be tracked until its deletion by the simulator. In all cases, remember that the maximal number of data tracking channels is set by the <code>groupBy</code> property; this property only tells the software how to fit the data coming from possibly many system components into the requested number of channels.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>RANDOM</code>
</td>
<td class="hdlist2">
<p>selects a random system component in each group (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FIRST</code>
</td>
<td class="hdlist2">
<p>selects the first system component in each group as stored in the simulator’s lists (quite unpredictable unless there is only one item in the list)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LAST</code>
</td>
<td class="hdlist2">
<p>selects the last system component in each group as stored in the simulator’s lists (quite unpredictable unless there is only one item in the list)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>AGGREGATE</code>
</td>
<td class="hdlist2">
<p>computes a statistical aggregate of tracked variables for all members of each group (i.e., all system components of the group are tracked)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>GROUP</code>
</td>
<td class="hdlist2">
<p>tracks the data of that group, if available (typically, group size, number of new and deleted members)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>viewOthers</code>
</td>
<td class="hdlist2">
<p>This property specifies if an extra tracking channel must be created for system components that are not part of a selection. If set to <code>true</code>, the statistics property is required and will apply to all system components outside the selection.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>stageList</code>
</td>
<td class="hdlist2">
<p>This property contains the list of stage names to be tracked.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>speciesList</code>
</td>
<td class="hdlist2">
<p>This property contains the list of species names to be tracked.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>individualList</code>
</td>
<td class="hdlist2">
<p>This property contains the list of individual system component to be tracked</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>statistics</code>
</td>
<td class="hdlist2">
<p>This property lists transformations of the raw data to compute when a group contains more than one system component</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>MEAN</code>
</td>
<td class="hdlist2">
<p>mean (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>VAR</code>
</td>
<td class="hdlist2">
<p>variance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SE</code>
</td>
<td class="hdlist2">
<p>standard error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CV</code>
</td>
<td class="hdlist2">
<p>coefficient of variation (%)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SUM</code>
</td>
<td class="hdlist2">
<p>sum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>N</code>
</td>
<td class="hdlist2">
<p>count</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>tableStatistics</code>
</td>
<td class="hdlist2">
<p>This property lists transformations of the raw data to compute in case of a table variable. The grouping is determined by the index specification in the track variable list.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>MEAN</code>
</td>
<td class="hdlist2">
<p>mean (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>VAR</code>
</td>
<td class="hdlist2">
<p>variance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SE</code>
</td>
<td class="hdlist2">
<p>standard error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CV</code>
</td>
<td class="hdlist2">
<p>coefficient of variation (%)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SUM</code>
</td>
<td class="hdlist2">
<p>sum</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>N</code>
</td>
<td class="hdlist2">
<p>count</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trueinitial-computations"><a class="anchor" href="#trueinitial-computations"></a>Initial computations</h6>
<div class="paragraph">
<p><code>/3worlds/ecology/<strong>initialiser</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>In some models, computations on parameters are required before the model starts to run. The <code>initialiser</code> node fullfils this requirement by allowing users to write code to perform these computations.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>initialiser</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>spec &#8594; initialiserSpec:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link points to an initialiser code specification provided in <a href="#truethe-em-codesource-em-node"><code>codeSource</code></a>. Based on this specification, <code>ModelMaker</code> will generate the appropriate java source file for insertion of user-defined code.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>initialiser</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>The name of an <em>existing</em> java class containing the user-defined initialiser code. <strong>[TODO: check validity of this]</strong></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Either the <code>spec</code> cross-link or the <code>class</code> property must be provided, but not both.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-codesource-em-node"><a class="anchor" href="#truethe-em-codesource-em-node"></a>3.3.3. The <em>codeSource</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>codeSource</strong></code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains specifications for automatic code generation needed to implement a particular model. Most of its nodes have cross-references to nodes of the <code><strong>ecology</strong></code> sub-tree. The multiplicity allows users to organise their code specifications into meaningful units</p>
</div>
<div class="sect4">
<h5 id="truespecifying-data-structures"><a class="anchor" href="#truespecifying-data-structures"></a>Specifying data structures</h5>
<div class="paragraph">
<p>The versatility of 3Worlds resides in the possibility to <em>generate</em> any relevant data structure: based on simple specifications described here, <code>ModelMaker</code> will generate java classes implementing the data structures that will be interfaced with user-written code describing ecological processes.</p>
</div>
<div class="paragraph">
<p>Under the <a href="#truethe-em-ecology-em-node"><code>ecology</code></a> node, we have seen that ecological entities could be grouped into <a href="#truecategory"><code>categories</code></a> organized in <a href="#truepartition"><code>partitions</code></a> of exclusive categories, and that hierarchies of partitions within categories could be designed.</p>
</div>
<div class="paragraph">
<p>3Worlds proposes two kinds of data structures: <em>records</em> and <em>tables</em>, that can be organized hierarchically.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The top-level data structure must be a <em>record</em>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="truerecord"><a class="anchor" href="#truerecord"></a>Record</h6>
<div class="paragraph">
<p><code>/3worlds/codeSource/<strong>record</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p><code>&#8230;&#8203;/table/<strong>record</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</p>
</div>
<div class="paragraph">
<p>A <em>record</em> is a set of <code>(name,value)</code> pairs where the values are accessed by their name. Values may be of different types (e.g. numbers, character strings, tables&#8230;&#8203;).
<em>Records</em> may contain <em>fields</em> or <em>tables</em> or both (see below), but no <em>records</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="truetable"><a class="anchor" href="#truetable"></a>Table</h6>
<div class="paragraph">
<p><code>/3worlds/codeSource/record/<strong>table</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>table</em> is a set of values all of the same type, accessible by an <em>index</em>. 3Worlds tables can be multidimensional, i.e. can have many indexes. <em>Tables</em> may contain elements of the same types as <em>fields</em>, or <em>records</em> (see below), but no <em>tables</em>.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>table</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dim &#8594; dimensioner:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</dt>
<dd>
<p>This link tells how many entries a table has in this dimension. A table <em>must</em> have at least one dimensioner.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>table</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dataElementType</code>
</td>
<td class="hdlist2">
<p>The data type of the elements of the table</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>Double</code>
</td>
<td class="hdlist2">
<p>a single precision floating point number (4 10<sup>-38</sup> to 3.4 10<sup>38</sup>) with 15 significant digits (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Integer</code>
</td>
<td class="hdlist2">
<p>an integer [-2147483648; 2147483647]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Long</code>
</td>
<td class="hdlist2">
<p>a long integer [-9223372036854775808; 9223372036854775807]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Float</code>
</td>
<td class="hdlist2">
<p>a single precision floating point number (4 10<sup>-38</sup> to 3.4 10<sup>38</sup>) with 6 significant digits</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Boolean</code>
</td>
<td class="hdlist2">
<p>a logical value {true, false}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>String</code>
</td>
<td class="hdlist2">
<p>a text string</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Short</code>
</td>
<td class="hdlist2">
<p>a short integer [-32768; 32767]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Char</code>
</td>
<td class="hdlist2">
<p>a character value (16-bit Unicode = UTF16, i.e. 65535 different values)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Byte</code>
</td>
<td class="hdlist2">
<p>a very, very short integer [-128 ; 127]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Object</code>
</td>
<td class="hdlist2">
<p>anything else <strong>TODO: should we keep this? it’s probably useless</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>dataElementType</code> property can be ommited if a <code>record</code> sub-node is provided.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truefield"><a class="anchor" href="#truefield"></a>Field</h6>
<div class="paragraph">
<p><code>&#8230;&#8203;/record/<strong>field</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>field</em> specifies a single value with a name to access it.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>field</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dataElementType</code>
</td>
<td class="hdlist2">
<p>The data type of the field.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>: as in <a href="#truetable"><code>table.dataElementType</code></a></p>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="truedimensioner"><a class="anchor" href="#truedimensioner"></a>Dimensioner</h6>
<div class="paragraph">
<p><code>/3worlds/codeSource/<strong>dimensioner</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>A <em>dimensioner</em> is a constant integer number used to set the size of a <em>table</em> data structure.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dimensioner</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>dim</code>
</td>
<td class="hdlist2">
<p>The number of entries of the table in this dimension (integer in range [1;2147483647]).</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trueexample-specifying-nested-data-structures"><a class="anchor" href="#trueexample-specifying-nested-data-structures"></a>Example: specifying nested data structures</h6>
<div class="paragraph">
<p>On this diagram (generated with <code>ModelMaker</code>), hierarchical links are in green and cross-links are in black.</p>
</div>
<div id="fig-data-structure-example" class="imageblock" style="text-align: center">
<div class="content">
<img src="example-data-structures.png" alt="example data structures.png">
</div>
<div class="title">Figure 5. Example of a configuration with nested data structures</div>
</div>
<div class="paragraph">
<p>The data structure tree of this figure, once linked to a category tree and to system components, will generate the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>TODO: put generated code here</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truespecifying-user-defined-code"><a class="anchor" href="#truespecifying-user-defined-code"></a>Specifying user-defined code</h5>
<div class="paragraph">
<p>The versatility of 3Worlds resides in the possibility to implement any relevant ecological process to describe ecosystem dynamics. System components that constitute the simulated system have their state variables modified during the course of a simulation by ecological processes. These processes perform different kinds of actions on system components, but all of them can (and actually should) be customized to implement the particularities of any model.</p>
</div>
<div class="paragraph">
<p>Whereas in the <a href="#trueecology">ecology</a> node we specified the <em>conceptual</em> links between categories, system components and processes, here we can specify the <em>technical</em> part of process implementation. Based on these specifications, <code>ModelMaker</code> will generate java source files for <em>template function classes</em> into a user-specified directory (preferably a java project: cf. <a href="#truesetting-up-a-java-development-environment-for-the-user-code">java project for user code</a>). Users can then edit these files to their needs, and they will be compiled and linked to the simulator by <code>ModelMaker</code>.</p>
</div>
<div class="sect5">
<h6 id="truefunction-2"><a class="anchor" href="#truefunction-2"></a>Function</h6>
<div class="paragraph">
<p><code>/3worlds/codeSource/<strong>functionSpec</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>The <code>functionSpec</code> node is used to selecct a particular type of function to attach to a process. <em>Functions</em> differ by the way they act on system components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>some only modify the state variables of a system component</p>
</li>
<li>
<p>others make decisions on system components:</p>
<div class="ulist">
<ul>
<li>
<p>delete a system component</p>
</li>
<li>
<p>create new system components</p>
</li>
<li>
<p>transform into another system component type</p>
</li>
<li>
<p>establish or maintain a relation to another system component</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is specified by means of the <code>type</code> property.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>functionSpec</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>This property specifies which kind of biological function will be implemented within the linked <code>Process</code> obect.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>ChangeState</code>
</td>
<td class="hdlist2">
<p>change state, ie internal variables, of a system component (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeCategoryDecision</code>
</td>
<td class="hdlist2">
<p>change category of a system component according to life cycle</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>CreateOtherDecision</code>
</td>
<td class="hdlist2">
<p>create another system component according to life cycle</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DeleteDecision</code>
</td>
<td class="hdlist2">
<p>delete self</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Aggregator</code>
</td>
<td class="hdlist2">
<p>compute statistics</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeOtherState</code>
</td>
<td class="hdlist2">
<p><em>focal</em> changes state of <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeOtherCategoryDecision</code>
</td>
<td class="hdlist2">
<p><em>focal</em> changes category of <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DeleteOtherDecision</code>
</td>
<td class="hdlist2">
<p><em>focal</em> deletes <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>RelateToDecision</code>
</td>
<td class="hdlist2">
<p><em>focal</em> establishes a new relation to <em>other</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MaintainRelationDecision</code>
</td>
<td class="hdlist2">
<p>decision to maintain or remove an existing relation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ChangeRelationState</code>
</td>
<td class="hdlist2">
<p>change state of a relation</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The code template generated by <code>ModelMaker</code> will differ based on this property.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> explain in detail the difference between the code templates</p>
</div>
</div>
<div class="sect5">
<h6 id="truecode-snippet"><a class="anchor" href="#truecode-snippet"></a>Code snippet</h6>
<div class="paragraph">
<p><strong>This is deprecated and should not be used anymore (???)</strong></p>
</div>
</div>
<div class="sect5">
<h6 id="trueinitialiser"><a class="anchor" href="#trueinitialiser"></a>Initialiser</h6>
<div class="paragraph">
<p><code>/3worlds/codeSource/<strong>initialiserSpec</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies a particular type of function that is only called once, at the beginning of a simulation, to set initial values or perform initial computation on a model&#8217;s <em>parameters</em>. It is the only place where parameters can be modified programmatically.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-dataio-em-node"><a class="anchor" href="#truethe-em-dataio-em-node"></a>3.3.4. The <em>dataIO</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>dataIO</strong></code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree contains links to external data sources (usually files) required by a simulation experiment, either for data input or output. Most of its nodes have cross-references to nodes of the <code><strong>ecology</strong></code> sub-tree. The multiplicity allows users to organise their data sets into meaningful units.</p>
</div>
<div class="sect4">
<h5 id="truedata-em-sources-em"><a class="anchor" href="#truedata-em-sources-em"></a>Data <em>sources</em></h5>
<div class="paragraph">
<p>When an important amount of data must be imported at the beginning of a simulation, the direct input of data through the <a href="#trueusing-em-load-em-to-directly-input-data-from-modelmaker">load</a> node becomes impractical. The <a href="#truethe-setup-of-an-initial-state-for-a-simulation">loadFrom</a> cross-links to <code>dataSource</code> nodes enables one to import data from external files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Currently, supported file formats are plain text <code>.csv</code>, and OpenOffice spreadsheet <code>.ods</code>. However, it is possible to develop file importers for other formats. Those interested by such developments should contact the 3Worlds developers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/<strong>dataSource</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies a <em>data source</em>, i.e. a file, a set of files or a database connection.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
database connections and sets of files as data sources are not yet implemented.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataSource</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>file</code>
</td>
<td class="hdlist2">
<p>The name of the file where the data is to be read.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>The type of file loader to use to read <code>file</code>.</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>CsvFileLoader</code>
</td>
<td class="hdlist2">
<p>read a <code>.csv</code> file</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>OdfFileLoader</code>
</td>
<td class="hdlist2">
<p>read an <code>.ods</code> file (OpenOffice spreadsheet)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = CsvFileLoader</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>separator</code>
</td>
<td class="hdlist2">
<p>the field separator used for this <code>.csv</code> file (default: tabulation <code>"\t"</code>)</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = OdfFileLoader</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>sheet</code>
</td>
<td class="hdlist2">
<p>the name of the spreadsheet to load from this <code>.ods</code> file (different spreadsheets in the same <code>.ods</code> file must be specified as different <code>dataSource</code> nodes). If this property is absent or not set, the first spreadsheet will be loaded.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Additional properties when</em> <code>class = CsvFileLoader</code>, <code>OdfFileLoader</code></p>
</div>
<div class="paragraph">
<p><code>.csv</code> and <code>.ods</code> file formats both assume the data come in 2 dimensional tables with cross-references between the tables. Table columns must match parameter and driver field or table names. Table rows must match species, stage or system component instances.</p>
</div>
<div class="paragraph">
<p>The following rules must be respected when preparing the data files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The data must not contain any missing value or structural empty cells.</p>
</li>
<li>
<p>Empty lines are permitted (they are skipped).</p>
</li>
<li>
<p>Text data must not be quoted.</p>
</li>
<li>
<p>The first data line of any file or spreadsheet must contain column headers. They must match field names as defined in the 3Worlds specification file produced by <code>ModelMaker</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since we do not allow for empty cells, <a href="#truespecifying-data-structures">complex data structures</a> may have to be loaded from different files/spreasheets. In particular, a different file or spreadsheet per <a href="#truetable">set of table dimensions</a> should be used. The match between different files/spreadsheets is based on some data columns containing particular identifiers, specified in the following additional properties (all optional <strong>[NOTE: this may be wrong]</strong>).</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>idSpecies</code>
</td>
<td class="hdlist2">
<p>header of the column containing the species names. If only this property is set, each row of the file/spreadsheet will be used to generate a different <em>species</em> parameter set. Other column headers must match species parameter field names.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>idStage</code>
</td>
<td class="hdlist2">
<p>header of the column containing the stage names. If this property is set, then <code>idSpecies</code> must also be set. If only this property and <code>idSpecies</code> are set, each row of the file/spreadsheet will be used to generate a different <em>stage</em> parameter set for the matching <em>species</em> instance. Other column headers must match stage parameter field names.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>idComponent</code>
</td>
<td class="hdlist2">
<p>header of the column containing the system component ids. If this property is set, then <code>idSpecies</code> and <code>idStage</code> must also be set. Here, each row of the file/spreadsheet will be used to generate a different <em>system component</em> instance for the matching <em>stage</em> within <em>species</em>. Other column headers must match driver field names.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>idRelation</code>
</td>
<td class="hdlist2">
<p>header of the column containing the relation names <strong>[NOTE: not yet implemented]</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>idVariable</code>
</td>
<td class="hdlist2">
<p>header of the column containing the driver names <strong>[NOTE: I dont remember what I planned to use this for!]</strong></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All other columns are assumed to be read as such: they play no specific role in the file scanning process.</p>
</div>
<div class="paragraph">
<p><em>Additional sub-tree when</em> <code>class = CsvFileLoader</code>, <code>OdfFileLoader</code></p>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/dataSource/<strong>read</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node specifies that a particular parameter/driver must be read from the file/spreadsheet. The <em>name</em> property of the <code>read</code> node must match the parameter/driver name to read. By default, when no <code>read</code> node is present, <em>all</em> parameters/drivers found in the file/spreadsheet will be read. Use <code>read</code> nodes to restrict the number of columns to read in a data source.</p>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/dataSource/<strong>dim</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p>This node is used when reading data for 3Worlds <a href="#truetable">table</a> data structures. The node name must be an integer matching the dimension declared in a <a href="#truetable"><code>table</code></a> under the <code>codeSource</code> node. It must then have the following property:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>col</code>
</td>
<td class="hdlist2">
<p>header of the column containing the index values for this dimension.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When <code>dim</code> nodes are present, the index values contained in the dimension columns specified in <code>col</code> are used to fill a table within the same 3Worlds data structure.</p>
</div>
<div class="sect5">
<h6 id="trueexample-of-a-em-datasource-em-specification"><a class="anchor" href="#trueexample-of-a-em-datasource-em-specification"></a>Example of a <em>dataSource</em> specification</h6>
<div class="paragraph">
<p>This <code>.csv</code> file:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dim_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fecundity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mortality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dispersal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">population</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">site</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>with the following specifications:</p>
</div>
<div id="fig-data-source-example" class="imageblock" style="text-align: center">
<div class="content">
<img src="example-data-source.png" alt="example data source.png">
</div>
<div class="title">Figure 6. Example of a data source configuration.</div>
</div>
<div class="paragraph">
<p>will result in the instantiation of a single parameter set with species='site', stage='population', and data contained in an 10-cell array of records with 3 fields, fecundity, mortality and dispersal.</p>
</div>
<div class="paragraph">
<p>How?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>property <code>idSpecies</code> states that the column labelled 'site' is the species identifier (last column of the csv file).</p>
</li>
<li>
<p>property <code>idStage</code> states that the column labelled 'stage' is the stage identifier (first column of the csv file).</p>
</li>
<li>
<p>since there is no <code>idComponent</code> property, it means this file contains stage parameter data.</p>
</li>
<li>
<p>node <code>dim</code> with <code>name</code>=1 specifies that the data to be read go into a table</p>
</li>
<li>
<p>property <code>col</code> states that the column labelled <code>dim_1</code> contains the indices for dimension 1 of the table.</p>
</li>
<li>
<p>the <code>read</code> nodes specify that the columns labelled 'fecundity', 'dispersal' and 'mortality' are to be read. Notice that these nodes were not required, since the default behaviour would have caused all these columns to be read anyway.</p>
</li>
<li>
<p>finally, the 10 different lines with different table indices (CAUTION: the indices start at 0 for 3Worlds table data structures) will all go into the same parameter set since only one (species name, stage name) pair is given here. Hence only one stage parameter set is instantiated.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="truedata-em-sinks-em"><a class="anchor" href="#truedata-em-sinks-em"></a>Data <em>sinks</em></h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
this part of the code is under refactoring.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>/3worlds/dataIO/<strong>dataSink</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>dataSink</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>A data exporter class.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>dataSink</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dataListener &#8594; dataTracker:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells which <a href="#truedata-tracking"><code>dataTracker</code></a> is used to aggregate the data for output.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-experiment-em-node"><a class="anchor" href="#truethe-em-experiment-em-node"></a>3.3.5. The <em>experiment</em> node</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This part is still under construction
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>/3worlds/<strong>experiment</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree describe the experimental design to run using a given <em>model</em> and external data sets. Typically, il will tell <code>ModelRunner</code> how many simulations should be run, possibly varying some parameters of the model according to some plan. The name is used to differentiate simulation experiments in a meaningful way. <strong>TODO[It will appear in output directory names ?]</strong>.</p>
</div>
<div class="paragraph">
<p>The <code><strong>experiment</strong></code> node must have a cross-reference edge labelled <code><strong>baseLine</strong></code> {1}  to an <code><strong>ecology</strong></code> node. The model configuration contained in this <code><strong>ecology</strong></code> sub-tree will be used as the reference, "base line" simulation in the experiment - similar to a control treatment in a real-world experiment.</p>
</div>
<div class="paragraph">
<p>The default, simplest, simulation experiment is just to run a single simulation of the baseLine model.</p>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>experiment</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>baseLine &#8594; ecology:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link points to a model setup that will be used as a <em>base line</em> simulation. A base line simulation is the equivalent of a control in a real experiment, i.e. a reference case that serves as a basis to which other treatments are compared.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="truesimulation-duration"><a class="anchor" href="#truesimulation-duration"></a>Simulation duration</h5>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>timePeriod</strong></code> {1..*}</p>
</div>
<div class="paragraph">
<p>The duration of a particular simulation is specified using a <code>timePeriod</code> node.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>timePeriod</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>start</code>
</td>
<td class="hdlist2">
<p>The starting time of a simulation in <code>timeLine</code> shortest time unit grains.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>end</code>
</td>
<td class="hdlist2">
<p>The ending time of a simulation in <code>timeLine</code> shortest time unit grains.</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Both properties are optional. If none is set, the simulation will start at time 0 and run indefinitely.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>timePeriod</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>timeRunner &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells which <a href="#truesimulator">simulator engine</a> is running the time and is going to need the start and end time information.</p>
</dd>
<dt class="hdlist1"><code>stopOn &#8594; stoppingCondition:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link tells how to stop the simulation in case no <code>end</code> property is given.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The stopping condition has the priority over the <code>end</code> property. <strong> TODO: check this</strong>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueexperimental-design"><a class="anchor" href="#trueexperimental-design"></a>Experimental design</h5>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>design</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>An experimental design specifies the method used to perform the simulations, e.g. number of replicate simulations, treatments as changes in parameter values or initial states, etc. An experimental design can be specified by using standard designs, or by passing a design description file.</p>
</div>
<div class="paragraph">
<p>For more information on experimental designs for simulation experiments, we recommend reading the documentation of the R software <em>planor</em> and <em>mtk</em> packages (e.g. these packages could be used to generate design files for use in 3Worlds).</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>design</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>type</code>
</td>
<td class="hdlist2">
<p>This property specifies an experimental design for the simulation experiment. It only provides basic, standard experimental designs. For more elaborate or specialized designs, use an ad-hoc file description of the design (<code>file</code> property, <em>cf.</em> below)</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>singleRun</code>
</td>
<td class="hdlist2">
<p>an experiment consisting of a single simulation run (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>crossFactorial</code>
</td>
<td class="hdlist2">
<p>a cross-factorial experiment based on a limited set of parameter values (factors)</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>file</code>
</td>
<td class="hdlist2">
<p>This property gives the name of an experimental design file <strong>TODO : expand on this description</strong></p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueexperimental-treatments"><a class="anchor" href="#trueexperimental-treatments"></a>Experimental treatments</h5>
<div class="sect5">
<h6 id="truetreatments"><a class="anchor" href="#truetreatments"></a>Treatments</h6>
<div class="paragraph">
<p><code>/3worlds/experiment/<strong>treatment</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>An experimental treatment records a particular set of parameter values and initial state to run a simulation or a series of replicated simulations. It is the basic block of the experiment, just as in real-world experimentation.</p>
</div>
<div class="paragraph">
<p>Treatements may be specified</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in full detail: this is done by specifying more than one <code>ecology</code> nodes, each <code>ecology</code> being used for a different treatment;</p>
</li>
<li>
<p>as (minor) changes relative to the experiment <code>baseLine</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>treatment</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>replicates</code>
</td>
<td class="hdlist2">
<p>The number of simulations to run with this treatment setup.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>treatment</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>modelSetup &#8594; ecology:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..1}</dt>
<dd>
<p>This link points to the <code>ecology</code> node used to initialise simulations for this treatment.</p>
</dd>
<dt class="hdlist1"><code>deployOn &#8594; computeThread:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</dt>
<dd>
<p>This link specifies on which hardware thread to deploy this treatment. <strong>NB: not implemented so far</strong></p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truetreatments-as-changes-relative-to-em-baseline-em"><a class="anchor" href="#truetreatments-as-changes-relative-to-em-baseline-em"></a>Treatments as changes relative to <em>baseLine</em></h6>
<div class="paragraph">
<p><code>/3worlds/experiment/treatment/<strong>modelChange</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>Use this node to specify a treatment as a change relative to <code>baseLine</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
this is unimplemented. <strong> TODO: implement it !</strong>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
currently there is no link between treatments and design&#8230;&#8203; <strong> TODO: implement it !</strong>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-userinterface-em-node"><a class="anchor" href="#truethe-em-userinterface-em-node"></a>3.3.6. The <em>userInterface</em> node</h4>
<div class="paragraph">
<p><code>/3worlds/<strong>userInterface</strong>:&lt;<em>name</em>&gt;</code> {1}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree specifies the look of the <code>ModelRunner</code> user interface. <code>ModelRunner</code> is highly configurable and can show many graphs during a simulation run, for example as help when debugging a new model; or only show a progress bar to improve computing performance when running a big simulation experiment.</p>
</div>
<div class="paragraph">
<p>3Worlds provides a series of interface <em>widgets</em>, i.e. graphical ojects that can be assembled to yield a usable <strong>g</strong>raphical <strong>u</strong>ser <strong>i</strong>nterface (GUI). Examples of widgets are: a window to display time series graphs, or XY maps, or simulation control buttons, or progress bars, etc&#8230;&#8203; The basic <code>ModelRunner</code> GUI just provides places where to put widgets: a <em>tool bar</em>, a <em>status bar</em>, four <em>quadrants</em>, and <em>tabs</em> within quadrants. <em>Widgets</em> can be placed inside the <em>tool bar</em>, the <em>status bar</em>, or <em>tabs</em>.</p>
</div>
<div id="fig-GUI-ModelRunner" class="imageblock" style="text-align: center">
<div class="content">
<img src="GUI-ModelRunner.png" alt="GUI ModelRunner.png">
</div>
<div class="title">Figure 7. The ModelRunner graphical user interface.</div>
</div>
<div class="paragraph">
<p><strong>TODO: improve this figure</strong></p>
</div>
<div class="sect4">
<h5 id="truetool-bar"><a class="anchor" href="#truetool-bar"></a>Tool bar</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>toolBar</strong></code> {1}</p>
</div>
<div class="paragraph">
<p>The tool bar (always present) appears at the top of the GUI. Widgets placed there will appear beside each other <strong>[in random order ?]</strong>. The tool bar is typically the place where to put (small) widgets that must always remain visible at all time (as e.g., the widget containing the simulation controller buttons).</p>
</div>
</div>
<div class="sect4">
<h5 id="truestatus-bar"><a class="anchor" href="#truestatus-bar"></a>Status bar</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>statusBar</strong></code> {0..1}</p>
</div>
<div class="paragraph">
<p>The status bar, appearing at the bottom of the GUI <strong>[TODO: check this!]</strong>, is optional. It is meant to show quick information about the simulation run (like the current time step or the overall completion).</p>
</div>
</div>
<div class="sect4">
<h5 id="truetabs"><a class="anchor" href="#truetabs"></a>Tabs</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/<strong>tab</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>Tabs are placed within four quadrants. They are meant to host large widgets, typically output graphs and maps. Within a quadrant, tabs appear on top of each other, i.e. only the content of the top tab is visible. <strong>[NOTE: in the archetype there is no requirement for a name for tabs -  I suggest it should be a requirement that a tab has a name]</strong></p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>tab</code>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>quadrant</code>
</td>
<td class="hdlist2">
<p>The ThreeWorlds user interface now has four areas where tabs can be placed. Each user <code>Tab</code> must have a property to specify in which quadrant it is to be added. <strong>TODO : fix this description</strong></p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>TopLeft</code>
</td>
<td class="hdlist2">
<p>top left quadrant of the 3Worlds UI (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TopRight</code>
</td>
<td class="hdlist2">
<p>top right quadrant of the 3Worlds UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BottomLeft</code>
</td>
<td class="hdlist2">
<p>bottom left quadrant of the 3Worlds UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BottomRight</code>
</td>
<td class="hdlist2">
<p>bottom right quadrant of the 3Worlds UI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ToolTop</code>
</td>
<td class="hdlist2">
<p>top ? <strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ToolBottom</code>
</td>
<td class="hdlist2">
<p>bottom ? <strong>TODO : fix this description</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>layout</code>
</td>
<td class="hdlist2">
<p>Javafx layouts. Remove Swing constants when we are finished with Swing. There is no equivalent of Desktop in Swing - MDI is considered obsolete. It may turn out that we have to provide much more sophisticated options than this -  <strong>TODO : fix this description</strong></p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>GridPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong> (default value)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>AnchorPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>FlowPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BorderPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>HBox</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>VBox</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>StackPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TabPane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TilePane</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Accordion</code>
</td>
<td class="hdlist2">
<p><strong>TODO : fix this description</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truewidgets"><a class="anchor" href="#truewidgets"></a>Widgets</h5>
<div class="paragraph">
<p><code>/3worlds/userInterface/&#8230;&#8203;/<strong>widget</strong></code> {0..*}</p>
</div>
<div class="paragraph">
<p>Widgets are the interesting part of the GUI configuration since they do the real work. A widget may be placed inside the <code>toolBar</code>, <code>statusBar</code>, or any <code>tab</code>.</p>
</div>
<div class="paragraph">
<p><em>Properties for</em> <code>widget</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>order</code>
</td>
<td class="hdlist2">
<p>An integer <strong>[what&#8217;s it used for?]</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>class</code>
</td>
<td class="hdlist2">
<p>A widget class</p>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><em>possible values</em>:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>TimeDisplayWidgetfx</code>
</td>
<td class="hdlist2">
<p>display simulation time</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SimpleSimulationControlWidgetfx</code>
</td>
<td class="hdlist2">
<p>control a single simulation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TimeSeriesPlotWidgetfx</code>
</td>
<td class="hdlist2">
<p>plot time series output</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>LabelValuePair</code>
</td>
<td class="hdlist2">
<p><strong>???</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SingleGridWidget</code>
</td>
<td class="hdlist2">
<p><strong>???</strong></p>
</td>
</tr>
</table>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Cross-links for</em> <code>widget</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dataListener &#8594; dataTracker:&lt;<span class="underline"><em>name</em></span>&gt;</code> {0..*}</dt>
<dd>
<p>This link tells the widget where to get the data from.</p>
</dd>
</dl>
</div>
<div class="sect5">
<h6 id="truetime-display"><a class="anchor" href="#truetime-display"></a>Time display</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>TimeDisplayWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>timeListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get the time values from.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="truesimulation-control"><a class="anchor" href="#truesimulation-control"></a>Simulation control</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>SimpleSimulationControlWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget which engine it is going to control.</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="trueplotting-time-series-data"><a class="anchor" href="#trueplotting-time-series-data"></a>Plotting time series data</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>TimeSeriesPlotWidgetfx</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get simulation status information (e.g. when the simulation is over, reset, paused, etc.)</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="true-value-pair-widget"><a class="anchor" href="#true-value-pair-widget"></a>[Value pair widget]</h6>
<div class="paragraph">
<p><em>Cross-links for</em> <code>LabelValuePair</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>stateMachineListener &#8594; engine:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1}</dt>
<dd>
<p>This link tells the widget where to get simulation status information (e.g. when the simulation is over, reset, paused, etc.)</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truethe-em-hardware-em-node"><a class="anchor" href="#truethe-em-hardware-em-node"></a>3.3.7. The <em>hardware</em> node</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This part is still under construction. The default settings should be used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>/3worlds/<strong>hardware</strong>:&lt;<span class="underline"><em>name</em></span>&gt;</code> {1..*}</p>
</div>
<div class="paragraph">
<p>This node and its sub-tree specifies how the experiment should be distributed on available harware. <strong>At the time of writing, only deployment to a single computer can be done</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truedeveloping-and-testing-model-code"><a class="anchor" href="#truedeveloping-and-testing-model-code"></a>3.4. Developing and testing model code</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="truefeeding-the-model-with-data"><a class="anchor" href="#truefeeding-the-model-with-data"></a>3.5. Feeding the model with data</h3>
<div class="paragraph">
<p>There are five different ways of feeding <code>ModelRunner</code> with data to start a simulation experiment.</p>
</div>
<div class="sect3">
<h4 id="truelet-the-model-decide"><a class="anchor" href="#truelet-the-model-decide"></a>3.5.1. Let the model decide</h4>

</div>
<div class="sect3">
<h4 id="trueprovide-parameters-and-initial-state-through-modelmaker"><a class="anchor" href="#trueprovide-parameters-and-initial-state-through-modelmaker"></a>3.5.2. Provide parameters and initial state through ModelMaker</h4>

</div>
<div class="sect3">
<h4 id="trueimport-data-from-external-sources"><a class="anchor" href="#trueimport-data-from-external-sources"></a>3.5.3. Import data from external sources</h4>

</div>
<div class="sect3">
<h4 id="trueuse-previously-saved-initial-states"><a class="anchor" href="#trueuse-previously-saved-initial-states"></a>3.5.4. Use previously saved initial states</h4>

</div>
<div class="sect3">
<h4 id="truegenerate-an-initialstate-using-the-initwizard"><a class="anchor" href="#truegenerate-an-initialstate-using-the-initwizard"></a>3.5.5. Generate an initialState using the InitWizard</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truemodelrunner-reference-running-a-simulation-experiment"><a class="anchor" href="#truemodelrunner-reference-running-a-simulation-experiment"></a>4. ModelRunner reference: running a simulation experiment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truegeneral-concepts"><a class="anchor" href="#truegeneral-concepts"></a>4.1. General concepts</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="trueusing-modelrunner-software-interface-and-functioning"><a class="anchor" href="#trueusing-modelrunner-software-interface-and-functioning"></a>4.2. Using ModelRunner: software interface and functioning</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="truegetting-output-from-a-simulation-experiment"><a class="anchor" href="#truegetting-output-from-a-simulation-experiment"></a>4.3. Getting output from a simulation experiment</h3>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truesample-models-and-tutorials"><a class="anchor" href="#truesample-models-and-tutorials"></a>5. Sample models and tutorials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truetutorial-1-construct-and-run-a-model-for-the-first-time"><a class="anchor" href="#truetutorial-1-construct-and-run-a-model-for-the-first-time"></a>5.1. Tutorial 1: Construct and run a model for the first time</h3>
<div class="paragraph">
<p>In this tutorial we focus on the basic housework required to build and run a model using <code>ModelMaker</code> and <a href="https://www.eclipse.org/downloads/">eclipse</a>. We will use <code>ModelMaker</code> to create a 3Worlds project and construct a configuration file. We will then use <a href="https://www.eclipse.org/downloads/">eclipse</a> to create a Java project and then link <code>ModelMaker</code> to this project. We then finish by writing a few lines of java code with <a href="https://www.eclipse.org/downloads/">eclipse</a>, running the model and checking the results.</p>
</div>
<div class="sect3">
<h4 id="truecreating-a-model-configuration"><a class="anchor" href="#truecreating-a-model-configuration"></a>5.1.1. Creating a model configuration</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start <code>ModelMaker</code>.</p>
</li>
<li>
<p>Create a new project (<code>Main menu: Projects &#8594; new</code>)</p>
</li>
<li>
<p>When prompted enter <code>tut1</code>. A single black node called  <code>3Worlds:tut1</code> now appears in the <em>graph</em> window.</p>
<div id="fig-screenshot-1" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot1.png" alt="tutorial1 shot1.png">
</div>
</div>
<div class="paragraph">
<p>This node will be the root of a graph that represents the configuration. All nodes are identified in the graph display using a <em>label:name</em> pair. The <em>label</em> is the type of node, representing its role in the configuration, while the <em>name</em> is the unique identifier for a node of the given type (for example <code>person:claudine</code> or <code>kangaroo:skippy</code>). In addition, a list of tasks remaining to be completed appears at the bottom of the main <code>ModelMaker</code> window (<em>Compliance tasks</em>). This list grows and shrinks as the as the developing configuration is checked against the 3Worlds specifications.  A check takes place every time the graph or its properties change. On the left-hand side of the main window are two <em>Property editors</em>.  It is here that values are entered for the properties of the graph nodes created in the following steps. Only some nodes have properties and at this stage there are none to edit.</p>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>It is worth pausing here to see the directories and files that appear when a project is created.</p>
</div>
<div id="fig-screenshot-2" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot2.png" alt="tutorial1 shot2.png">
</div>
</div>
<div class="paragraph">
<p>The project root directory is called <code>.3w</code> and was created when <code>3w.zip</code> was unzipped. The dot indicates it’s a hidden directory so you will need to do what ever is required by your operating system to show hidden files. Within <code>.3w</code> there is now a directory called something like <code>project_tut1_18D6C7B0A519-000001650DB5CA2F-0000</code>. Every project directory begins with the key word <code>project</code> and then the name of the project you entered (<code>tut1</code> in this case). The series of hexadecimal numbers are an encoded creation date and instance number. At the moment all that you need to know is that <em>this system makes it impossible to overwrite a project because the project directory name will always be <strong>unique</strong></em>. Inside this directory are 3 files: <code>tut1.dsl</code> (the configuration file we are constructing), <code>layout.dsl</code> (contains visualisation data for <code>ModelMaker</code> to display the configuration). When you close a project (quit <code>ModelMaker</code> or change to a different project), a preferences file is created (<code>MM.dsl</code>) containing project settings such as the size of windows and the position of controls. There are two other directories which will be discussed later. These three files are text files and you can open them with a simple text editor. However, <em>you should never need to edit them and it is likely to lead to <strong>problems</strong> for your project if you do</em>. You can safely delete project directories unless the project is currently open in <code>ModelMaker</code> or the project simulator has been launched.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Returning to <code>ModelMaker</code>, you will see the project name is displayed in the window title along with the creation date (decoded as a readable time stamp from the project directory discussed in above). The compliance task list currently shows four nodes are required. This list can be dealt with in any order you chose but for now, we will first add an <code>ecology</code> node.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><strong>Ecology</strong>: Right-click on the <code>3worlds:tut1</code> node and select <code>new &#8594; ecology</code> from the popup menu. You are then prompted for a name for this node. The default name is the label name. Accept this and click <code>ok</code>. The mouse pointer immediately becomes a cross-hair. <code>ModelMaker</code> is asking where you want to place this node. Move to some place within the graph display and left-click the mouse. The <code>ecology:ecology</code> node appears (lime green) connected by a dark green line to the root node (black).</p>
<div id="fig-screenshot-3" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot3.png" alt="tutorial1 shot3.png">
</div>
</div>
<div class="paragraph">
<p>Green lines indicate a <em>parent/child</em> (hierarchical) relationship throughout the graph. All nodes are colour coded by category. Nodes that are children of <code>ecology</code> for example, are in the ecology category and will be the same lime green. All nodes, except the root node, are children of some parent. You can only create nodes by right-clicking on a parent and choosing a new node from the available options. The local menu varies according to the possibilities allowed by the 3Worlds specifications. This is one of the ways <code>ModelMaker</code> ensures that the developing configuration file is valid and greatly simplifies an otherwise very complex situation.</p>
</div>
<div class="paragraph">
<p>The specifications actually allow more than one <code>ecology</code> node. You can go mad if you like, and create and delete nodes to your hearts content using the popup menus. To clean up and return to this place in the tutorial, you can not only delete single nodes but also entire trees below a parent node. You can also collapse/expand all nodes in a tree and export or import them to and from disk. This can be useful for assembling models from saved sub-trees.</p>
</div>
</li>
<li>
<p>Right click the root name and create another <code>ecology</code> as in 4). The prompt will add an incremented number to the name to make sure the <em>label:name</em> pair remains unique with in the configuration file.</p>
</li>
<li>
<p>We won’t use this second <code>ecology</code> node so right click on it and select <code>delete</code>. You can’t edit the name of a node but if you want to change it, simply delete and recreate the node.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The addition of the <code>ecology</code> node has added more items to the compliance task list. However, we will ignore this for now and focus on creating the required nodes from the root. The <code>ecology</code> node and its sub-trees contain all ecological concepts defined in your model. For more information on this and other node types, see the <a href="#truereference-of-3worlds-configuration">reference</a> section.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p><strong>Code source</strong>: Right click on the root node and select <code>new &#8594; codeSource</code>, accept the default name and place it somewhere in the graph window. All nodes in the <code>codeSource</code> category are light gray.</p>
<div id="fig-screenshot-4" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot4.png" alt="tutorial1 shot4.png">
</div>
</div>
<div class="paragraph">
<p>Note the change in the task list. Adding <code>codeSource</code> did not add any more tasks to the list (but removed one – this task). The <code>codeSource</code> node will become the parent of all data and process types that will supply the necessary information for <code>ModelMaker</code> to make the required Java files.</p>
</div>
</li>
<li>
<p><strong>Experiment</strong>: Right click again on the graph root and select <code>new &#8594; experiment</code> and proceed as before. All nodes in the <code>experiment</code> category (children of <code>experiment</code>) will be the same (gold) colour. This section of the configuration will determine how the model is run. This could be anything from a simple single run to a factorial experiment or may reference a file that contains other information.</p>
</li>
<li>
<p><strong>User interface</strong>: Again, right-click on the root node and create a new <code>userInterface</code> node. In this category we can design the user interface and choose the <em>widgets</em> necessary to control the model and display results. <em>Widgets</em> are autonomous components of a user interface that can be freely assembled to customize the user interface to your needs.</p>
</li>
</ol>
</div>
<div id="fig-screenshot-5" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot5.png" alt="tutorial1 shot5.png">
</div>
</div>
<div class="paragraph">
<p>We now have a minimum set of children of the configuration root. You can delete and recreate any of these nodes at any time, with the exception of the root node. If you select the tab <code>All editable properties</code> (AEP), you will see there is only one property displayed (memory).  This is a property of the <code>ecology:ecology_1</code> node with a default value of 0. More on this later but for now leave the value at 0. Notice that, after these edits, the main window title has a star added (unsaved). Press <code>ctrl-S</code> to save (or select <code>Projects &#8594; Save</code>). Use <code>Save as&#8230;&#8203;</code> if you want to save the project under a new name. You can save it under the same name if you like. Because the new project will have a different time stamp, it won’t overwrite the previous project.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p><strong>Cross-links</strong>: Many nodes require information from nodes other than their children or parents. In the task list is currently a requirement to add an edge from experiment to ecology. To create this, right click on experiment:experiment and select <code>connect to &#8594; baseline - &gt; ecology:ecology</code>.  A gray line will appear with the name ‘baseline’ between these two nodes. All cross-linked lines are gray.</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>At the bottom of the graph display is a set of controls:</p>
</div>
<div id="fig-screenshot-6" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot6.png" alt="tutorial1 shot6.png">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>X</code> shows/hides the cross-link lines. As the graph becomes more crowded, you may want to hide these for clarity.</p>
</li>
<li>
<p>The <code>&lt;</code> shows/hides the parent/child lines. Usually you want these displayed.</p>
</li>
<li>
<p>The <code>L</code> button applies a layout method for displaying hierarchical graphs. The layout function displays children from top to bottom in alphabetical order. The layout will not be applied to any nodes not connected to the graph root.</p>
</li>
<li>
<p>Reapplying the layout (<code>L)</code> may cause the graph to be bigger than the display. You can zoom the graph display in and out by holding down the <code>ctrl</code> key while turning the mouse wheel. If the graph is larger than the display, you can drag it around using the mouse (left button down). Having readjusted the graph position or magnification, you can change the font or node size to suit. Whenever the layout is reapplied, there will be a small change in the horizontal position of nodes. This is just a random jiggle added to prevent vertical lines from being one on top of the other.</p>
</li>
<li>
<p>When the mouse floats over a node, the node becomes highlighted (red). When highlighted, you can drag the node anywhere with in the display.</p>
</li>
<li>
<p>If you left-click on a highlighted node, its properties will be displayed in the <em>Selected Properties editor</em> (SPE) display on the right-hand side of the <em>Property editor</em> window. This display will show not only editable properties (if there are any) but any other non-editable properties including the node’s label, name and sometimes other properties.
All these control settings are automatically recorded in the project preferences file (<code>MM.dsl</code>) so when you reopen this project, its appearance will be as you left it.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>We will now proceed to develop the configuration by addressing all the tasks in the task list, until we have a minimal valid graph.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p><strong>Experiment design</strong>:  Right-click on <code>experiment:experiment_1</code> and add a new design node. In addition to the name, you will be prompted for a choice between a predefined experiment type and a file name. Choose <code>type</code>. Left-click on the new design node and look at its properties with the SPE.</p>
<div id="fig-screenshot-7" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot7.png" alt="tutorial1 shot7.png">
</div>
</div>
<div class="paragraph">
<p>The <code>type</code> property is shown there and the default value is  <code>singleRun</code>. The drop down list for this property shows that <code>crossFactorial</code> is also an option.</p>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Sometimes, more convenient way to examine properties is with the other property editor <code>All editable properties</code> (AEP). Click on this tab and you will see the <code>design:design#type</code> property (<code>singleRun</code>) and the <code>ecology:ecology_1#memory</code> property (<code>0</code>). As more nodes are added to the graph, the list of properties can become overwhelming. In this case you can display properties by category (click the icon next to the search box in the AEP). There are only two categories containing properties that can be edited at this time: <code>ecology:ecology_1</code> and <code>experiment:experiment_1</code>.</p>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p><strong>Experiment time period</strong>: Use the experiment node to add a <code>timePeriod</code> node to the graph. Once done there will appear a request to add an edge from this node to <code>ecology:engine</code> in the task list. However, we don’t have such a node at this time so we should move over to the <code>ecology</code> node.</p>
</li>
<li>
<p><strong>Ecology engine</strong>: Create an <code>engine</code> from the <code>ecology</code> node. This is the simulator that will manage executing processes at the appropriate time.</p>
</li>
<li>
<p><strong>Engine time line</strong>: Select <code>engine</code> and create a new <code>timeLine</code>. The only requirement of an engine is that is has a <em>time line</em> to define the type of <em>time scale</em> within which the processes can be coordinated by various <em>time models</em>. Once this has been done, a bunch of new tasks appear. The default time scale type is <code>MONO_UNIT</code> and we need to select a particular unit. The task list indicates it can be anything from Microsecond to Millennium. For now, we will just choose <code>YEAR</code> for both the shortest and longest time unit.</p>
<div id="fig-screenshot-8" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot8.png" alt="tutorial1 shot8.png">
</div>
</div>
</li>
<li>
<p>In the AEP, select <code>ecology:ecology_1</code> category. Set the properties for longest and shortest time unit to <code>YEAR</code>. In fact, for the <code>MONO_UNIT</code> time scale, the longest and shortest units must be the same. There are many choices of time scale but they basically fall into two classes: those containing <em>regular</em> subdivisions of time or a <em>Gregorian</em> time scale (the usual occidental calendar), where months and years can vary in their number of days.</p>
</li>
<li>
<p><strong>Cross-link from timePeriod to engine</strong>: We can now create the link between these to nodes. You can only create a cross-link in <code>ModelMaker</code> starting with the <code>From</code> node. Right-click on <code>timePeriod:timePeriod_1</code> and select <code>connect to - &gt; timeRunner - &gt; engine:engine_1</code>. This allows the engine to know the start and end times of the experiment. There are many other ways that an experiment can end and we will discuss this later. Next we need a process that will be executed when the model runs.</p>
</li>
<li>
<p><strong>Ecological process</strong>: Select the <code>ecology</code> node and create a new <code>process</code>. On this occasion we will give it the name <code>step</code>. Next we need a <em>time model</em> to manage the <code>step</code> process.</p>
</li>
<li>
<p><strong>Time model</strong>: Select the <code>timeLine</code> node and create a new <code>timeModel</code>. Name it <code>step</code> as well and select <code>ClockTimeModel</code> as the model type. Save your work.</p>
</li>
<li>
<p><strong>Property errors and other tasks</strong>: the Task list has grown somewhat so now we will attend to a few simple things. The new time model has some invalid values. Set <code>dt</code> (the time step) to 1 (year), <code>nTimeUnits</code> to 1 (year – there can be any number of years in a step) and the <code>timeUnit</code> to  <code>YEAR</code> so it accords with the <code>timeLine</code>. The <code>timeLine</code> has a <em>grain</em> size (could be any factor number of years); set it to 1. You can also add an edge from <code>process:step</code> to <code>timeModel:step</code> (<code>Connect to &#8594; drivenBy &#8594; timeModel:step</code>)</p>
</li>
<li>
<p>In the AEP click on the category button next to the Search field. You’ll now see two categories of properties: <code>ecology:ecology_1</code> and <code>experiment:experiment_1</code>. Click the arrow on the <code>experiment</code> category and it will expand to show all properties of nodes in this category. Click on the edit button next to the <code>timePeriod:timePeriod_1#end</code> property. A small dialog opens to set the end time for the experiment. Set a value of 100. The <code>y</code> is an abbreviation for <code>YEARS</code> which is what we have chosen in the <code>timeLine</code>.</p>
</li>
<li>
<p>The <code>ecology</code> and <code>codeSource</code> trees are usually the most complicated to build. So before working on them, we will finish with the user interface.</p>
</li>
<li>
<p>To hide parts of the graph that we’re not working on (sub-trees) you can select a node and collapse all children of that node. Select <code>experiment:experiment_1</code>, right-click and select <code>collapse</code>. You will notice that the properties of experiment and its children have been removed from the AEP. Do the same with the <code>ecology:ecology_1</code> node.</p>
</li>
<li>
<p><strong>Tool bar</strong>: right-click on <code>userInterface:userInterface_1</code> and create a <code>toolBar</code>.</p>
</li>
<li>
<p><strong>Control widget</strong>: right-click on <code>toolBar:toolBar_1</code> and create a new widget call <code>controller</code>. Select <code>SimpleSimulationControlWidgetfx</code> from the drop down list when prompted.</p>
</li>
<li>
<p>Select the <code>toolBar:toolBar_1</code> node again and make a widget called <code>Timer</code>. Select <code>timeDisplayWidgetfx</code> this time.</p>
</li>
<li>
<p>When you run this model, widgets can appear in any arbitrary order in their containers (in this case the <code>toolbar</code>). To prevent this and ensure the UI will have a consistent appearance, edit the <code>order</code> properties in the <code>userInterface</code> category for these two widgets. Make the controller 0 (the default) and the timer 1.</p>
</li>
<li>
<p>Both these widgets require a cross-link to the ecology engine. Select each widget in turn and connect them to the <code>ecology:engine</code>.</p>
<div id="fig-screenshot-9" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot9.png" alt="tutorial1 shot9.png">
</div>
</div>
</li>
<li>
<p>Collapse the <code>userInterface</code> and <code>experiment</code> nodes, expand the <code>ecology</code> node and hide the <code>X</code> links. Tidy up the graph by reapplying the layout (L). Save your work.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will create a minimal model in this first tutorial: a model with one process, one time model, one parameter and one state variable. The specifications provide for considerable complexity in defining multiple ecosystems, species and the various life stages they may move through. We will leave all that for another tutorial so we can focus in the procedures of model construction and deployment. However, in codeSource, we can’t avoid defining some data structures and therefore we now need some initial idea of a model. We will implement the simplest of chaos equations, the <a href="http://www.bendov.info/cours/chaos/logistic.htm">discrete-time logistic growth model</a>:</p>
</div>
<div class="paragraph">
<p><em>x<sub>t+1</sub> = k.x<sub>t</sub>(1-x<sub>t</sub>)</em></p>
</div>
<div class="paragraph">
<p>We have one parameter <em>k</em> and one state variable <em>x</em> that requires an initial state <em>x<sub>0</sub> &gt; 0</em>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="29">
<li>
<p>From the <code>codeSource</code> node create a <code>record</code> named <code>pars</code> and a second <code>record</code> called <code>vars</code>. You must create a <em>record</em> before you can make data fields. <em>Fields</em> cannot exist outside a record definition, even, as in this case, the record contains only one field. Records can also contain <em>tables</em> and tables can contain records <em>ad infinitum</em>.</p>
</li>
<li>
<p>From <code>pars</code> create a field called <code>k</code>.</p>
</li>
<li>
<p>From <code>vars</code> a field called <code>x</code>. Both will be of type <code>Double</code> by default (‘double precision’ floating point numbers).</p>
</li>
<li>
<p>From the <code>ecology</code> node, create a <code>partition</code>. Accept the default name. From <code>partition</code> create a <code>category</code> node. Again accept the default name. The use of <em>partitions</em> and <em>categories</em> is a simple way of defining complex relationships between data and processes. This will become clearer in later tutorials. For now, we just need one of each.</p>
</li>
<li>
<p>We now define what constitutes a <em>driver</em> (a state variable) and what is a <em>parameter</em> for this <code>category</code>. Right-click on the category node and select <code>connect to - &gt; drivers → record:vars</code>.</p>
</li>
<li>
<p>To define the <em>parameters</em> repeat the above but select <code>connect to - &gt; parameters → record:pars</code>.</p>
</li>
<li>
<p>Show the cross-links (<code>X</code>) and examine the edge names to be sure you haven’t selected the wrong option. If you have, just right-click on the <code>category</code> node and select <code>disconnect from&#8230;&#8203;</code> to undo the error.</p>
</li>
<li>
<p>Assign the <code>category</code> to the <code>process</code>: Returning to the task list there is a requirement to connect the <code>process:step</code> to a <code>category</code> (or <code>relation</code>). Right click on the <code>process</code> node and select <code>connect to - &gt; appliesTo - &gt; category:category_1</code>.</p>
</li>
<li>
<p>Define a process <em>function</em>: The task list requires a child node of <code>process:step</code> of either <code>function or dataTracker</code>. <em>DataTrackers</em> are a means of sending data from a <code>process</code> to a <code>widget</code> in the user interface or to file. They are like a virtual data logger used in field studies. They can perform quite complex operations just as can real data loggers. We will come to that later but for now we need to define a function that is run by this <code>process</code>. Right-click on <code>process:step</code> and create a new <code>function</code>. Call it <code>step</code> like its parent. When asked if you want a <code>classnName</code> property, answer <code>no</code>. This is important. If you made a mistake, delete the node and repeat this step.</p>
</li>
<li>
<p>Define the <code>function</code> <em>class</em>: There are many types of functions available in 3Worlds. We will use the <code>changeState</code> function. There is now a requirement in the task list that says <code>function:step</code> must have either a property <code>className</code> or an edge to a <code>functionSpec</code>. Having said <code>no</code> above to including a <code>className</code> property, we now need to define a function specification. Function specifications are created in the <code>codeSource</code> category. Right-click on the <code>codeSource</code> node and create a new <code>functionSpec</code>, again called <code>step</code>. In the AEP you can see (under the <code>codeSource:codeSource_1</code> category) that the function type is <code>ChangeState</code> - the default. To make the link between the <code>function:step</code> and the <code>functionSpec:step</code>, right click on <code>function:step</code> and select <code>connect to - &gt; spec - &gt; functionSpec:step</code>.</p>
<div id="fig-screenshot-10" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot10.png" alt="tutorial1 shot10.png">
</div>
</div>
</li>
<li>
<p>There are now just two tasks remaining in the task list: we need a <em>system</em> and an <em>initial state</em>. Complete those two tasks by creating the required child nodes to <code>ecology:ecology_1</code>.</p>
</li>
<li>
<p>Collapse the <code>codeSource</code> node, hide the <code>X</code> links and reapply the layout.</p>
</li>
<li>
<p><strong>System</strong>:  A <code>system</code> is the thing being simulated. In our case it’s just the current and next value of <code>x</code>. The last task then, is to connect this <code>system</code> to a <code>category</code> where the system structure is defined. Complete this last task now.</p>
</li>
<li>
<p><strong>The configuration is now valid!</strong> The red light next to the <code>check</code> button at the bottom left of the main window is now green and the model is ready to run.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="truerunning-a-model"><a class="anchor" href="#truerunning-a-model"></a>5.1.2. Running a model</h4>
<div class="olist arabic">
<ol class="arabic" start="43">
<li>
<p>Save your work (only a saved configuration can be run) and click the <code>Create and run simulator</code> button. The simulator will now appear as a separate application. Click the run arrow (this is the <code>SimpleSimulationControllerWidget</code> that was added to the  user interface back at step 24) and the model will run for 100 years (cf step 20). The time is displayed in the timer widget (cf step 25).</p>
<div id="fig-screenshot-11" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot11.png" alt="tutorial1 shot11.png">
</div>
</div>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Some new files will have been created at this stage. Open a file manager and navigate to
<code>.3w/project_tut1&lt;date stamp&gt;</code>:</p>
</div>
<div id="fig-screenshot-12" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot12.png" alt="tutorial1 shot12.png">
</div>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tut1.dsl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the configuration file we have been developing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>layout.dsl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the visualisation of tut1.dsl for display in ModelMaker</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MM.dsl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the project preferences</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userProject.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java source and class files generated when we reached step 42 above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any data files used by the project. Empty for this tutorial</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simulator.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a manifest of the above jars plus threeWorlds.jar and its dependencies. This is the jar that runs at step 43 above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local/java</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the java files and classes added to userProject.jar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local/runTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">created when running the simulator for the first time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>preferences.dsl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">preferences for the simulator – window size and position of controls etc&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default.twg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a text file containing the starting state of all state variables. We only have one in this tutorial : <code>x</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can open the java files in a text editor (<code>local/java/code/tut1/ecology/*.java</code>) to see what <code>ModelMaker</code> has created. <code>Pars.java</code> is an implementation of the Pars record and contains the field <code>k</code>. Likewise <code>Vars.java</code> contains the field <code>x</code>. These two files are always generated by <code>ModelMaker</code>. <em>If you edit them in any way, your edits will be overwritten by</em> <code>ModelMaker</code>. The third file, <code>Step.java</code>, is a <em>template</em> file. We will edit this file later in <a href="https://www.eclipse.org/downloads/">eclipse</a> to implement the Chaos equation above.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Don’t try and edit in a simple text editor as <code>ModelMaker</code> will rely on <a href="https://www.eclipse.org/downloads/">eclipse</a> to compile and create the associated class file. In <a href="https://www.eclipse.org/downloads/">eclipse</a> you can edit this file as you please as long as you don’t change its  Java class.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>You may be surprised to find there is little you can do with the simulator except run, pause, continue and reset a simulation: that is, all you can do essentially, is run the experiment and examine the results.  The one other thing you can do is pause the simulation and save the current state to a new initial state file.</p>
</div>
<div class="paragraph">
<p><strong>[TODO: rewrite the initial state stuff - points 44 and 45]</strong></p>
</div>
<div class="paragraph">
<p>Note that the contents of the initial state file are determined by the project configuration file (<code>tut1.dsl</code>). Changes to the configuration, specifically records and tables defined under the <code>codeSource</code> category, will result in changes to the initial state file. The simulator will attempt to handle this and issue warnings where differences have been encountered. You should deal with these warnings before relying on your results.</p>
</div>
<div class="paragraph">
<p>It&#8217;s no use running the simulator again at the moment because we have yet to implement the chaos equation. This is were we begin writing Java code in <a href="https://www.eclipse.org/downloads/">eclipse</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="46">
<li>
<p>Open eclipse, create a workspace (if you have not already done so) and create a new Java project called <code>Chaos</code>. We should probably call it the same name as our 3Worlds project (<code>tut1</code>)  but at the moment it is simpler to give it a different name to distinguish between Java projects and ModelMaker projects in this tutorial. However, naming the Java and 3Worlds project the same, will help avoid confusion when you have many projects..</p>
</li>
<li>
<p>We first need to add the 3Worlds libraries to the Chaos project. Right-click on the <code>Chaos</code> project and select <code>preferences</code>.</p>
</li>
<li>
<p>Choose <code>Java Build Path</code> and select the <code>Libraries</code> tab.</p>
</li>
<li>
<p>Open the <code>Add External Jars</code>, navigate to the <code>.3w</code> directory and include <code>threeWorlds.jar</code> and <code>tw-dep.jar</code>.</p>
</li>
<li>
<p>Click <code>Ok</code> and close then <code>Apply</code> and <code>close</code>.</p>
</li>
<li>
<p><strong>Linking <code>tut1</code> project to <code>Chaos</code> java project</strong>: Open the <code>tut1</code> project in <code>ModelMaker</code> (if not already open).</p>
</li>
<li>
<p>Select <code>Preferences - &gt; Java Project - &gt; connect</code>. Navigate to the workspace containing the <code>Chaos</code> project, select it and click <code>Open</code>. You will now see the main window title of <code>ModelMaker</code> has changed to indicate this link to the <code>Chaos</code> project.</p>
<div id="fig-screenshot-13" class="imageblock" style="text-align: center">
<div class="content">
<img src="tutorial1-shot13.png" alt="tutorial1 shot13.png">
</div>
</div>
<div class="paragraph">
<p>This link will be saved in the <code>MM.dsl</code> preferences file after quitting <code>ModelMaker</code>. If you link to some directory that is not an eclipse project, you will get an error message.</p>
</div>
</li>
<li>
<p>Return to <a href="https://www.eclipse.org/downloads/">eclipse</a>, right-click on the <code>Chaos</code> project and select <code>Refresh</code>. Under the <code>src</code> directory you will now see the three java files created previously by <code>ModelMaker</code>. These were transferred when the link was set in <code>ModelMaker</code>.</p>
</li>
<li>
<p>Open <code>Step.java</code>. You will see this is a <code>ChangeStateFunction</code> class (cf.  38). If you change the type of function to something other than <code>ChangeState</code> in <code>ModelMaker</code>, this file, and any changes you have made to it, will be saved under a new name called <code>Step.orig_0</code>. This is to avoid the complications of trying to move your changes to a new file (where they may not in fact be appropriate) but without losing your work. The number will increment each time this situation happens <strong>[NOT DONE YET]</strong> to prevent overwrites.</p>
</li>
<li>
<p>Add the following code within the <code>changeState()</code> method:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">Pars pars = (Pars) focal.parameters();
Vars current = (Vars)focal.currentState();
Vars next = (Vars)focal.nextState();
next.x(pars.k()*current.x()*(1-current.x()));</code></pre>
</div>
</div>
</li>
<li>
<p>Save your work. Saving your java file will ensure eclipse creates the associated class file for inclusion in the simulator.jar when you next launch it from ModelMaker.</p>
</li>
<li>
<p><strong>Plot the output</strong>: Before running the simulator again, a final task is to display a time series of <code>x</code>. For this we must attach a <em>data tracker</em> to <code>process:step</code>, modify a property to indicate the data to track and add a chart widget to the UI to view the time series.</p>
</li>
<li>
<p>Right-click on <code>process:step</code> and create a new <code>dataTracker</code> node. Accept the defaults in the ensuing prompts.</p>
</li>
<li>
<p>A new task message will appear asking to set a valid value for <code>reporting period</code>. Go to the AEP and enter a value of 1 for this property. For reasons of efficiency, a dataTracker can buffer the data it collects and send it to a widget in fewer time steps.</p>
</li>
<li>
<p>In the AEP display, edit the dataTracker:dataTracker_1#track property and select the only available option: <code>x</code>. <strong>[TODO]</strong></p>
</li>
<li>
<p>Collapse all nodes and expand the userInterface node. From this node create a new tab.</p>
</li>
<li>
<p>Select the tab node and create a widget. Name it <code>plot</code> and select <code>timeSeriesPlotWidgetfx</code> from the available list.
You can add as many widgets as you like to a tab node. Each will appear in its own tab. In addition, there are 4 regions of the Simulator (apart from the toolBar at the top and the status bar at the bottom) where tabs can be placed. This seems a good compromise between flexibility and ease of use.</p>
</li>
<li>
<p>A new task message appears indicating this node must be connected to an <code>engine</code> node. This is to provide state information from the <code>engine</code> to the <code>widget</code> so that, for example, the plot will be cleared when the engine is reset (by the controller widget).</p>
</li>
<li>
<p>We also need to connect to the <code>dataTracker</code>. This is not mandatory <strong>[TODO WHY?]</strong>, but nothing will show unless this is done. Right-click on the plot node and select <code>connect to &#8594; dataListener - &gt; dataTracker:dataTracker_1</code>.</p>
</li>
<li>
<p>Save your work and run the simulator. <strong>[TODO screen capture]</strong></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-08-10 15:33:58 CEST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>